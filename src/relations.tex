\subsection{Relations}\label{subsec:relations}

\begin{definition}\label{def:cartesian_product}\mcite[def. 1.23]{OpenLogicFull}
  We are now in a vicious cycle where we need binary Cartesian products in order to define arbitrary Cartesian products. We will do this as quickly as possible, without introducing relations and functions. The latter two will be discussed in detail in \fullref{subsec:relations} and \fullref{subsec:functions}, respectively.

  \begin{thmenum}
    \thmitem{def:cartesian_product/kuratowski_pair} The \term{Kuratowski pair} or simply \term{ordered pair} \( \braket{ x, y } \) of the sets \( x \) and \( y \) is defined as
    \begin{equation*}
      \braket{ x, y } \coloneqq \set{ \set{ x }, \set{ x, y } }.
    \end{equation*}

    This is a simple and widespread definition that encodes the order of \( x \) and \( y \), unlike the set \( \set{ x, y } \) for example.

    We will later use the notation \( (x, y) \), but until \fullref{rem:kuratowski_pairs_and_tuples}, we want to distinguish between Kuratowski pairs and \( 2 \)-tuples.

    We will use the following \hyperref[rem:predicate_formula]{predicate formula} in \( \ref{eq:def:function/predicate}[\rho, \tau, \sigma] \):
    \begin{equation*}\taglabel[\op{IsPair}]{eq:def:cartesian_product/kuratowski_pair_predicate}
      \ref{eq:def:cartesian_product/kuratowski_pair_predicate}[\rho, \tau, \sigma] \coloneqq \qforall \xi \parens[\Bigg]{ \xi \in \rho \leftrightarrow \parens[\Big]{ \parens[\Big]{ \qforall {\eta \in \xi} \eta \doteq \tau } \vee \parens[\Big]{ \qforall {\eta \in \xi} (\eta \doteq \tau \vee \eta \doteq \sigma) } } }
    \end{equation*}

    \thmitem{def:cartesian_product/indexed_family} A set \( i \) of Kuratowski pairs is called an \term{indexed family} if whenever \( \braket{ k, A } \in i \) and \( \braket{ k, B } \in i \), we have \( A = B \). It is conventional to denote this unique set corresponding to \( k \) as \( A_k \) without an explicit reference to \( i \).

    The \term{index set} of the family is
    \begin{equation*}
      \mscrK \coloneqq \set{ k \given \qexists A \braket{ k, A } \in i }.
    \end{equation*}

    The family itself is then denoted as
    \begin{equation*}
      \seq{ A_k }_{k \in \mscrK}.
    \end{equation*}

    If \( A_k \in \mscrA \) for every \( k \in \mscrK \), we sometimes write
    \begin{equation*}
      \seq{ A_k }_{k \in \mscrK} \subseteq \mscrA,
    \end{equation*}
    although the latter is an embedding rather than set inclusion.

    \thmitem{def:cartesian_product/tuple} A \term{tuple} from the indexed family \( \seq{ A_k }_{k \in \mscrK} \) is another indexed family \( \seq{ x_k }_{k \in \mscrK} \) with the same index set satisfying the condition that for every \( k \in \mscrK \), the value \( x_k \) belongs to \( A_k \).

    We will see later that this is precisely a \hyperref[def:choice_function]{choice function}.

    \thmitem{def:cartesian_product/product} The \term{Cartesian product} of an indexed family \( \seq{ A_k }_{k \in \mscrK} \) is the set of all tuples from this family. We denote the Cartesian product by
    \begin{equation*}
      \prod_{k \in \mscrK} A_k.
    \end{equation*}

    With the availability of \hyperref[def:function]{functions} in \fullref{subsec:functions}, we can define the Cartesian product as the set
    \begin{equation*}
      \prod_{k \in \mscrK} A_k = \set{ f: A \to \bigcup_{k \in \mscrK} A_k \given \qforall {k \in \mscrK} k \in A_k }.
    \end{equation*}
  \end{thmenum}
\end{definition}

\begin{definition}\label{def:sequence}
  Families indexed by \( \omega \) are called \term{infinite sequences} or simply \term{sequences}. We will use several notations, depending on the context.
  \begin{itemize}
    \item \( \seq{ A_k }_{k \in \BbbN} \), which is the conventional notation for indexed families.
    \item \( \seq{ A_k }_{k=0}^\infty \), which easily extends to cases such as \( \seq{ A_k }_{k=m}^n \) when the index set is \( \set{ m, \ldots, n } \).
    \item \( (A_0, A_1, \ldots) \), which is used when explicitly enumerating members of the sequence.
  \end{itemize}

  It is conventional to write a family \( \seq{ A_k }_{k \in n} \) indexed by a natural number \( n \) using the notation \( (A_1, \cdots, A_n) \), with or without the outer parentheses. Families indexed by natural numbers are called \term{finite sequences}.

  For \( n = 2 \), finite sequences are called \term{pairs}, for \( n = 3 \) --- \term{triples} and for \( n = 4 \) --- \term{quadruples}.

  We say that \( A_{k_1}, A_{k_2}, \ldots \) is a \term{subsequence} of \( A_1, A_2, \ldots \) if \( k_1 < k_2 < \ldots \), i.e. if the sequence of indices is monotone in the sense of \eqref{eq:def:partially_ordered_set/homomorphism/sequence}.
\end{definition}

\begin{remark}\label{rem:kuratowski_pairs_and_tuples}
  Note that the tuple \( (A, B) \)
  \begin{equation*}
    (A, B) = \set[\Bigg]{ \set[\Big]{ \set{ 0 }, \set{ 0, A } }, \set[\Big]{ \set{ 1 }, \set{ 1, B } } }
  \end{equation*}
  is formally different from the \hyperref[def:cartesian_product/kuratowski_pair]{Kuratowski pair}
  \begin{equation*}
    \braket{ A, B } = \set[\Big]{ \set{ A }, \set{ A, B } }.
  \end{equation*}

  This is one reason we hurried to define general Cartesian products --- we wanted to avoid working with tuples defined in terms of Kuratowski pairs. We even introduced a special notation for them, just so we can avoid any confusion. Nevertheless, it is conventional to conflate Kuratowski pairs with \( \set{ 0, 1 } \)-indexed tuples.

  We also conflate the tuples \( (A, (B, C)) \), \( ((A, B), C) \) and \( (A, B, C) \).
\end{remark}

\begin{definition}\label{def:relation}
  Let \( A_1, \ldots, A_n \) be a \hyperref[def:sequence]{finite sequence} of sets and let
  \begin{equation*}
    R \subseteq A_1 \times \cdots \times A_n
  \end{equation*}
  be a subset of their \hyperref[def:cartesian_product/product]{Cartesian product}.

  The sequence \( (R, A_1, \ldots, A_n) \) is called an \( n \)-ary \term{relation}. We say that the tuple \( (x_1, \ldots, x_n) \in A_1 \times \cdots \times A_n \) is related with respect to \( R \) if \( (x_1, \ldots, x_n) \in R \).

  Relations are the semantical counterpart to \hyperref[def:first_order_structure/interpretation/predicate]{first-order predicates} and are equivalent to Boolean-valued functions, as discussed in \fullref{rem:boolean_valued_functions_and_predicates}.

  We generalize only the following notions from \hyperref[def:binary_relation]{binary relations}:
  \begin{thmenum}[series=def:relation]
    \thmitem{def:relation/graph} The set \( R \) of tuples is called the \term{graph} of the relation. In case the sequence \( A_1, \ldots, A_n \) is clear from the context, we can identify the relation \( (R, A_1, \ldots, A_n) \) with its graph \( R \). We occasionally use the notation \( \gph(R) \) for explicitly denoting the graph.

    \thmitem{def:relation/signature} The \term{signature} of the relation is the sequence \( (A_1, \ldots, A_n) \). Obviously this definition only makes sense if we know what the signature is, either from the context or from the definition of the relation as the sequence \( (R, A_1, \ldots, A_n) \) rather than only via its graph \( R \).

    As a matter of fact, it is common to ignore the signature when defining relations --- see e.g. \cite[7]{Kelley1955} or \cite[def. 2.1]{OpenLogicFull}. If we do identify a relation only with its graph, however some notions like \hyperref[def:multi_valued_function/range]{ranges} and \hyperref[def:multi_valued_function/image]{images} coincide despite being different and other notions like \hyperref[def:function_invertibility/surjective]{function surjectivity} make no sense.

    Furthermore, two relations whose graphs are equal may have different signatures, which further highlights how important it is to distinguish between a relation and its graph.

    \thmitem{def:relation/arity} For some small values of \( n \), \( n \)-ary relations have established names:
    \begin{itemize}
      \item \term{Nullary} if \( n = 0 \).
      \item \term{Unary} if \( n = 1 \).
      \item \term{Binary} if \( n = 2 \).
      \item \term{Ternary} if \( n = 3 \).
    \end{itemize}

    This is not to be confused with \hyperref[def:multi_valued_function/arity]{function arity} --- functions are always binary relations.

    \thmitem{def:relation/single_set} If all \( A_k \) for \( k = 1, \ldots, n \) are equal to the set \( A \), we say that \( R \subseteq A^n \) is a relation \hi{on \( A \)}.
  \end{thmenum}
\end{definition}

\begin{definition}\label{def:binary_relation}
  An important special case of \hyperref[def:relation]{relations} are \term{binary relations}. Given two sets \( A \) and \( B \), a binary relation between them is a triple \( (R, A, B) \).

  In addition to the terminology for \fullref{def:relation}, we also introduce the following terms:
  \begin{thmenum}[series=def:binary_relation]
    \thmitem{def:binary_relation/empty} The relation is \term{empty} if its graph is the empty set, i.e. if no two elements are related.

    It is important to highlight that the graphs of all empty relations are equal, but two empty relations are only equal if their signatures are.

    \thmitem{def:binary_relation/converse} The \term{converse relation} of \( R \) is
    \begin{equation*}
      R^{-1} \coloneqq \set{ (y, x) \given (x, y) \in R }.
    \end{equation*}

    \thmitem{def:binary_relation/restriction} If \( A = B \), the \term{restriction} of \( R \) to \( X \subseteq A \) is the binary relation \( (R\restr_{X}, X, X) \) is
    \begin{equation*}
      R\restr_{X} \coloneqq R \cap (X \times X) = \set{ (x, y) \in R \given x \in X \T{and} y \in X }.
    \end{equation*}

    We say that \( R \) is an \term{extension} of \( R\restr_{X} \).

    \thmitem{def:binary_relation/diagonal} A special relation is the \term{diagonal relation} on a set \( A \):
    \begin{equation*}
      \increment_A \coloneqq \set{ (x, x) \given x \in A }.
    \end{equation*}

    \thmitem{def:binary_relation/composition} Given two binary relations \( R \subseteq A \times B \) and \( T \subseteq B \times C \), we define their composition as
    \begin{equation*}
      T \bincirc R \coloneqq \set*{ (x, z) \in A \times C \given* \qexists {y \in B} \parens[\Big]{ (x, y) \in R \T{and} (y, z) \in T } }.
    \end{equation*}
  \end{thmenum}

  Whenever \( A = B \) and \( R \) is simply a binary relation over \( A \), the following are commonly used conditions that are often as axioms to some theory:
  \begin{thmenum}[resume=def:binary_relation]
    \thmitem{def:binary_relation/reflexive} \( R \) is \term{reflexive} if \( \Delta_A \subseteq R \), i.e. if every element of \( A \) is related with itself.

    The following formula is used as an axiom for \hyperref[def:partially_ordered_set/nonstrict]{nonstrict partial orders} and \hyperref[def:entourage]{entourages}:
    \begin{equation}\label{eq:def:binary_relation/reflexive}
      \qforall \xi (\xi \mathbin{R} \xi).
    \end{equation}

    Note that we use \fullref{rem:first_order_formula_conventions/infix} notation in the latter case. Using either infix or prefix notation is actually a necessity since we do not actually have a concept of an ordered tuple in general (not set-based) first-order theories --- see \fullref{rem:first_order_formula_conventions/infix}.

    \thmitem{def:binary_relation/irreflexive} \( R \) is \term{irreflexive} if \( \Delta_A \cap R = \varnothing \), i.e. if no element of \( A \) is related with itself.

    The following formula is used as an axiom for \hyperref[def:partially_ordered_set/strict]{strict partial orders}:
    \begin{equation}\label{eq:def:binary_relation/irreflexive}
      \neg \qexists \xi (\xi \mathbin{R} \xi).
    \end{equation}

    \thmitem{def:binary_relation/symmetric} \( R \) is \term{symmetric} if \( R = R^{-1} \).

    The following formula is used as an axiom for \hyperref[def:equivalence_relation]{equivalence relations}, \hyperref[def:undirected_multigraph]{undirected graphs} and \hyperref[def:entourage]{entourages}:
    \begin{equation}\label{eq:def:binary_relation/symmetric}
      \xi \mathbin{R} \eta \rightarrow \eta \mathbin{R} \xi.
    \end{equation}

    \thmitem{def:binary_relation/antisymmetric} \( R \) is \term{antisymmetric} if \( R \cap R^{-1} = \Delta_X \).

    The following formula is used as an axiom for \hyperref[def:partially_ordered_set]{partial orders}:
    \begin{equation}\label{eq:def:binary_relation/antisymmetric}
      (\xi \mathbin{R} \eta \wedge \eta \mathbin{R} \xi) \rightarrow \xi \doteq \eta.
    \end{equation}

    \thmitem{def:binary_relation/transitive} \( R \) is \term{transitive} if \( R = R \bincirc R \).

    The following formula is used as an axiom for \hyperref[def:partially_ordered_set]{preorders}:
    \begin{equation}\label{eq:def:binary_relation/transitive}
      (\xi \mathbin{R} \eta \wedge \eta \mathbin{R} \zeta) \rightarrow \xi \mathbin{R} \zeta.
    \end{equation}

    \thmitem{def:binary_relation/total} \( R \) is \term{total} if any two member of \( A \) are related.

    The following formula is used as an axiom for \hyperref[def:totally_ordered_set]{nonstrict total orders}:
    \begin{equation}\label{eq:def:binary_relation/total}
      \qforall \xi \qforall \eta (\xi \mathbin{R} \eta \vee \eta \mathbin{R} \xi).
    \end{equation}

    Total relations are also called \term{connected} because of \fullref{thm:order_category_isomorphism/totally_ordered}.

    \thmitem{def:binary_relation/trichotomic} \( R \) is \term{trichotomic} if every two elements of \( A \) are either related or equal.

    The following formula is used as an axiom for \hyperref[def:totally_ordered_set]{strict total orders}:
    \begin{equation}\label{eq:def:binary_relation/trichotomic}
      \qforall \xi \qforall \eta (\xi \mathbin{R} \eta \vee \eta \mathbin{R} \xi \vee \eta = \xi).
    \end{equation}
  \end{thmenum}
\end{definition}

\begin{example}\label{ex:def:binary_relation}
  \hyperref[def:binary_relation]{Binary relations} are used in vastly different contexts:
  \begin{itemize}
    \item \hyperref[def:function]{Functions} are special binary relations.
    \item \hyperref[sec:order_theory]{Orders} are also special binary relations.
    \item \hyperref[def:quiver/simple]{Directed graphs} are commonly defined as binary relations.
    \item \hyperref[def:entourage]{Entourages} are binary relations in \hyperref[def:uniform_space]{uniform spaces}.
    \item Relations are equivalent to Boolean-valued functions (see \fullref{rem:boolean_valued_functions_and_predicates}) and are often used for defining semantics of predicate symbols in \hyperref[subsec:first_order_logic]{first-order logic}.
  \end{itemize}
\end{example}

\begin{definition}\label{def:equivalence_relation}
  A binary relation on the set \( A \) that is \hyperref[def:binary_relation/reflexive]{reflexive}, \hyperref[def:binary_relation/symmetric]{symmetric} and \hyperref[def:binary_relation/transitive]{transitive} is called an \term{equivalence relation}. In other words, an equivalence relation is a symmetric \hyperref[def:preordered_set]{preorder}.

  We often denote equivalence relations via the symbol \( \sim \).

  \begin{thmenum}
    \thmitem{def:equivalence_relation/coset} The \term{equivalence class} of \( x \in A \), also called its \term{coset}, is the set
    \begin{equation*}
      [x] \coloneqq \set{ y \in A \given x \sim y }
    \end{equation*}
    of all elements of \( A \) that are related to \( x \).

    \thmitem{def:equivalence_relation/quotient} The \term{quotient set} of \( A \) by \( \sim \) is the set
    \begin{equation*}
      A / {\sim} \ \coloneqq \set{ [x] \given x \in A }.
    \end{equation*}

     If we have an easy way to choose a representative from each coset, then \( A / {\sim} \) may be regarded as a subset of \( A \). In general, this is not a subset relation by only an \hyperref[def:first_order_homomorphism_invertibility/embedding]{embedding}.

    \thmitem{def:equivalence_relation/projection} Using forward references to \fullref{subsec:functions}, we define the \term{canonical projection} as the function
    \begin{equation*}
      \begin{aligned}
        &\pi: A \to A / {\sim}  \\
        &\pi(x) \coloneqq [x].
      \end{aligned}
    \end{equation*}

    If we have a fixed \hyperref[def:choice_function]{choice function} \( c: A / {\sim} \to A \), we also define the canonical embedding
    \begin{equation*}
      \begin{aligned}
        &\iota: A / {\sim} \to A \\
        &\iota([x]) \coloneqq c(x).
      \end{aligned}
    \end{equation*}

    We sometimes have an obvious choice function, for example in \fullref{thm:polynomial_quotient_rings_equinumerous_with_module_of_polynomials}. In this case, the canonical projection may be regarded as a function from \( A \) to the subset \( c(A / {\sim}) \) of \( A \). Otherwise, the function \( \pi \) can be regarded as a \hyperref[def:multi_valued_function]{multi-valued function} from \( A \) to \( A \).
  \end{thmenum}
\end{definition}

\begin{remark}\label{rem:congruence_modulo_relation}
  If \( x \sim y \) for some \hyperref[def:equivalence_relation]{equivalence relation}, we say that they are \term{congruent modulo} \( \sim \). This concept specializes to congruence modulo normal subgroups defined in \fullref{def:congruence_modulo_normal_subgroup}.
\end{remark}

\begin{proposition}\label{thm:equality_is_smallest_equivalence_relation}
  The equality \hyperref[def:binary_relation]{relation} \( = \) is the intersection of all equivalence relations.
\end{proposition}
\begin{proof}
  It is equivalent to the \hyperref[def:binary_relation/diagonal]{diagonal relation} \( \Delta_X \). It is the smallest reflexive (resp. symmetric and transitive) relation on \( A \), i.e. the intersection of all reflexive (resp. symmetric and transitive) relations.
\end{proof}

\begin{definition}\label{def:set_partition}
  Let \( A \) be a set. A \term{cover} of \( A \) is a \hyperref[rem:family_of_sets]{family} \( \mscrA \subseteq \pow(A) \) of nonempty subsets of \( A \) such that \( A = \bigcup \mscrA \). We sometimes use the term more loosely and say that an arbitrary family of sets \( \mscrA \) is a cover of \( A \) if \( A \subseteq \bigcup \mscrA \). The two definitions are identical if we intersect each set in \( \mscrA \) with \( A \) and exclude the empty sets.

  A \term{partition} of \( A \) is a pairwise \hyperref[def:subset]{disjoint} cover. In other words, the cover \( \mscrA \) is a partition if and only if each element of \( A \) belong to exactly one set in \( \mscrA \).
\end{definition}

\begin{proposition}\label{thm:equivalence_partition}
  Fix a set \( A \). Let \( {\sim} \) be a binary relation of \( A \). The following are equivalent:
  \begin{thmenum}
    \thmitem{thm:equivalence_partition/equivalence} \( {\sim} \) is an \hyperref[def:equivalence_relation]{equivalence relation}.

    \thmitem{thm:equivalence_partition/partition} There exists a \hyperref[def:set_partition]{partition} \( \mscrA \) of \( A \) such that \( x \sim y \) if and only if they belong to the same set in the partition \( \mscrA \).
  \end{thmenum}
\end{proposition}
\begin{proof}
  \ImplicationSubProof{thm:equivalence_partition/equivalence}{thm:equivalence_partition/partition} Let \( {\sim} \) be an equivalence relation on \( A \). The quotient set \( A / {\sim} \) is a partition. Indeed:
  \begin{itemize}
    \item Every element \( x \in A \) belongs exactly one equivalence class \( [x] \) by definition.

    \item The equivalence classes are disjoint. Indeed, assume the contrary. Then there exist \( x \) and \( y \) such that \( [x] \cap [y] \neq \varnothing \) and yet \( x \not\sim y \).

    Let \( z \in [x] \cap [y] \). Then \( z \sim x \) and \( z \sim y \), thus from transitivity of \( {\sim} \) we have \( x \sim z \sim y \) and hence \( x \sim y \), which contradicts our assumption that \( x \not\sim y \).

    Hence, either \( [x] = [x] \) or \( [x] \cap [y] = \varnothing \). That is, different equivalence classes are disjoint.
  \end{itemize}

  \ImplicationSubProof{thm:equivalence_partition/partition}{thm:equivalence_partition/equivalence} Let \( \mscrA \) be a partition of \( A \) such that \( x \sim y \) if and only if they both belong to the same set in \( \mscrA \).

  Given \( x \in A \), denote by \( A_x \) the set in \( \mscrA \) which contains \( x \). The family \( \seq{ A_x }_{x \in A} \) is well-defined since \( \mscrA \) is a partition, which means that \( x \) belongs to exactly one set in \( \mscrA \).

  \SubProofOf*[def:binary_relation/reflexive]{reflexivity} Clearly \( A_x = A_x \), hence \( x \sim x \).

  \SubProofOf*[def:binary_relation/symmetric]{symmetry} If \( x \sim y \), then \( A_x = A_y \), which implies \( A_y = A_x \) and thus \( x \sim y \).

  \SubProofOf*[def:binary_relation/transitive]{transitivity} If \( x \sim y \) and \( y \in z \), then \( A_x = A_y = A_z \) and thus \( x \sim z \).
\end{proof}

\begin{definition}\label{def:relation_closures}
  Let \( R \subseteq A^2 \) be a binary relation on the set \( A \). We define several \hyperref[def:closure_operator]{closure operators}:
  \begin{thmenum}
    \thmitem{def:relation_closures/reflexive} The \term{reflexive closure} of \( R \) is
    \begin{equation*}
      \cl^R(R) \coloneqq R \cup \Delta_X.
    \end{equation*}

    \thmitem{def:relation_closures/symmetric} The \term{symmetric closure} of \( R \) is
    \begin{equation*}
      \cl^S(R) \coloneqq R \cup R^{-1}.
    \end{equation*}

    \thmitem{def:relation_closures/transitive} The \term{transitive closure} \( \cl^T(R) \) of \( R \) is
    \begin{equation*}
      \cl^T(R) \coloneqq \bigcup \set{ R^k \given k = 1, 2, \ldots },
    \end{equation*}
    where \( R^k \) is iterated \hyperref[def:binary_relation/composition]{composition} of \( R \).

    Note that this is very different from the transitive closure of a set defined in \fullref{def:transitive_closure_of_a_set}.

    A \term{transitive reduction} of \( R \) is a \hyperref[def:partially_ordered_set_extremal_points/maximal_and_minimal_element]{minimal} relation \( Q \subseteq R \) such that \( \cl^T(Q) = \cl^T(R) \). If there exists a smallest such relation, it is the unique transitive reduction, and we denote it by \( \red^T(R) \).
  \end{thmenum}
\end{definition}

\begin{proposition}\label{thm:def:relation_closures/properties}
  \hyperref[def:relation_closures]{Binary relation closures} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:relation_closures/properties/reflexive_relation} The symmetric and transitive closures of a reflexive relation are symmetric.
    \thmitem{thm:def:relation_closures/properties/symmetric_relation} The reflexive and transitive closures of a symmetric relation are symmetric.
    \thmitem{thm:def:relation_closures/properties/transitive_relation} The reflexive closure of a transitive relation is transitive. The symmetric closure of a transitive relation may not be transitive --- see \fullref{ex:thm:def:relation_closures/properties/symmetric_and_transitive}.

    \thmitem{thm:def:relation_closures/properties/reflexive_and_symmetric} The reflexive and symmetric closures commute:
    \begin{equation}\label{eq:thm:def:relation_closures/properties/reflexive_and_symmetric}
      \cl^S \cl^R(R) = \cl^R \cl^S(R).
    \end{equation}

    \thmitem{thm:def:relation_closures/properties/reflexive_and_transitive} The transitive and reflexive closures commute:
    \begin{equation}\label{eq:thm:def:relation_closures/properties/reflexive_and_transitive}
      \cl^R \cl^T(R) = \cl^T \cl^R(R).
    \end{equation}

    \thmitem{thm:def:relation_closures/properties/symmetric_and_transitive} For the transitive and symmetric closures of \( R \) we have
    \begin{equation}\label{eq:thm:def:relation_closures/properties/symmetric_and_transitive}
      \cl^S \cl^T(R) \subseteq \cl^T \cl^S(R).
    \end{equation}

    The converse holds if \( R \) is symmetric but not in general --- see \fullref{ex:thm:def:relation_closures/properties/symmetric_and_transitive}.
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:relation_closures/properties/reflexive_relation} Trivial.
  \SubProofOf{thm:def:relation_closures/properties/symmetric_relation} Trivial.
  \SubProofOf{thm:def:relation_closures/properties/transitive_relation} Trivial.
  \SubProofOf{thm:def:relation_closures/properties/reflexive_and_symmetric} Trivial.
  \SubProofOf{thm:def:relation_closures/properties/reflexive_and_transitive} The reflexive closure only adds pairs of the form \( (x, x) \). Thus, if \( (x, y) \in \cl^T(\cl^R(R)) \) for \( x \neq y \), then \( (x, y) \in \cl^T(R) \subseteq \cl^R(\cl^T(R)) \).

  Conversely, if \( (x, y) \in \cl^R(\cl^T(R)) \) for \( x \neq y \), then \( (x, y) \in \cl^T(R) \subseteq \cl^R(\cl^T(R)) \).

  \SubProofOf{thm:def:relation_closures/properties/symmetric_and_transitive} If \( (x, y) \in \cl^S(\cl^T(R)) \), then we have the following possibilities:
  \begin{itemize}
    \item If \( (x, y) \in R \), obviously \( (x, y) \in \cl^T(\cl^S(R)) \).
    \item If \( (x, y) \in \cl^T(R) \setminus R \), then there exists some natural number \( k > 1 \) such that \( (x, y) \in R^k \).

    Since \( R^k \subseteq [\cl^S(R)]^k \), as can be shown by induction, we have \( (x, y) \in [\cl^S(R)]^k \). We thus conclude that \( (x, y) \in \cl^T(\cl^S(R)) \).

    \item Finally, if \( (x, y) \not\in \cl^T(R) \), then \( (y, x) \in \cl^T(R) \). As in the previous step, we can show that \( (y, x) \in \cl^T(\cl^S(R))) \). The latter set is symmetric, hence \( (x, y) \in \cl^T(\cl^S(R)) \).
  \end{itemize}

  Since \( (x, y) \) was arbitrary, we conclude that \eqref{eq:thm:def:relation_closures/properties/symmetric_and_transitive} holds.

  Furthermore, if \( R \) is symmetric, then
  \begin{equation*}
    \cl^T \cl^S(R)
    =
    \cl^T(R)
    \reloset {\ref{thm:def:relation_closures/properties/reflexive_relation}} =
    \cl^S \cl^T(R).
  \end{equation*}
\end{proof}

\begin{example}\label{ex:thm:def:relation_closures/properties/symmetric_and_transitive}
  We will show that symmetric and transitive closures of relations do not commute. This is also a consequence of the difference between \hyperref[def:quiver_connectedness/weak]{weak} and \hyperref[def:quiver_connectedness/strong]{strong} connectedness of quivers.

  Consider the set \( A = \set{ a, b, c } \) and the relation \( R = \set{ (a, b), (c, b) } \).

  It should be noted that \( R \) is \hyperref[def:binary_relation/transitive]{transitive}. Thus,
  \begin{equation*}
    \cl^S(\cl^T(R)) = \cl^S(R) = R \cup \set{ (b, a), (b, c) }.
  \end{equation*}

  The latter set is not transitive because \( (a, b) \) and \( (b, a) \) both belong to \( \cl^S(R) \) and neither \( (a, a) \) nor \( (b, b) \) do not.

  This shows that the converse of \eqref{eq:thm:def:relation_closures/properties/symmetric_and_transitive} does not hold in general.
\end{example}

\begin{proposition}\label{thm:equivalence_closure}
  The \hyperref[def:relation_closures/reflexive]{reflexive}, \hyperref[def:relation_closures/symmetric]{symmetric} and \hyperref[def:relation_closures/transitive]{transitive} closure \( \cl^T \cl^S \cl^R (R) \) of any relation \( R \) is an \hyperref[def:equivalence_relation]{equivalence relation}.

  This holds for any permutation of the closures as long as \( \cl^T \) is applied \hi{after} \( \cl^S \). This latter restriction is due to \fullref{thm:def:relation_closures/properties/symmetric_and_transitive}.
\end{proposition}
\begin{proof}
  Let \( R \subseteq A \times B \) be an arbitrary relation. By \fullref{thm:def:relation_closures/properties/reflexive_relation}, \( \cl^S \cl^R (R) \) is reflexive. It is also symmetric as the symmetric closure of \( \cl^R(R) \).

  Then the transitive closure \( \cl^T \cl^S \cl^R (R) \) is also symmetric and reflexive by \fullref{thm:def:relation_closures/properties/reflexive_relation} and \fullref{thm:def:relation_closures/properties/symmetric_relation}.

  Therefore, \( \cl^T \cl^S \cl^R (R) \) is an equivalence relation.
\end{proof}
