\subsection{Fields}\label{subsec:fields}

\begin{definition}\label{def:field}
  As mentioned in \fullref{def:semiring/field}, fields are commutative division rings.
\end{definition}

\begin{proposition}\label{thm:ideals_of_field}
  The only \hyperref[def:semiring_ideal]{ideals} of a field are \( \{ 0 \} \) and \( \BK \).
\end{proposition}

\begin{theorem}\label{thm:ring_of_integers_module_prime_is_field}
  The ring \( \BZ_n \) (see \fullref{def:ring_of_integers_modulo}) of integers modulo \( n \) is a field if \( n \) is a prime \hyperref[def:prime_number]{number}.
\end{theorem}
\begin{proof}
  We only need to show that \( \BZ_n \) has a multiplicative inverse for any nonzero element.

  Fix \( x \in \BZ_n \). If \( y \) is a multiplicative inverse of \( x \), we should have
  \begin{equation*}
    xy \equiv 1 \pmod n,
  \end{equation*}
  which is the same as
  \begin{equation*}
    n \mid (xy - 1).
  \end{equation*}

  \Fullref{thm:bezout_identity} gives us integers \( a, b \in \BZ \) such that
  \begin{equation*}
    ax + bn = \gcd(x, n) = 1,
  \end{equation*}
  which is the same as
  \begin{equation*}
    -bn = xa - 1.
  \end{equation*}

  Define \( y \coloneqq \Rem(a, n) \). This is the multiplicative inverse of \( x \).
\end{proof}

\begin{definition}\label{def:field_extension}
  If \( \Bk \) and \( \BK \) are fields and \( \Bk \) is a unital \hyperref[def:first_order_substructure]{subring} of \( \BK \), we say that \( \Bk \) is a \Def{subfield} of \( \BK \) and that \( \BK \) is a \Def{field extension} of \( \Bk \). If \( \BK = \Bk \), we say that \( \BK \) is a \Def{trivial field extension} of \( \Bk \).

  Field extension are also denoted as \( \BK / \Bk \) to highlight the roles of \( \BK \) and \( \Bk \). This is not a quotient ring but simply a notation. See \fullref{def:galois_group}.

  We define the following
  \begin{DefEnum}
    \ILabel{def:field_extension/dimension} The extension \( \BK \) is a vector space over \( \Bk \). We denote the dimension of this vector space by
    \begin{equation*}
      [\BK : \Bk].
    \end{equation*}

    We call \( [\BK : \Bk] \) the dimension of \( \BK \) over \( \Bk \) and if \( [\BK : \Bk] \) is finite, we say that \( \BK \) is a \Def{finite extension} of \( \Bk \).

    \ILabel{def:field_extension/generated_extension} If \( x_1, \ldots, x_n \) are members of \( \BK \), we will use the following
    \begin{itemize}
      \item The ring \( \Bk[x_1, \ldots, x_n] \) obtained by evaluating \hyperref[thm:polynomial_ring_universal_property]{polynomials}.
      \item The field \( \Bk(x_1, \ldots, x_n) \) obtained by evaluating rational algebraic \hyperref[def:rational_algebraic_function]{functions}.
    \end{itemize}
  \end{DefEnum}
\end{definition}

\begin{remark}\label{remark:adjoint_extension_field}
  Any field of rational algebraic \hyperref[def:rational_algebraic_function]{functions} over \( \BK \) is always a field extension of \( \BK \). We say that the field \( \BK(X) \) is obtained from \( \BK \) by \Def{adjoining} a new element \( X \). Although formally \( X \) is a polynomial, we regard it as a symbol in the sense of \fullref{def:language}.
\end{remark}

\begin{definition}\label{def:galois_group}\MarginCite[124]{Knapp2016BAlg}
  Let \( \BK \) be a field \hyperref[def:field_extension]{extension} of \( \Bk \). The group \( \Op{Gal}(\BK / \Bk) \) of automorphisms of \( \BK \) that leave \( \Bk \) fixed is called the \Def{Galois group} of the field extension \( \BK / \Bk \).
\end{definition}

\begin{example}\label{thm:galois_group_complex_over_real}
  The Galois \hyperref[def:galois_group]{group} \( \Op{Gal}(\BC / \BR) \) is the group of all \( \BR \)-linear functions \( \varphi: \BC \to \BC \) such that
  \begin{equation*}
    \varphi(\BR) = \BR.
  \end{equation*}

  The only such functions are rotations and axial symmetries. No nontrivial rotations of the complex plane leave \( \BR \) intact and the only nontrivial axial symmetry that fixes \( \BR \) is \( a + bi \mapsto a - bi \). Hence
  \begin{equation*}
    \Op{Gal}(\BC / \BR) \cong \BZ_2.
  \end{equation*}
\end{example}

\begin{definition}\label{def:transcendetal_element}\MarginCite[454]{Knapp2016BAlg}
  We say that the element \( a \in \BK \) of the field extension \( \BK \) of \( \Bk \) is \Def{transcendental} over \( \BK \) if any of the equivalent conditions hold:
  \begin{DefEnum}
    \ILabel{def:transcendetal_element/evaluation} The evaluation \hyperref[thm:polynomial_ring_universal_property]{map} \( \Phi_a: \Bk[X] \to \Bk[a] \) is injective.

    \ILabel{def:transcendetal_element/polynomial} There exists no polynomial \( p(X) \in \Bk[X] \) such that \( p(a) = 0 \).
  \end{DefEnum}

  If \( a \) is not transcendental, we say that is is \Def{algebraic}.
\end{definition}

\begin{definition}\label{def:algebraic_extension}\MarginCite[456]{Knapp2016BAlg}
  We say that the field extension \( \BK \) of \( \Bk \) is an \Def{algebraic extension} if every element of \( \BK \) is algebraic over \( \Bk \).
\end{definition}

\begin{proposition}\label{thm:field_elements_are_algebraic}
  Every field is an \hyperref[def:algebraic_extension]{algebraic} of itself.
\end{proposition}
\begin{proof}
  If \( a \in \BK \), then \( \BK[a] = \Bk \) because every polynomial evaluates to some real element, depending on \( a \), and the constant polynomials already take all possible values. Thus \( \Phi_a \) is not injective.

  Since \( a \in \BK \) was arbitrary, we conclude that all elements from a field are algebraic over \( \BK \).
\end{proof}

\begin{theorem}\label{thm:algebraic_extension_always_exists}\MarginCite[485]{Knapp2016BAlg}
  If \( p(X) \) is a prime polynomial over the field \( \BK \), there exists an algebraic extension of \( \BK = \Bk[u] \), where \( u \in \BK \) is a root of \( p(X) \).
\end{theorem}
\begin{proof}
  Since \( p(X) \) is prime, \( \Gen{p(X)} \) is a nontrivial prime ideal. By \fullref{thm:prime_ideals_are_maximal_in_pid}, \( \Gen{p(X)} \) is maximal and by \fullref{def:maximal_ring_ideal}, the quotient \( \BK \coloneqq \Bk / \Gen{p(X)} \) is a field. It is an extension field of \( \Bk \).

  Define
  \begin{equation*}
    u \coloneqq X + \Gen{p(X)}.
  \end{equation*}

  Then
  \begin{equation*}
    p(u) = p(X + \Gen{p(X)}) = p(X) + \Gen{p(X)} = \Gen{p(X)},
  \end{equation*}
  hence \( u \) is a root of \( p(X) \) in \( \BK \).

  Thus \( u \) is algebraic over \( \Bk \) and \( \BK \) is an algebraic extension of \( \Bk \).

  It remains to show that \( \BK = \Bk[u] \). First, take a coset \( q(X) + \Gen{p(X)} \) in \( \BK \). We have
  \begin{equation*}
    q(X) + \Gen{p(X)} = (q(X) - X) + (X + \Gen{p(X)}) = (q(X) - X) + u,
  \end{equation*}
  hence this belongs in \( \Bk[u] \). Conversely, evaluating a polynomial \( q(X) \in \Bk[X] \) at \( u \) gives us
  \begin{equation*}
    q(u) = q(X + \Gen{p(X)}) = q(X) + \Gen{p(X)},
  \end{equation*}
  which is a coset of \( \BK \).
\end{proof}

\begin{proposition}\label{thm:finite_field_extensions_are_algebraic}
  Finite field extensions are algebraic.
\end{proposition}
\begin{proof}
  Fix a finite field extension \( \BK / \Bk \) and denote by \( n \) the dimension \( [\BK : \Bk] \). Assume\LEM that \( a \in \BK \) is transcendental. Then the evaluation map
  \begin{equation*}
    \Phi_a: \Bk[X] \to \Bk[a]
  \end{equation*}
  is injective. But \( \Bk[X] \) has a countably infinite monomial basis, so \( \Bk[a] \) must also have a countable basis consisting of \( 1, a, a^2, \ldots \). But \( \Bk[a] \) is a subspace of \( \Bk \), which is finite dimensional over \( \Bk \).

  The obtained contradiction proves the theorem.
\end{proof}

\begin{theorem}\label{thm:e_is_transcendental}\label{thm:eulers_constant_is_transcendental}
  \hyperref[def:exponential_function]{Euler's constant} \( e \) is transcendental over \( \BQ \).
\end{theorem}

\begin{theorem}\label{thm:pi_is_transcendental}\MarginCite[454]{Knapp2016BAlg}
  The number \( \pi \) (see \fullref{def:pi}) is transcendental over \( \BQ \).
\end{theorem}

\begin{example}\label{ex:polynomials_over_pi}
  \Fullref{thm:pi_is_transcendental} implies that the polynomials \( \BQ[X] \) can be embedded into \( \BR \) via \( \Phi_\pi: \BQ[X] \to \BR \). We can identify a polynomial
  \begin{equation*}
    p(X) = \sum_{i=0}^n a_i X^i
  \end{equation*}
  with rational coefficients with the number
  \begin{equation*}
    p(\pi) = \sum_{i=0}^n a_i \pi^i.
  \end{equation*}
\end{example}

\begin{definition}\label{def:algebraically_closed_field}\MarginCite[prop. 9.20]{Knapp2016BAlg}
  We say that the field \( \BK \) is algebraically closed if any of the equivalent conditions are satisfied:
  \begin{DefEnum}
    \ILabel{def:algebraically_closed_field/trivial_algebraic_extensions} \( \BK \) has no nontrivial algebraic \hyperref[def:algebraic_extension]{extensions}.
    \ILabel{def:algebraically_closed_field/linear_irreducible_polynomials} Every irreducible polynomial in \( \Bk[X] \) is linear.
    \ILabel{def:algebraically_closed_field/at_least_one_root} Every nonconstant polynomial in \( \Bk[X] \) has at least one root in \( \Bk \).
    \ILabel{def:algebraically_closed_field/factorization} Every polynomial in \( \Bk[X] \) \hyperref[def:factorization_in_ring]{factors} into a product of linear polynomials.
    \ILabel{def:algebraically_closed_field/exactly_n_roots} Every polynomial in \( \Bk[X] \) of degree \( n \) has exactly \( n \) roots in \( \Bk \).
  \end{DefEnum}
\end{definition}
\begin{proof}
  \SubProofImplication{def:algebraically_closed_field/trivial_algebraic_extensions}{def:algebraically_closed_field/linear_irreducible_polynomials} Let \( p(X) \) be an irreducible polynomial in \( \Bk[X] \). By \fullref{thm:ufd_prime_iff_irreducible}, \( p(X) \) is prime. By \fullref{thm:algebraic_extension_always_exists}, there exists an algebraic extension \( \BK \) of \( \Bk \) such that the prime polynomial \( p(X) \) has a root in \( \BK \). But \( \Bk \) has no nontrivial algebraic extensions, hence \( F = G \) and \( p(X) \) has a root \( u \in F \).

  If \( p(X) \) is not linear\LEM, we can divide \( p(X) \) by \( (X - u) \) to obtain a lower-degree non-constant polynomial. Hence \( p(X) \) is linear.

  \SubProofImplication{def:algebraically_closed_field/linear_irreducible_polynomials}{def:algebraically_closed_field/factorization} With induction\IND on the polynomial degree, we split a polynomial \( p(X) \) into a product of linear polynomials.

  This is obvious for \( \deg p = 1 \). Assume that the statement holds for polynomial of degree strictly less than \( n \) and let \( p(X) \) be a polynomial of degree \( n \). By \fullref{def:factorization_in_ring}, it is \hyperref[def:irreducible_ring_element]{reducible}, that is, there exist non-invertible (that is, non-constant) polynomials \( r_1(X) \) and \( r_2(X) \), such that
  \begin{equation*}
    p(X) = r_1(X) r_2(X).
  \end{equation*}

  Since both \( r_1(X) \) and \( r_2(X) \) are non-constant, they have a positive degree less than \( n \). Hence the induction\IND hypothesis holds for them and both can be factored into linear polynomials. Therefore their product \( p(X) \) can also be factored into linear polynomials.

  This completes the proof.

  \SubProofImplication{def:algebraically_closed_field/at_least_one_root}{def:algebraically_closed_field/factorization} Suppose that \( u_1 \) is a root of \( p(X) \). \Fullref{thm:polynomial_root_iff_divisible} tells us that \( p(X) \) is divisible by \( (X - u_1) \). Using induction\IND on the degree of \( p(X) \), we can factor \( p(X) \) into
  \begin{equation*}
    p(X) = a (X - u_1) (X - u_2) \cdots (X - u_n),
  \end{equation*}
  where \( a \in F \).

  \SubProofImplication{def:algebraically_closed_field/factorization}{def:algebraically_closed_field/exactly_n_roots} Follows from \fullref{thm:polynomial_root_iff_divisible} Follows from \fullref{thm:polynomial_root_iff_divisible} by induction\IND on the polynomial degree. Note that the number of roots is bounded by \( n \) (see \fullref{thm:integral_domain_polynomial_root_limit}).

  \SubProofImplication{def:algebraically_closed_field/exactly_n_roots}{def:algebraically_closed_field/trivial_algebraic_extensions} By \fullref{thm:integral_domain_polynomial_root_limit}, if \( p(X) \) has degree \( n \) and exactly \( n \) roots, then it has no more roots. Hence all roots of \( p(X) \) are already in the field \( \Bk \) and \( \Bk \) is the only algebraic extension of itself.
\end{proof}

\begin{proposition}\label{thm:no_finite_extensions_of_closed_fields}
  There exist no nontrivial finite extensions of an algebraically closed field.
\end{proposition}
\begin{proof}
  Let \( \BK \) is a finite extension of the algebraically closed field \( \Bk \). By \fullref{thm:finite_field_extensions_are_algebraic}, \( \BK \) is an algebraic extension. But every element of \( \Bk \) is already algebraic over \( \Bk \), therefore \( \BK \subseteq \Bk \).

  We conclude that \( \Bk = \BK \), hence the only finite extension of an algebraically closed field is trivial.
\end{proof}

\begin{definition}\label{def:splitting_field}\MarginCite[458]{Knapp2016BAlg}
  We say that a polynomial \( p(X) \in \BK[X] \) over the field \( \BK \) \Def{splits} if \( p(X) \) can be \hyperref[def:factorization_in_ring]{factored} into a product of linear polynomials in \( \BK[X] \).

  A \Def{splitting field} of \( p(X) \) over \( \Bk \) is a field extension \( \BK / \Bk \) such that
  \begin{itemize}
    \item \( p(X) \) splits over \( \BK \).
    \item \( \BK \) is \hyperref[def:generated_ring_ideal]{generated} by \( \Bk \) and the roots of \( p(X) \) over \( \BK \).
  \end{itemize}
\end{definition}

\begin{proposition}\label{thm:splitting_field_existence}\MarginCite[thm. 9.12]{Knapp2016BAlg}
  A splitting field exists for every polynomial \( p(X) \in \BK[X] \).
\end{proposition}

\medskip

\begin{theorem}\label{thm:galois_field_existence}\MarginCite[thm. 9.14]{Knapp2016BAlg}
  Fix a prime \hyperref[def:prime_number]{number} \( p \) and a positive integer \( n \). Then there exists up to an isomorphism a unique field with \( p^n \) elements. Furthermore, this is a splitting field for \( X^{p^n} - X \) for the field \( \BZ_p \).

  We call this field the \Def{Galois field} of \( p^n \) elements over the prime field \( \BZ_p \) and denote it by
  \( \BF_{p^n} \). We identify \( \BZ_p \) with \( \BF_p \).
\end{theorem}

\begin{theorem}\label{thm:f2_is_boolean_algebra}
  The Galois field \( \BF_2 \) is a \hyperref[def:boolean_algebra]{Boolean algebra} with joins and meets induced by the ordering (see \fullref{def:lattice_operations}) and complements given by \( \neg x \coloneqq x \mapsto x \oplus 1 \).

  More concretely:
  \begin{itemize}
    \item The top element is \( \sup \{ 0, 1 \} = 1 \)
    \item The bottom element is \( \inf \{ 0, 1 \} = 0 \)
    \item Joins are given by \( \inf \{ x, y \} = xy \)
    \item Meets are given by multiplication \( \sup \{ x, y \} = x \oplus y \oplus (x \odot y) = x \oplus y \oplus \inf \{ x, y \} \)
  \end{itemize}
\end{theorem}
\begin{proof}
  Addition and multiplication in \( \BF_2 \) works as usual integer \hyperref[def:integers]{arithmetic}, except that \( 1 \oplus 1 = 0 \):
  \begin{equation*}
    \begin{tabular}{c c | c c}
      \( x \) & \( y \) & \( x \oplus y \) & \( x \odot y \) \\
      \hline
      \( 0 \) & \( 0 \) & \( 0 \)          & \( 0 \)         \\
      \( 0 \) & \( 1 \) & \( 1 \)          & \( 0 \)         \\
      \( 1 \) & \( 0 \) & \( 1 \)          & \( 0 \)         \\
      \( 1 \) & \( 1 \) & \( 0 \)          & \( 1 \)
    \end{tabular}
  \end{equation*}

  Evidently \( 1 \) is a top element and \( 0 \) is a bottom element, thus \( \BF_2 \) is a \hyperref[def:lattice]{lattice}.

  Distributivity of multiplication over addition is inherited from \( \BZ \), however unlike in \( \BZ \), addition distributes over multiplication:
  \begin{equation*}
    \begin{tabular}{c c c | c c}
      \( x \) & \( y \) & \( z \) & \(x \odot (y \oplus z) \) & \( (x \odot y) \oplus (x \odot z) \) \\
      \hline
      \( 0 \) & \( 0 \) & \( 0 \) & \( 0 \)                   & \( 0 \)                              \\
      \( 0 \) & \( 0 \) & \( 1 \) & \( 0 \)                   & \( 0 \)                              \\
      \( 0 \) & \( 1 \) & \( 0 \) & \( 0 \)                   & \( 0 \)                              \\
      \( 0 \) & \( 1 \) & \( 1 \) & \( 0 \)                   & \( 0 \)                              \\
      \( 1 \) & \( 0 \) & \( 0 \) & \( 0 \)                   & \( 0 \)                              \\
      \( 1 \) & \( 0 \) & \( 1 \) & \( 1 \)                   & \( 1 \)                              \\
      \( 1 \) & \( 1 \) & \( 0 \) & \( 1 \)                   & \( 1 \)                              \\
      \( 1 \) & \( 1 \) & \( 1 \) & \( 1 \)                   & \( 1 \)
    \end{tabular}
  \end{equation*}

  Thus \( \BF_2 \) is a distributive \hyperref[def:distributive_lattice]{lattice}.

  It is also evident that the complementation \( \neg x = x \mapsto x \oplus 1 \) gives the desired result:
  \begin{itemize}
    \item \( \inf \{ x, \neg x \} = x \odot \neg x = x \odot (x \oplus 1) = (x \odot x) \oplus (x \odot 1) = 0 \) since \( x \odot x = x \odot 1 \).
    \item \( \sup \{ x, \neg x \} = x \oplus \neg x \oplus (x \odot \neg x) = x \oplus \neg x \oplus 0 = x \oplus (x \oplus 1) = 1 \).
  \end{itemize}

  Therefore \( (\BF_2, 1, 0, \inf, \sup, \neg x ) \) is a Boolean algebra.
\end{proof}

\begin{proposition}
  For any function \( f: \BF_n \to \BF_n \) over any Galois field \( \BF_n \), there exists a unique polynomial \( p(X) \in \BF_n[X] \) of degree \( n - 1 \) such that the corresponding function \( p(x) \) agrees with \( f(x) \) on all of \( \BF_n \).
\end{proposition}
\begin{proof}
  We simply use \fullref{thm:lagrange_interpolation} on all points of the field.
\end{proof}

\begin{algorithm}\label{alg:finite_field_polynomial_reduction}
  Let \( \BF_p \) be the \hyperref[thm:galois_field_existence]{Galois field} for some prime number \( p \). Consider the nonzero polynomial
  \begin{equation*}
    f(X_1, \ldots, X_n) \coloneqq \sum_{k_1=0}^{m_1} \cdots \sum_{k_n=0}^{m_n} a_{k_1,\ldots,k_n} X_1^{k_1} \cdots X_n^{k_n}.
  \end{equation*}

  We will build a polynomial \( \hat f(X_1, \ldots, X_n) \) of degree at most \( n - 1 \) that corresponds to the same function. In terms of the \hyperref[thm:polynomial_ring_universal_property]{evaluation homomorphism}
  \begin{equation*}
    \Phi: \BF_p[X_1, \ldots, X_n] \to \Fun(\BF_p^n, \BF_p),
  \end{equation*}
  this means that
  \begin{equation*}
    \Phi(f) = \Phi(\hat f).
  \end{equation*}

  This can be achieved by grouping some of the coefficients. The univariate case is more understandable so we will instead initially consider the polynomial
  \begin{equation*}
    g(X) \coloneqq \sum_{k=0}^m a_k X^k.
  \end{equation*}

  We will now use (and later prove) that the following two univariate polynomials evaluate to the same function:
  \begin{equation}\label{eq:alg:finite_field_polynomial_reduction/reduction}
    \Phi(X^s) = \Phi(X^{\rho(s)}),
  \end{equation}
  where
  \begin{align*}
    &\rho: \{ 1, 2, 3, \ldots \} \to \{ 1, 2, \ldots, p - 1 \} \\
    &\rho(s) \coloneqq \begin{cases}
      p - 1,          &(p - 1) \mid s \\
      \Rem(s, p - 1), &\T{times}.
    \end{cases}
  \end{align*}

  Obviously \( \rho(s) = s \) for \( s < p \). It follows from the linearity of \( \Phi \) that
  \begin{equation*}
    \hat g(X)
    \coloneqq
    \sum_{k=0}^m a_k X^{r(k)}
    =
    \sum_{j=0}^{p-1} \left( \sum_{k \in r^{-1}(j)} a_k \right) X^j
  \end{equation*}
  is the desired polynomial.

  In the multivariate case, the reduced polynomial is
  \begin{equation*}
    \hat f(X_1, \ldots, X_n) \coloneqq \sum_{j_1=0}^{p-1} \cdots \sum_{j_n=0}^{p-1} \left( \sum_{k_1 \in r^{-1}(j_1)} \cdots \sum_{k_n \in r^{-1}(j_n)} a_{k_1,\ldots,k_n} \right) X_1^{k_1} \cdots X_n^{k_n}.
  \end{equation*}

  Correctness follows, again, from the linearity of \( \Phi \).
\end{algorithm}
\begin{proof}[Proof of \eqref{eq:alg:finite_field_polynomial_reduction/reduction}]
  By \fullref{thm:fermats_little_theorem},
  \begin{equation}\label{eq:alg:finite_field_polynomial_reduction/fermat}
    \Phi(X^p) = \Phi(X).
  \end{equation}

  We now use induction on \( q \coloneqq \Quot(s, p) \).
  \begin{itemize}
    \item If \( q = 0 \), then \( s < p \) and no reduction is necessary.
    \item If \( q > 0 \), let \( s = (p - 1) q + r \). We have two cases
    \begin{itemize}
      \item If \( (p - 1) \mid s \), i.e. if \( r = 0 \), then
      \begin{BreakableAlign*}
        \Phi(X^s)
        &=
        \Phi(X^{(p-1)q})
        = \\ &=
        \Phi(X^{(p-1)(q-1) + (p-1)})
        = \\ &=
        \Phi(X^{(p-1)(q-1)}) \Phi(X^{p-1})
        \overset {\IndHyp} = \\ &=
        \Phi(X^{p-1}) \Phi(X^{p-1})
        = \\ &=
        \Phi(X^{2(p-1)})
        = \\ &=
        \Phi(X^{p+(p-2)})
        = \\ &=
        \Phi(X^p) \Phi(X^{p-2})
        \overset {\eqref{eq:alg:finite_field_polynomial_reduction/fermat}} = \\ &=
        \Phi(X^{p-1}).
      \end{BreakableAlign*}

      \item If \( r > 0 \), we have
      \begin{BreakableAlign*}
        \Phi(X^s)
        &=
        \Phi(X^{(p-1)q+r})
        = \\ &=
        \Phi(X^{[(p-1)(q-1) + r] + (p-1)})
        = \\ &=
        \Phi(X^{(p-1)(q-1)+r}) \Phi(X^{p-1})
        \overset {\IndHyp} = \\ &=
        \Phi(X^r) \Phi(X^{p-1})
        = \\ &=
        \Phi(X^{r-1}) \Phi(X^p)
        \overset {\eqref{eq:alg:finite_field_polynomial_reduction/fermat}} = \\ &=
        \Phi(X^{r-1}) \Phi(X)
        = \\ &=
        \Phi(X^r).
      \end{BreakableAlign*}
    \end{itemize}
  \end{itemize}
\end{proof}
