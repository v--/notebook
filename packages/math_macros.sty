% Missing trigonometry
\DeclareMathOperator  \arccot          {arccot}
\DeclareMathOperator  \arctantwo       {arctan2}

% Negative space
\NewDocumentCommand   \co          {m} {\operatorname*{co\negthinspace#1}}
\NewDocumentCommand   \ess         {m} {\operatorname*{ess#1}}

% Shorthand macros
\NewDocumentCommand   \op          {m} {\operatorname{#1}}
\NewDocumentCommand   \boldop      {m} {\operatorname{\mathbf{#1}}}
\NewDocumentCommand   \hi          {m} {\underline{\smash{#1}}}
\NewDocumentCommand   \logic       {m} {\textsf{#1}}
\NewDocumentCommand   \cat         {m} {\boldop{#1}}
\NewDocumentCommand   \grp         {m} {\boldop{#1}}
\NewDocumentCommand   \distr       {m} {\boldop{#1}}
\NewDocumentCommand   \anon        {s} {\IfBooleanTF {#1} {\mathbin -} {\mathbin \smblkcircle}}
\NewDocumentCommand   \Anon        {s} {\IfBooleanTF {#1} {\mathbin -} {\mathbin \mdsmblkcircle}}
\NewDocumentCommand   \bincirc     {s} {\IfBooleanTF {#1} {\thinspace \circ \thinspace} {\mathbin \circ}}
\NewDocumentCommand   \multto       {} {\rightrightarrows}
\NewDocumentCommand   \Textprime    {} {\ensuremath{'}}
\NewDocumentCommand   \vect        {m} {\overrightarrow{#1}}
\NewDocumentCommand   \bnftsq      {m} {\bnfts{\enquote{#1}}}
\NewDocumentCommand   \Dl           {} {\dl.D.}

\NewDocumentCommand \ucat {O{\mscrU}m}
  {
    \cat{#1\text{-}#2}
  }

% Properly spaced quantifiers
\NewDocumentCommand   \qdelim       {} {.}
\NewDocumentCommand   \quantifier {mm} {#1 \thinspace #2 \thinspace \qdelim \thinspace}
\NewDocumentCommand   \qexists     {m} {\quantifier \exists {#1}}
\NewDocumentCommand   \qExists     {m} {\quantifier \exists {! \thinspace #1}}
\NewDocumentCommand   \qforall     {m} {\quantifier \forall {#1}}
\NewDocumentCommand   \qabstr      {m} {\quantifier \muplambda {#1}}

% More operators
\DeclareMathOperator  \aut             {aut}
\DeclareMathOperator  \card            {card}
\DeclareMathOperator  \ceil            {ceil}
\DeclareMathOperator  \cl              {cl}
\DeclareMathOperator  \conv            {conv}
\DeclareMathOperator  \drv             {drv}
\DeclareMathOperator  \diam            {diam}
\DeclareMathOperator  \dom             {dom}
\DeclareMathOperator  \End             {end}
\DeclareMathOperator  \epi             {epi}
\DeclareMathOperator  \floor           {floor}
\DeclareMathOperator  \fr              {fr}
\DeclareMathOperator  \fun             {fun}
\DeclareMathOperator  \gph             {gph}
\DeclareMathOperator  \id              {id}
\DeclareMathOperator  \imag            {Im}
\DeclareMathOperator  \img             {img}
\DeclareMathOperator  \ind             {I}
\DeclareMathOperator  \Int             {int}
\DeclareMathOperator  \lcm             {lcm}
\DeclareMathOperator  \len             {len}
\DeclareMathOperator  \linspan         {span}
\DeclareMathOperator  \obj             {obj}
\DeclareMathOperator  \opcat           {op}
\DeclareMathOperator  \ord             {ord}
\DeclareMathOperator  \pow             {pow}
\DeclareMathOperator  \prob            {P}
\DeclareMathOperator  \quot            {quot}
\DeclareMathOperator  \range           {range}
\DeclareMathOperator  \rank            {rank}
\DeclareMathOperator  \real            {Re}
\DeclareMathOperator  \red             {red}
\DeclareMathOperator  \rem             {rem}
\DeclareMathOperator  \sgn             {sgn}
\DeclareMathOperator  \supp            {supp}
\DeclareMathOperator* \argmin          {argmin}
\DeclareMathOperator* \argmax          {argmax}
\DeclareMathOperator* \Ast             {\dingasterisk}

\NewDocumentCommand \restr {} {\vert}

\ExplSyntaxOn

\NewDocumentCommand \ifrac {smm}
{
  \IfBooleanTF {#1}
  {
    \hbox_set:Nn \l_tmpa_box { \( #2 \) }
    \dim_compare:nTF { \box_wd:N \l_tmpa_box <= 1em }
      { #2 }
      { (#2) }
    /
    \hbox_set:Nn \l_tmpa_box { \( #3 \) }
    \dim_compare:nTF { \box_wd:N \l_tmpa_box <= 1em }
      { #3 }
      { (#3) }
  }
  {
    #2 / #3
  }
}

\NewDocumentCommand \reloset {smm}
{
  \IfBooleanTF {#1}
  {
    \negthinspace
    \overset
      {
        \smash
          {
            \raisebox {-0.1em} { \( \scriptscriptstyle #2 \) }
          }
      }
      {#3}
    \negthinspace
  }
  {
    \overset
      {
        \smash
          {
            \raisebox {-0.1em} { \( \scriptscriptstyle #2 \) }
          }
      }
      {#3}
  }
}

% Math mode text with spacing
\NewDocumentCommand \T {sm}
{
  \IfBooleanTF {#1}
    { \thinspace \text{#2} \thinspace }
    { \mathrel { \text{#2} } }
}

% Permutation cycles
% https://tex.stackexchange.com/a/135899

\NewDocumentCommand \cycle {O{\enspace}m}
  {
    \parens*{ \alec_cycle:nn {#1} {#2} }
  }

\seq_new:N \l_alec_cycle_seq
\cs_new_protected:Npn \alec_cycle:nn #1 #2
  {
    \seq_set_split:Nnn \l_alec_cycle_seq {,} {#2}
    \seq_use:Nn \l_alec_cycle_seq {#1}
  }

\ExplSyntaxOff
