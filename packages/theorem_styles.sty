% Define a custom enum that can be used for obtaining "theorem 13 b)" instead of "item 13 b)" via cleveref
% Inspired by https://tex.stackexchange.com/a/162905
\newcounter{counters@theorem}

\newlist{thmenum}{enumerate}{2}
\setlist[thmenum]{
  format=\small
}
\setlist[thmenum, 1]{
  label=(\alph*),
  ref=\thecounters@theorem~(\alph*)
}
\setlist[thmenum, 2]{
  label=(\alph{thmenumi} \roman*),
  ref=\thecounters@theorem~(\alph{thmenumi} \roman*)
}

\declaretheorem[numberlike=counters@theorem]{theorem}
\declaretheorem[numberlike=counters@theorem]{proposition}
\declaretheorem[numberlike=counters@theorem]{lemma}
\declaretheorem[numberlike=counters@theorem]{corollary}
\declaretheorem[numberlike=counters@theorem]{conjecture}

\declaretheorem[numberlike=counters@theorem]{definition}
\declaretheorem[numberlike=counters@theorem]{example}
\declaretheorem[numberlike=counters@theorem]{remark}
\declaretheorem[numberlike=counters@theorem]{algorithm}

\directlua{
  for i, name in pairs({
    'theorem',
    'proposition',
    'lemma',
    'corollary',
    'conjecture',
    'definition',
    'example',
    'remark',
    'algorithm'
  }) do
    tex.print('\\addtotheorempostheadhook[' .. name .. ']{')
    tex.print('\\crefalias{thmenumi}{' .. name .. '}')
    tex.print('\\crefalias{thmenumii}{' .. name .. '}')
    tex.print('}')
  end
}
