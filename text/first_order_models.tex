\subsection{First-order models}\label{subsec:first_order_models}

\begin{definition}\label{def:propositional_model}\mcite[def. 1.4.1(i)]{Hinman2005}
  We say that the \hyperref[def:propositional_valuation/interpretation]{propositional interpretation} \( I \) is a \term{propositional model} of the set of \hyperref[def:propositional_syntax/formula]{propositional formulas} \( \Gamma \) if \( \Bracks{\varphi}_I = T \) for every formula \( \varphi \in \Gamma \).

  We also say that \( \Gamma \) is \term{valid} under \( I \), that \( I \) \term{satisfies} \( \Gamma \) and that the set \( \Gamma \) is \term{satisfiable} if there exists at least one model it.
\end{definition}

\begin{remark}\label{rem:first_order_satisfiability_bivalence}
  We will now show why \fullref{def:propositional_model} requires some adjustments for first-order formulas.

  Given a \hyperref[def:propositional_syntax/formula]{propositional formula} \( \varphi \) and an \hyperref[def:propositional_valuation/interpretation]{interpretation} \( I \), the latter \hyperref[def:propositional_model]{satisfies} either \( \varphi \) or \( \neg \varphi \). This is the principle of bivalence discussed in \fullref{rem:classical_logic}.

  Similarly, given a \hyperref[def:first_order_valuation/variable_assignment]{first-order variable assignment} \( v \) in the \hyperref[def:first_order_structure]{structure} \( \mscrX \) and a \hyperref[def:first_order_syntax/formula]{first-order formula} \( \varphi \), either \( \Bracks{\varphi} = T \) or \( \Bracks{\neg \varphi}_v = T \).

  It is obvious how we should define satisfiability for a concrete variable assignment, but the question remains how to define it for a structure.

  Fix an arbitrary structure \( \mscrX = (X, I) \) with two elements \( X = \set{ a, b } \) and consider the formula \( \xi \doteq \eta \). Let \( v \) be any variable assignment such that \( v(\xi) = v(\eta) = a \) and let \( w \) be an assignment such that \( w(\xi) = a \) and \( w(\eta) = b \). Clearly \( \Bracks{\xi \doteq \eta}_v = T \) and \( \Bracks{\xi \doteq \eta}_w = F \). Thus, some assignments satisfy the formula and some do not.

  It makes sense to define
  \begin{equation*}
    \Bracks{\varphi}_\mscrX
    \coloneqq
    \begin{cases}
      T, \Bracks{\varphi}_v = T \T{for every assignment} v, \\
      F, \T{otherwise}.
    \end{cases}
  \end{equation*}

  This is what Peter Hinman in \cite[rem. 2.2.17]{Hinman2005} calls \term{universally valid} formulas in \( \mscrX \).

  We just saw that \( \xi \doteq \eta \) is not universally valid. But neither is \( \xi \doteq \eta \) because
  \begin{equation*}
    \Bracks{\neg (\xi \doteq \eta)}_v = \overline{\Bracks{\xi \doteq \eta}_v} = F
  \end{equation*}

  Therefore, the principle of bivalence does not hold for universal validity. In order for it to hold, what we will do in \fullref{def:first_order_model} is restrict ourselves to \hyperref[def:first_order_syntax/closed_formula]{closed formulas}, which depend only on the underlying structure and not on the variable assignments.
\end{remark}

\begin{definition}\label{def:universal_closure}\mcite[def. 2.2.28(i)]{Hinman2005}
  Given a formula \( \varphi \) with free variables \( \xi_1, \ldots, \xi_n \), we call
  \begin{equation*}
    \qforall {\xi_1} \cdots \qforall {\xi_n} \varphi
  \end{equation*}
  its \term{universal closure} and say that \( \varphi \) itself is \term{implicitly universally quantified}. Universal closures of quantifierless formulas are called \term{universal formulas}.
\end{definition}
\begin{comments}
  \item This allows us to skip quantifiers when writing formulas without changing their validity. This is useful for notational brevity and is used all across the document whenever we want \hi{closed} formulas, for example in \fullref{def:semiring/theory}, \fullref{def:semiring/theory} or \fullref{def:binary_relation}.
\end{comments}

\begin{proposition}\label{thm:implicit_universal_quantification}
  Every first-order formula is semantically equivalent to its \hyperref[def:universal_closure]{universal closure}.
\end{proposition}
\begin{comments}
  \item See \fullref{ex:def:first_order_natural_deduction_system/eigenvariables/invalid_universal_closure} for how this fails for derivability rather than entailment.
\end{comments}
\begin{proof}
  \SufficiencySubProof Let \( \mscrX = (X, I) \) be a structure that satisfies \( \varphi \). Let \( v \) be a variable assignment in \( \mscrX \). Then for any \( x \in X \), the modified variable assignment \( v_{\xi \mapsto x} \) also satisfies \( \varphi \), i.e.
  \begin{equation*}
    \Bracks{\varphi}_v = \Bracks{\varphi}_{v_{\xi \mapsto x}} = T.
  \end{equation*}

  Thus, \( \mscrX \) is also a model for \( \qforall \xi \varphi \).

  \NecessitySubProof Conversely, suppose that \( \mscrX \) satisfies \( \qforall \xi \varphi \) and \( v \) is any variable assignment. Then
  \begin{equation*}
    \Bracks{\varphi}_{v_{\xi \mapsto x}} = T
  \end{equation*}
  for any \( x \), including \( x = v(\xi) \). Thus,
  \begin{equation*}
    \Bracks{\varphi}_{v_{\xi \mapsto v(\xi)}} = \Bracks{\varphi}_v = T.
  \end{equation*}

  Therefore, \( \mscrX \) is also a model for \( \varphi \).
\end{proof}

\begin{definition}\label{def:first_order_model}\mcite[def. 2.2.13(ii)]{Hinman2005}
  We say that the \hyperref[def:first_order_structure]{first-order structure} \( \mscrX = (X, I) \) is a \term{first-order model} of the set of \hyperref[def:first_order_syntax/closed_formula]{closed first-order formulas} \( \Gamma \) if, for an arbitrary variable assignment \( v \) in \( \mscrX \), \( \Bracks{\varphi}_v = T \) for every formula \( \varphi \in \Gamma \).

  We also say that \( \Gamma \) is \term{valid} in \( \mscrX \), that \( \mscrX \) \term{satisfies} \( \Gamma \) and that the set \( \Gamma \) is \term{satisfiable} if there exists at least one model it.
\end{definition}
\begin{comments}
  \item Since the formulas are closed, the result does not depend on the assignment. We only assignments as a technical tool because we avoid defining entailment within a structure. The problems of doing the latter are discussed in \fullref{rem:first_order_satisfiability_bivalence}.
\end{comments}

\begin{remark}\label{rem:first_order_model_notation}
  In first-order logic, \hyperref[def:first_order_structure]{structures} are defined as pairs \( \mscrX = (X, I) \). Each area of mathematics has its own conventions and structures are usually specified as simply as possible without being unambiguous (and sometimes even beyond non-ambiguity).

  A popular convention is to use compatible letters like we did with \( X \) and \( \mscrX \) or \( G \) and \( \mscrG \), where the structure itself is named using calligraphic letters while the domain is named using the corresponding capital letter in normal font. This only works very simple cases where we can say \enquote{Let \( \mscrP = (P, \leq) \) be a \hyperref[def:partially_ordered_set]{partially ordered set}}.

  The language of the \hyperref[def:group/theory]{theory of groups} has a signature consisting of three functional symbols and no predicate symbols. Specifying a structure for this language is thus the same as specifying a quadruple \( \mscrG = (G, e, (\anon)^{-1}, \cdot) \). We usually specify only the domain \( G \) and the basic structure needed to avoid ambiguity, for example \enquote{Let \( (G, \cdot) \) be a group}. This is technically wrong, but it is both convenient and conventional. The rest of the definition of the group can easily be inferred. In case of ambiguity, the simplest disambiguation is to use lower indices with the name of the structure, e.g. \( +_G \) and \( +_H \) may be the addition operation in different abelian groups.

  Furthermore, stating that \( (G, \cdot, \leq, \mscrT) \) is a totally ordered topological group is cumbersome and can even raise questions; for example, is \( \mscrT \) the \hyperref[def:order_topology]{order topology} or just an arbitrary \hyperref[rem:topological_first_order_structures]{group topology}?
\end{remark}

\begin{remark}\label{rem:trivial_structure}
  Fix a language \( \mscrL \). If there exists a unique up to an isomorphism structure of minimal \hyperref[thm:cardinality_existence]{cardinality}, we call is \enquote{the} \term{trivial structure} of \( \mscrL \).

  The domain usually consists of a subset of the language's constant symbols with a straightforward interpretation. See for example the trivial ring defined in \fullref{def:ring/trivial} and the trivial lattice defined in \fullref{def:semilattice/trivial}. In both examples the trivial structure differs from the initial structure in the sense of \fullref{thm:substructures_form_complete_lattice/bottom}.
\end{remark}

\begin{remark}\label{rem:questions_regarding_structures}
  Within this section, we are interested in the following questions regarding \hyperref[def:first_order_structure]{first-order structure} and \hyperref[def:first_order_model]{models}:

  \begin{itemize}
    \item Which subsets of a structure form a \hyperref[def:first_order_substructure]{substructure}?

    This is answered by \fullref{def:first_order_substructure} and by \fullref{def:first_order_generated_substructure}. Vacuously, if the language contains no functional symbols, by \fullref{thm:first_order_generated_substructures_exist} every subset of a structure is a substructure. Such is the case with \hyperref[def:set]{sets} themselves, with \hyperref[def:partially_ordered_set]{partially ordered sets} or with \hyperref[def:metric_space]{metric} and \hyperref[def:topological_space]{topological spaces}.

    \Fullref{thm:substructures_form_complete_lattice} shows that the set of all substructures of a structure is worth studying in itself.

    \item Given a model of some set \( \Gamma \) of formulas, which substructures and \hyperref[def:first_order_homomorphism]{homomorphic} images of the model are again models of \( \Gamma \)?

    This is answered by \fullref{thm:positive_formulas_preserved_under_homomorphism}, \fullref{thm:arbitrary_formulas_preserved_under_isomorphisms} and \fullref{thm:functions_over_model_form_model}.
  \end{itemize}
\end{remark}

\begin{definition}\label{def:first_order_substructure}\mcite[def. 2.3.12]{Hinman2005}
  Let \( \mscrX = (X, I) \) be a structure for the language \( \mscrL \) and let \( Y \subseteq X \). We say that \( \mscrY = (Y, J) \) is a \term{substructure} of \( \mscrX \) if:

  \begin{thmenum}
    \thmitem{def:first_order_substructure/universe} The universe \( Y \) satisfies either of the equivalent conditions:

    \begin{thmenum}
      \thmitem{def:first_order_substructure/universe/deductive} It is closed under function application, that is, for any functional symbol \( f \) in \( \mscrL \) with arity \( n \), we have \( I(f)(Y^n) \subseteq Y \).

      \thmitem{def:first_order_substructure/universe/inductive} It is a \hyperref[def:fixed_point]{fixed point} of the operator
      \begin{equation*}
        \begin{aligned}
          &T: \pow(X) \to \pow(X), \\
          &T(A) \coloneqq A \cup \set*{ x \in X \given \qexists{f \in \boldop{Fun}} \qexists{x_1, \ldots, x_{\#f} \in A} \Bracks{f}_\mscrX(x_1, \ldots, x_{\#f}) = x },
        \end{aligned}
      \end{equation*}
      which enlarges \( A \) with the union of all image of \( A \) under functions of the language \( \mscrL \).
    \end{thmenum}

    \thmitem{def:first_order_substructure/functional} For every functional symbol \( f \in \boldop{Fun}_\mscrL \), the interpretation \( J(f) \) is a restriction of \( I(f) \) to \( Y \).

    \thmitem{def:first_order_substructure/predicate} For every predicate symbol \( p \in \boldop{Pred}_\mscrL \), the interpretation \( J(p) \) is a restriction of \( I(p) \) to \( Y \).
  \end{thmenum}
\end{definition}
\begin{defproof}
  \ImplicationSubProof{def:first_order_substructure/universe/deductive}{def:first_order_substructure/universe/inductive} By definition of \( T \), \( Y \) if a fixed point if and only if
  \begin{equation*}
    \set*{ x \in X \given \qexists{f \in \boldop{Fun}} \qexists{x_1, \ldots, x_{\#f} \in A} \Bracks{f}_\mscrX(x_1, \ldots, x_{\#f}) = x } \subseteq Y.
  \end{equation*}

  This condition is clearly satisfied if \( B \) satisfies \fullref{def:first_order_substructure/universe/deductive}.

  \ImplicationSubProof{def:first_order_substructure/universe/inductive}{def:first_order_substructure/universe/deductive} If, instead \( Y \) is a fixed point of \( T \), for the \( n \)-ary functional symbol \( f \in \boldop{Fun} \) and for any tuple \( x_1, \ldots, x_n \), the value \( I(f)(x_1, \ldots, x_n) \) belongs to \( Y \). Therefore, \fullref{def:first_order_substructure/universe/deductive} is satisfied.
\end{defproof}

\begin{example}\label{ex:def:first_order_substructure/vector_space}
  The classic definition for a subset \( U \) of a \hyperref[def:vector_space]{vector space} \( \mscrV \) being a vector subspace is that \( U \) is closed under \hyperref[rem:linear_combinations]{linear combinations}. Linear combinations are simply finite \hyperref[def:multi_valued_function/superposition]{superpositions} of addition and scalar multiplication in \( \mscrV \). So this condition ensures that \( U \) is closed under application of the functional symbols corresponding to addition and scalar multiplication.

  See \fullref{thm:span_via_linear_combinations} for a further discussion.
\end{example}

\begin{remark}\label{rem:topological_first_order_structures}
  Let \( \mscrX = (X, I) \) be a structure over some language \( \mscrL \) without predicate symbols.

  If, for every functional symbol \( f \), the interpretation \( I(f) \) is a \hyperref[def:global_continuity]{continuous function}, we call \( \mscrX \) a \term{topological structure}.

  For every algebraic structure defined in \fullref{sec:group_theory} and \fullref{sec:ring_theory}, there exists a topological equivalent. We discuss \hyperref[def:topological_group]{topological groups} and \hyperref[def:topological_vector_space]{topological vector spaces} through the document, especially in \fullref{sec:functional_analysis}.

  Naturally, every substructure of a topological structure is again a topological structure.
\end{remark}

\begin{proposition}\label{thm:intersection_structure}
  Let \( \seq{ (Y_k, J_k) }_{k \in \mscrK} \) be a family of substructures of \( \mscrX \). Then their \term{intersection structure} \( \parens*{\bigcap_{k \in \mscrK} Y_k, \bigcap_{k \in \mscrK} J_k} \) is again a substructure of \( \mscrX \).
\end{proposition}
\begin{proof}
  For any functional symbol \( f \) in \( \mscrL \) with arity \( n \), we have
  \begin{equation*}
    I(f)\parens*{\parens*{\bigcap_{\smash{k \in \mscrK}} Y_k}^n}
    \reloset {\ref{thm:def:function_image/intersection}} \subseteq
    \bigcap_{k \in \mscrK} I(f)(Y_k^n).
  \end{equation*}

  Therefore, \( \parens*{\bigcap_{k \in \mscrK} Y_k, \bigcap_{k \in \mscrK} J_k} \) is indeed a substructure of \( \mscrX \).
\end{proof}

\begin{definition}\label{def:first_order_generated_substructure}\mimprovised
  Let \( \mscrX = (X, I) \) be a structure over \( \mscrL \) and let \( A \subseteq X \) be any set. The set \( A \) is said to \term[bg=поражда,ru=порождает]{generate} the substructure \( \mscrY = (Y, J) \) if it satisfies any of the equivalent statements:
  \begin{thmenum}
    \thmitem{def:first_order_generated_substructure/smallest} Out of all substructures of \( \mscrX \) whose domain contains \( A \), the domain \( \mscrY \) is the smallest with respect to \hyperref[def:subset]{set inclusion}.

    \thmitem{def:first_order_generated_substructure/intersection} \( \mscrY \) is the \hyperref[thm:intersection_structure]{intersection structure} of all substructures of \( \mscrX \) that contain \( A \).
  \end{thmenum}
\end{definition}
\begin{defproof}
  \EquivalenceSubProof{def:first_order_generated_substructure/smallest}{def:first_order_generated_substructure/intersection} Let \( \seq{ (Y_k, J_k) }_{k \in \mscrK} \) be the family of all substructures of \( \mscrX \) whose domains contain \( A \). Fix one of these substructures, say \( (Y_{k_0}, J_{k_0}) \).

  We have the obvious inclusion
  \begin{equation*}
    \bigcap_{k \in \mscrK} Y_k \subseteq Y_{k_0}.
  \end{equation*}

  The reverse inclusion holds if and only if \( Y_{k_0} \) is contained in each one of domains \( Y_k \) for \( k \in \mscrK \). In other words, \( Y_{k_0} \) is the smallest of the domains \( \seq{ Y_k }_{k \in \mscrK} \) with respect to set inclusion if and only if \( Y_{k_0} \) equals their intersection.
\end{defproof}

\begin{example}\label{ex:def:first_order_generated_substructure}
  Common examples of generated substructures are the \hyperref[def:semimodule/submodel]{linear span} discussed in \fullref{thm:span_via_linear_combinations} and the \hyperref[def:semiring_ideal/generated]{generated ring ideals}.
\end{example}

\begin{proposition}\label{thm:first_order_generated_substructures_exist}
  Let \( \mscrX = (X, I) \) be a structure for the language \( \mscrL \) and let \( A \) be an arbitrary subset of \( X \). Then there exists a unique substructure \( \mscrY = (Y, I) \) \hyperref[def:first_order_generated_substructure]{generated} by \( A \).

  Furthermore, if \( \mscrL \) has no functional symbols, then \( A = Y \).
\end{proposition}
\begin{proof}
  Given a set \( A \subseteq X \), we apply \fullref{thm:knaster_tarski_theorem} to the \hyperref[thm:boolean_algebra_of_subsets]{Boolean algebra of all subsets} \( \pow(X) \) with the operator
  \begin{equation*}
    \begin{aligned}
      &R: \pow(X) \to \pow(X) \\
      &R(B) \coloneqq A \cup T(B),
    \end{aligned}
  \end{equation*}
  where \( T \) is defined in \fullref{def:first_order_substructure/universe/inductive}.

  We thus obtain the smallest fixed point \( Y \) of \( T \), which contains \( A \) and satisfies \fullref{def:first_order_substructure/universe/inductive}. The structure \( \mscrY = (Y, J) \), where \( J \) is obtained from \( I \) by restricting all functions to \( Y \), is thus a substructure of \( \mscrX \).

  If there are no functional symbols in \( \mscrL \), both conditions in \fullref{def:first_order_substructure/universe} are vacuously satisfied for \( A \), and hence it is the fixed point of \( R \).
\end{proof}

\begin{proposition}\label{thm:substructures_form_complete_lattice}
  Fix a structure \( \mscrX = (X, I) \) for the language \( \mscrL \).

  With respect to set inclusion of domains, the set of all substructures of a \( \mscrX \) forms a complete lattice that is isomorphic to a \hyperref[def:semilattice/complete]{complete} \hyperref[def:semilattice/submodel]{sublattice} of the Boolean algebra \( \pow(X) \) described in \fullref{thm:boolean_algebra_of_subsets}.

  Explicitly:
  \begin{thmenum}
    \thmitem{thm:substructures_form_complete_lattice/join} The \hyperref[def:semilattice/join]{join} of the family of substructures with domains \( \seq{ (Y_k, J_k) }_{k \in \mscrK} \) is the \hyperref[def:first_order_generated_substructure]{generated substructure} of the set \( \bigcup_{k \in \mscrK} Y_k \).

    \thmitem{thm:substructures_form_complete_lattice/top} The \hyperref[def:extremal_points/top_and_bottom]{top element} is the structure \( \mscrX \) itself. Any substructures that are different from \( \mscrX \) are called \term{proper}.

    \thmitem{thm:substructures_form_complete_lattice/meet} The \hyperref[def:semilattice/meet]{meet} of the family of substructures \( \seq{ (Y_k, J_k) }_{k \in \mscrK} \) is simply the \hyperref[thm:intersection_structure]{intersection structure} \( \parens*{\bigcap_{k \in \mscrK} Y_k, \bigcap_{k \in \mscrK} J_k} \).

    \thmitem{thm:substructures_form_complete_lattice/bottom} The \hyperref[def:extremal_points/top_and_bottom]{bottom element} of this lattice is the intersection of all substructures. This is called the \term{initial substructure}. The name is inspired by \fullref{thm:order_category_isomorphism_properties/universal}.
  \end{thmenum}
\end{proposition}
\begin{comments}
  \item The initial substructure may or may not be isomorphic to the \hyperref[rem:trivial_structure]{trivial structure}.

  \item As discussed in \fullref{rem:empty_first_order_structures}, the empty set is not allowed to be the domain of a structure by definition. Nevertheless, for the sake of having a bottom element we allow structures with empty domains in this lattice.
\end{comments}
\begin{proof}
  \SubProofOf{thm:substructures_form_complete_lattice/join} Let \( (Y, J) \) be the generated substructure of the set \( A \coloneqq \bigcup_{k \in \mscrK} \mscrY_k \). From \fullref{def:first_order_generated_substructure/smallest} it follows that out of the domains of all substructures of \( \mscrX \), \( Y \) is the smallest that contains \( A \) and hence the smallest that contains \( Y_k \) for all \( k \in \mscrK \). Therefore, it is indeed the supremum of the family \( \seq{ (Y_k, J_k) }_{k \in \mscrK} \) with respect to set inclusion of domains.

  \SubProofOf{thm:substructures_form_complete_lattice/top} Since \( \mscrX \) is a substructure of itself, it is not only the supremum of the entire lattice, but actually the maximum.

  \SubProofOf{thm:substructures_form_complete_lattice/meet} The domain of the intersection structure of the family \( \seq{ (Y_k, J_k) }_{k \in \mscrK} \) of substructures of \( \mscrX \) is the infimum of the family as a consequence of the equivalence in \fullref{def:first_order_generated_substructure}.

  \SubProofOf{thm:substructures_form_complete_lattice/bottom} It follows from \fullref{thm:substructures_form_complete_lattice/meet} that the bottom element is the intersection of all substructures of \( \mscrX \).
\end{proof}

\begin{definition}\label{def:first_order_homomorphism}\mcite[def. 2.3.26(i) \\ rem. 2.3.27]{Hinman2005}
  Let \( \mscrX = (X, I) \) and \( \mscrY = (Y, J) \) be structures over a common language. We say that the \hyperref[def:function]{function} \( h: X \to Y \) is a \term{homomorphism} between \( \mscrX \) and \( \mscrY \) if it preserves all functions and relations. Explicitly:
  \begin{thmenum}
    \thmitem{def:first_order_homomorphism/functions} For any functional symbol \( f \in \boldop{Fun} \) of arity \( n \) and any tuple \( x_1, \ldots, x_n \in X \) we have
    \begin{equation*}
      h\parens[\Big]{ I(f)(x_1, \ldots, x_n) } = J(f) \parens[\Big]{ h(x_1), \ldots, h(x_n) }
    \end{equation*}

    \thmitem{def:first_order_homomorphism/predicates} For any predicate symbol \( p \in \boldop{Pred} \) of arity \( n \) and any \( x_1, \ldots, x_n \in X \),
    \begin{equation*}
      I(p) (x_1, \ldots, x_n) = T \T{implies} J(p) \parens[\Big]{ h(x_1), \ldots, h(x_n) } = T.
    \end{equation*}
  \end{thmenum}
\end{definition}
\begin{comments}
  \item We sometimes use the notation \( h: \mscrX \to \mscrY \).
  \item Note that the condition \fullref{def:first_order_homomorphism/predicates} for predicates is strictly weaker than
  \begin{equation*}
    I(p) (x_1, \ldots, x_n) = J(p) \parens[\Big]{ h(x_1), \ldots, h(x_n) },
  \end{equation*}
  which is used in \fullref{def:first_order_embedding} to define embeddings.

  Peter Hinman in \cite[def. 2.3.26(i)]{Hinman2005} requires the latter condition, and then in \cite[rem. 2.3.27]{Hinman2005} calls \term{positive homomorphism} out definition.

  We see this as unnecessarily complicated since most of our use cases like \hyperref[def:partially_ordered_set]{partially ordered sets} and \hyperref[def:directed_multigraph/simple]{simple graphs} are covered precisely by (what we just called) positive homomorphisms.
\end{comments}

\begin{proposition}\label{thm:def:first_order_homomorphism}
  \hyperref[def:first_order_homomorphism]{First-order structure homomorphisms} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:first_order_homomorphism/submodel} If \( \mscrX = (X, I) \) is a structure and \( \mscrY = (Y, I) \) is a \hyperref[def:first_order_substructure]{substructure} of \( \mscrX \), then the \term{canonical embedding} function
    \begin{equation}\label{thm:def:first_order_homomorphism/submodel/canonical_embedding}
      \begin{aligned}
        &\iota: Y \to X \\
        &\iota(y) \coloneqq y
      \end{aligned}
    \end{equation}
    is indeed a homomorphism (and thus an embedding in the sense of \fullref{def:first_order_embedding}).

    \thmitem{thm:def:first_order_homomorphism/image_is_substructure} Given a homomorphism \( h: \mscrX \to \mscrY \), its image \hyperref[def:multi_valued_function/image]{image} \( (h[X], J) \) is a substructure of \( \mscrY \).

    \thmitem{thm:def:first_order_homomorphism/composition} The \hyperref[def:multi_valued_function/composition]{composition} of two homomorphisms is again a homomorphism.

    \thmitem{thm:def:first_order_homomorphism/term_valuation} Fix a homomorphism \( h: X \to Y \) and a term \( \tau \). For any variable assignments \( v \) and \( w \) such that \( w(\xi) = h(v(\xi)) \) for all \( \xi \in \boldop{Var}(\tau) \), we have
    \begin{equation*}
      h(\Bracks{\tau}_v) = \Bracks{\tau}_w.
    \end{equation*}
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:first_order_homomorphism/submodel} The interpretation in the substructure \( \mscrY \) is the \hyperref[def:multi_valued_function/restriction]{restriction} \( J \) of \( I \) to \( Y \). Thus, \( \mscrY = (Y, J) \) is a structure. Conditions \fullref{def:first_order_homomorphism/functions} and \fullref{def:first_order_homomorphism/predicates} are thus satisfied. Hence, \( \iota \) is a homomorphism.

  \SubProofOf{thm:def:first_order_homomorphism/image_is_substructure} We must show that the image \( h[X] \) satisfies \fullref{def:first_order_substructure/universe/deductive} and thus the domain of a substructure of \( \mscrY \).

  Indeed, due to \fullref{def:first_order_homomorphism/functions}, for any \( n \)-ary functional symbol and any tuple \( x_1, \ldots, x_n \) from \( X \), we have that
  \begin{equation*}
    J(f) \parens[\Big]{ h(x_1), \ldots, f(x_n) }
    \reloset {\ref{def:first_order_homomorphism/functions}} =
    h\parens[\Big]{ I(f)(x_1, \ldots, x_n) }
    \reloset {\ref{def:first_order_substructure/universe/deductive}} \in
    h[X].
  \end{equation*}

  \SubProofOf{thm:def:first_order_homomorphism/composition} Let \( h: \mscrX \mapsto \mscrY \) and \( l: \mscrY \mapsto \mscrZ \) both be homomorphisms. Then \( l \bincirc h: \mscrX \to \mscrY \) is a homomorphism:

  \begin{itemize}
    \item \Fullref{def:first_order_homomorphism/functions} is satisfied because for any \( n \)-ary functional symbol \( f \) and any tuple \( x_1, \ldots, x_n \in X \),
    \small
    \begin{equation*}
      (l \bincirc h) \parens[\Big]{ I(f)(x_1, \ldots, x_n) }
      \reloset {\ref{def:first_order_homomorphism/functions}} =
      l\parens[\Big]{ J(f) \parens[\Big]{ h(x_1), \ldots, h(x_n) } }
      \reloset {\ref{def:first_order_homomorphism/functions}} =
      I_{\mscrZ}(f) \parens[\Big]{ (l \bincirc h)(x_1), \ldots, (l \bincirc h)(x_n) }.
    \end{equation*}
    \normalsize

    \item \Fullref{def:first_order_homomorphism/predicates} is satisfied because for any \( n \)-ary predicate symbol \( p \) and any tuple \( x_1, \ldots, x_n \in X \),
    \begin{equation*}
      I(p) (x_1, \ldots, x_n)
      \reloset {\ref{def:first_order_homomorphism/predicates}} =
      J(p) \parens[\Big]{ h(x_1), \ldots, h(x_n) }
      \reloset {\ref{def:first_order_homomorphism/predicates}} =
      I_{\mscrZ}(p) \parens[\Big]{ (l \bincirc h)(x_1), \ldots, (l \bincirc h)(x_n) }.
    \end{equation*}
  \end{itemize}

  \SubProofOf{thm:def:first_order_homomorphism/term_valuation} We use induction on the structure of \( \tau \).
  \begin{itemize}
    \item If \( \tau \) is a variable, the statement is obvious from the compatibility condition for \( v \) and \( w \).
    \item If \( \tau = f(\kappa_1, \ldots, \kappa_m) \), then
    \begin{align*}
      \Bracks{\tau}_w
      &=
      I(f) \parens[\Big]{ \Bracks{\kappa_1}_w, \ldots, \Bracks{\kappa_m}_w }
      = \\ &=
      I(f) \parens[\Big]{ h(\Bracks{\kappa_1}_v), \ldots, h(\Bracks{\kappa_m}_v) }
      \reloset {\ref{def:first_order_homomorphism/functions}} = \\ &=
      h\parens[\Big]{ I(f) \parens[\Big]{ \Bracks{\kappa_1}_v, \ldots, \Bracks{\kappa_m}_v } }
      = \\ &=
      h(\Bracks{\tau}_v).
    \end{align*}
  \end{itemize}
\end{proof}

\begin{definition}\label{def:positive_formula}\mcite[def. 3.5.67]{Hinman2005}
  The following grammar rule, extending the \hyperref[def:first_order_syntax/grammar_schema]{grammar schema of first-order logic}, describes what we call \term{positive formulas}:
  \begin{bnf*}
    \bnfprod{positive formula} {\bnftsq{\( \top \)} \bnfor} \\
    \bnfmore                   {\bnfpn{atomic formula} \bnfor} \\
    \bnfmore                   {\bnftsq{(} \bnfsp \bnfpn{formula} \bnfsp \bnftsq{\( \vee \)} \bnfsp \bnfpn{formula} \bnfsp \bnftsq{)} \bnfor} \\
    \bnfmore                   {\bnftsq{(} \bnfsp \bnfpn{formula} \bnfsp \bnftsq{\( \wedge \)} \bnfsp \bnfpn{formula} \bnfsp \bnftsq{)} \bnfor} \\
    \bnfmore                   {\bnfpn{quantifier} \bnfsp \bnfpn{variable} \bnfsp \bnftsq{.} \bnfsp \bnfpn{formula}}
  \end{bnf*}
\end{definition}
\begin{comments}
  \item The point of positive formulas is to avoid \hyperref[def:propositional_language/negation]{negation \( \neg \)}. We also avoid \( \rightarrow \) because, assuming classical logic, \fullref{thm:boolean_equivalences/conditional_as_disjunction} would then allow us to introduce negation.

  \item Positive formulas are used in \fullref{thm:positive_formulas_preserved_under_homomorphism}, which fails to hold for some non-positive formulas --- see \fullref{ex:monoid_cancellation_not_preserved_by_homomorphism}.

  \item When dealing with first-order logic, we simply use \hyperref[thm:first_order_substitution_equivalence/propositional]{substitution} to replace propositional variables with atomic formulas. This way we obtain positive first-order formulas with \hyperref[thm:implicit_universal_quantification]{implicit universal quantification}. Of course, we can always add explicit universal quantifiers, but we avoid existential quantifiers because of \fullref{thm:first_order_quantifiers_are_dual}.
\end{comments}

\begin{proposition}\label{thm:positive_formulas_preserved_under_homomorphism}
  A \hyperref[def:first_order_homomorphism]{first-order homomorphism} preserves models of closed \hyperref[def:positive_formula]{positive formulas}.

  More concretely, given some language \( \mscrL \), if \( \Gamma \) is a set of closed positive formulas and \( h: \mscrX \to \mscrY \) is a homomorphism between \hyperref[def:first_order_model]{models} of \( \Gamma \), then the image \( h[X] \) is also (the domain of) a model of \( \Gamma \).
\end{proposition}
\begin{comments}
  \item Compare this to \fullref{thm:arbitrary_formulas_preserved_under_isomorphisms}, which places restrictions on the homomorphism rather than the formulas.
\end{comments}
\begin{proof}
  Since the formulas in \( \Gamma \) are closed, we are free to choose any variable assignment we like. Via \fullref{thm:induction_on_syntax_trees} on an arbitrary positive formula \( \varphi \), we will show that, for every variable assignment \( w \) in \( \mscrY \), there exists an assignment \( v \) in \( \mscrX \) such that \( \Bracks{\varphi}_v = T \) implies \( \Bracks{\varphi}_w = T \).

  Let \( w \) a variable assignment in \( \mscrY \). Let \( v \) be an assignment in \( \mscrX \) such that, for any variable \( \xi \), we have
  \begin{equation*}
    h(v(\xi)) = w(\xi).
  \end{equation*}

  The \hyperref[def:zfc/choice]{axiom of choice} guarantees the existence of such an assignment. Furthermore, if \( h \) is injective, this assignment is unique.

  The inductive hypothesis is more general than \enquote{\( \Bracks{\varphi}_v = T \) implies \( \Bracks{\varphi}_w = T \)} because of the more complicated case of quantified formulas. Nonetheless, given our fixed assignments \( v \) and \( w \), the inductive conclusion in turn implies that the image \( h[X] \) satisfies any closed positive formula if \( \mscrX \) does, in particular the formulas from \( \Gamma \).

  \begin{itemize}
    \item The constant \( \top \) is vacuously preserved by homomorphisms because it does not depend on the interpretation or variable assignment.

    \item Suppose that \( \varphi = \tau_1 \doteq \tau_2 \). We have \( \Bracks{\tau_1}_v = \Bracks{\tau_2}_v \) and hence
    \begin{equation*}
      \Bracks{\tau_1}_w
      \reloset {\ref{thm:def:first_order_homomorphism/term_valuation}} =
      h(\Bracks{\tau_1}_v)
      =
      h(\Bracks{\tau_2}_v)
      \reloset {\ref{thm:def:first_order_homomorphism/term_valuation}} =
      \Bracks{\tau_2}_w.
    \end{equation*}

    \item Suppose that \( \varphi \) is the predicate formula \( p(\tau_1, \ldots, \tau_n) \). By assumption, \( \vDash_v p(\tau_1, \ldots, \tau_n) \). Then
    \begin{equation}\label{eq:thm:positive_formulas_preserved_under_homomorphism/predicates/x}
      I(p) \parens[\Big]{ \Bracks{\tau_1}_v, \ldots, \Bracks{\tau_n}_v } = T.
    \end{equation}

    By the definition of homomorphism, this implies
    \begin{equation}\label{eq:thm:positive_formulas_preserved_under_homomorphism/predicates/y}
      J(p) \parens[\Big]{ \underbrace{h(\Bracks{\tau_1}_v)}_{\Bracks{\tau_1}_w}, \ldots, \underbrace{h(\Bracks{\tau_n}_v)}_{\Bracks{\tau_n}_w} } = T.
    \end{equation}

    Now \( \vDash_w p(\tau_1, \ldots, \tau_n) \) follows from \fullref{thm:def:first_order_homomorphism/term_valuation}.

    \item Suppose that \( \varphi = \psi_1 \wedge \psi_2 \), where \( \psi_1 \) and \( \psi_2 \) are positive formulas, and that the inductive hypothesis holds for \( \psi_1 \) and \( \psi_2 \).

    Since \( \Bracks{\varphi}_v = T \) by assumption, by definition of valuation of conjunction we have
    \begin{equation*}
      \Bracks{\psi_1}_v
      =
      \Bracks{\psi_2}_v
      =
      T.
    \end{equation*}

    This allows us to apply the inductive hypothesis to obtain
    \begin{equation*}
      \Bracks{\psi_1}_w
      =
      \Bracks{\psi_2}_w
      =
      T.
    \end{equation*}
    and conclude that
    \begin{equation*}
      \Bracks{\varphi}_w
      =
      \Bracks{\psi_1}_w \wedge \Bracks{\psi_2}_w
      =
      T \wedge T
      =
      T.
    \end{equation*}

    \item Suppose that \( \varphi = \psi_1 \vee \psi_2 \), where \( \psi_1 \) and \( \psi_2 \) are positive formulas, and that the inductive hypothesis holds for \( \psi_1 \) and \( \psi_2 \).

    Since the formula \( \varphi \) is valid in \( \mscrX \), at least one of \( \psi_1 \) or \( \psi_2 \) is valid under \( v \), hence
    \begin{equation}\label{eq:thm:positive_formulas_preserved_under_homomorphism/sup_of_disjunction}
      \Bracks{\varphi}_v = \sup\set{ \Bracks{\psi_1}_v, \Bracks{\psi_2}_v } = T.
    \end{equation}

    The values \( \Bracks{\psi_1}_v \) and \( \Bracks{\psi_2}_v \) may differ between \( \psi_1 \) and \( \psi_2 \), but \eqref{eq:thm:positive_formulas_preserved_under_homomorphism/sup_of_disjunction} always holds.

    The inductive hypothesis holds for both \( \psi_1 \) and \( \psi_2 \), therefore
    \begin{equation*}
      \Bracks{\varphi}_w = \sup\set{ \Bracks{\psi_1}_w, \Bracks{\psi_2}_w } = T.
    \end{equation*}

    \item Suppose that \( \varphi = \qforall \xi \psi \), where \( \psi \) is a positive formula for which the inductive hypothesis holds.

    Fix some \( x \in X \). Since \( \Bracks{\varphi}_v = T \), then \( \Bracks{\psi}_{v_{\xi \to x}} = T \), hence the inductive hypothesis implies \( \Bracks{\psi}_{w_{\xi \to x}} = T \). This happens for all \( x \in X \), therefore \( \Bracks{\varphi}_w = T \).

    \item Finally, suppose that \( \varphi = \qexists \xi \psi \), where again \( \psi \) is a positive formula for which the inductive hypothesis holds.

    Since \( \Bracks{\varphi}_v = T \), there exists some \( x \in X \) such that \( \Bracks{\psi}_{v_{\xi \to x}} = T \), hence the inductive hypothesis implies \( \Bracks{\psi}_{w_{\xi \to x}} = T \). Therefore, \( \Bracks{\varphi}_w = T \).
  \end{itemize}
\end{proof}

\begin{example}\label{ex:thm:positive_formulas_preserved_under_homomorphism/proof_failure}
  To see how our proof of \fullref{thm:positive_formulas_preserved_under_homomorphism} fails for conditionals, consider the formula \( \varphi = \psi_1 \rightarrow \psi_2 \), where the inductive hypothesis holds for \( \psi_1 \) and \( \psi_2 \).

  If \( \Bracks{\varphi}_v = T \), then one of the following holds:
  \begin{itemize}
    \item \( \Bracks{\psi_1}_v = \Bracks{\psi_2}_v = T \), which via the inductive hypothesis implies \( \Bracks{\psi_1}_w = \Bracks{\psi_2}_w = T \) and hence \( \Bracks{\varphi}_w = T \).
    \item \( \Bracks{\psi_1}_v = F \), which doesn't imply \( \Bracks{\psi_1}_w = F \). In this case it is possible to have \( \Bracks{\psi_1}_w = T \) and \( \Bracks{\psi_2}_w = F \), which implies \( \Bracks{\varphi}_w = F \). This is the negation of what we need to prove.
  \end{itemize}

  What if we change our inductive hypothesis to \( \Bracks{\varphi}_v = \Bracks{\varphi}_w \)\footnote{This is precisely what we will do in the case of \hyperref[def:first_order_embedding]{embeddings} in \fullref{thm:arbitrary_formulas_preserved_under_isomorphisms}}? This fails for atomic formulas because \( \Bracks{\tau_1 \doteq \tau_2}_v = F \) doesn't imply \( \Bracks{\tau_1 \doteq \tau_2}_w = F \) --- consider the case of a group homomorphism from \( (\BbbR, +) \) to \( (\set{ 0 }, +) \). We can this of this alternative inductive hypothesis as a semantical way of introducing negation, which turns our to cause problems.

  See \fullref{ex:monoid_cancellation_not_preserved_by_homomorphism} for an example where a conditional is not preserved by a homomorphism.
\end{example}

\begin{example}\label{ex:replacing_functional_symbols_via_relations}
  Consider the \hyperref[def:magma/theory]{theory of magmas}. We have a functional symbol \( \cdot \), which we can also represent via the ternary predicate \( p(\xi, \eta, \zeta) \), which holds for \( (x, y, z) \) in some model \( \mscrX \) if and only if \( x \cdot y = z \).

  If we choose to work only with the relation, the language would not have any functional symbols, and, by \fullref{thm:first_order_generated_substructures_exist}, every subset of (the domain of) \( \mscrX \) would be a substructure.

  This also introduces a complication, however. We must ensure that the relation represents a function, and this can be done via the axiom
  \begin{equation*}
    \qforall \xi \qforall \eta \qExists \zeta p(\xi, \eta, \zeta),
  \end{equation*}
  where we have used the unique existence shorthand from \fullref{ex:replacing_functional_symbols_via_relations}.

  In this setting, a model of the theory of magmas must satisfy this axiom, and thus it is possible for a substructure not to be a model.

  For example, the negative real numbers are not a magma under multiplication because the product of two negative numbers is positive. A functional symbol encodes this requirement into the definition of a substructure. But otherwise we must encode this via formulas, which makes the definition of substructure trivial, but now it is possible for a substructure not to be a model.
\end{example}

\begin{proposition}\label{thm:functions_over_model_form_model}
  Let \( \Gamma \) to be a set of closed \hyperref[def:positive_formula]{positive formulas} \hi{without existential quantifiers}. Let \( \mscrX = (X, I) \) be a model of \( \Gamma \) and let \( A \) be a nonempty \hyperref[def:set]{plain set}, possibly unrelated to \( \mscrX \). Consider the set \( Y \coloneqq \fun(A, \mscrX) \) of \hyperref[def:function]{all set functions} from \( A \) to \( X \).

  Define \( \iota: X \mapsto Y \) by sending each \( x \in X \) to the corresponding constant function in \( Y \).

  Define the interpretation \( J \) as follows:
  \begin{itemize}
    \item For each \( n \)-ary functional symbol \( f \) in \( \mscrL \), define the interpretation of the functions \( y_1, \ldots, y_n \) componentwise as
    \begin{equation*}
      \begin{aligned}
        &J(f): Y^n \to Y \\
        &J(f) \parens[\Big]{ y_1, \ldots, y_n } \coloneqq \parens[\Big]{ s \mapsto I(f) \parens[\Big]{ y_1(s), \ldots, y_n(s) } }.
      \end{aligned}
    \end{equation*}

    \item For each \( n \)-ary predicate symbol \( p \) in \( \mscrL \), define \( J(p) \subseteq Y^n \) via
    \begin{equation*}
      \begin{aligned}
        &J(p): Y^n \to \set{ T, F } \\
        &J(p) \parens[\Big]{ y_1, \ldots, y_n } \coloneqq \bigwedge \set[\Big]{ I(p) \parens[\Big]{ y_1(s), \ldots, y_n(s) } \given* s \in S }.
      \end{aligned}
    \end{equation*}

    This way \( J(p) (y_1, \ldots, y_n) = T \) if and only if \( I(p) (y_1(s), \ldots, y_n(s)) = T \) simultaneously for all \( s \in S \).
  \end{itemize}

  Then the structure \( \mscrY = (Y, J) \) is also a model of \( \Gamma \) and \( \iota: \mscrX \to \mscrY \) is an embedding.
\end{proposition}
\begin{proof}
  It is obvious that \( \mscrY \) is a structure and that \( \iota \) is an embedding.

  Let \( \varphi \) be a positive formula and suppose that it is valid in \( \mscrX \). We will use \fullref{thm:induction_on_syntax_trees} to show that \( \Bracks{\varphi}_w = T \) for a fixed variable assignment \( w \) in \( \mscrY \).
  \begin{itemize}
    \item If \( \varphi = \top \), its valuation does not depend on \( w \) and thus \( \Bracks{\varphi}_w = T \).

    \item If \( \varphi = \tau_1 \doteq \tau_2 \), then \( \Bracks{\tau_1}_v = \Bracks{\tau_2}_v \) for every assignment \( v \) in \( \mscrX \), hence for any \( s \in S \) we have \( \Bracks{\tau_1}_w(s) = \Bracks{\tau_2}_w(s) \) since both sides of the latter equality here are elements of \( \mscrX \).

    \item Similarly, if \( \varphi = p(\tau_1, \ldots, \tau_n) \), then
    \begin{equation*}
      J(p) \parens[\Big]{ y_1, \ldots, y_n }
      =
      \bigwedge \set[\Big]{ I(p) \parens[\Big]{ y_1(s), \ldots, y_n(s) } \given* s \in S }
      =
      \bigwedge \set{ T \given s \in S }
      =
      T.
    \end{equation*}

    \item Analogous to our proof of \fullref{thm:positive_formulas_preserved_under_homomorphism}, conjunction and disjunction formulas that are valid in \( \mscrX \) are valid in \( \mscrY \).

    \item If \( \varphi = \qforall \xi \psi \) and the inductive hypothesis holds for \( \psi \), then
    \begin{equation*}
      \Bracks{\varphi}_w
      =
      \bigwedge_{y \in Y} \Bracks{\psi}_{w_{\xi \to y}}
      \geq
      \bigwedge_{\substack{\T{const.} \\ \T{func.} y}} \Bracks{\psi}_{w_{\xi \to y}}
      =
      \bigwedge_{x \in X} \Bracks{\psi}_{v_{\xi \to x}}
      =
      \bigwedge_{x \in X} T
      =
      T.
    \end{equation*}
  \end{itemize}
\end{proof}

\begin{example}\label{ex:thm:functions_over_model_of_positive_formulas_form_model}
  While the statement of \fullref{thm:functions_over_model_form_model} may be a little cryptic, a few examples show that it is actually obvious.
  \begin{itemize}
    \item \hyperref[def:boolean_operator]{Boolean operators} have their values in the Boolean algebra \( \set{ T, F } \). Let \( S \) be the set of all tuples of values in \( \set{ T, F }^n \) for arbitrary \( n \). That is,
    \begin{equation*}
      S \coloneqq \bigcup_{n \geq 1} \set{ T, F }^n.
    \end{equation*}

    Then from \fullref{thm:functions_over_model_form_model} it follows that the set \( B = \fun(S, \set{ T, F }) \) of all Boolean operators of arbitrary arities is again a Boolean algebra. See \fullref{thm:lindenmaum_tarski_algebra_of_full_propositional_logic/bijection} for further discussion.

    \item If \( R \) is a \hyperref[def:ring]{ring} and \( A \) is any set, then \( \fun(A, R) \) is again a ring with componentwise operations --- see \fullref{thm:functions_over_algebra}.

    This is useful in functional analysis where we study real-valued and complex-valued functions over arbitrary sets.

    \item If \( \BbbK \) is a \hyperref[def:field]{field}, then in general \( \fun(A, \BbbK) \) is not a field. The simplest example are the real-valued real functions --- \( \sin(x) \) has no multiplicative inverse since \( \ifrac 1 {\sin(x)} \) is not defined for \( x = 2k\pi, k = 1, 2, \ldots \). We can form a \hyperref[def:ring_localization]{field of fractions}, but in general fields of fractions over function rings no longer correspond to functions --- they are purely algebraic constructions, just like \hyperref[def:formal_power_series]{formal power series}.

    This happens because the definition of a field and has an axiom with an existential quantifier --- it requires every nonzero element to have a multiplicative inverse, which can be described formally as
    \begin{equation*}
      \qforall \xi \parens[\Big]{ (\xi \doteq 0) \vee \qexists \eta (\xi \cdot \eta \doteq 1) }.
    \end{equation*}
  \end{itemize}
\end{example}

\begin{proposition}\label{thm:substructure_is_model}
  If \( \Gamma \) is a set of closed \hyperref[def:positive_formula]{positive formulas} \hi{without existential quantifiers}, any \hyperref[def:first_order_substructure]{substructure} of a model of \( \Gamma \) is again a model of \( \Gamma \).
\end{proposition}
\begin{comments}
  \item See \fullref{ex:replacing_functional_symbols_via_relations} for an example of how this may fail if there are existential quantifiers.
\end{comments}
\begin{proof}
  This proposition can be proven by a straightforward application of \fullref{thm:induction_on_syntax_trees}. In each case of the induction, we do not require any elements in addition to those already present in the substructure.
\end{proof}

\begin{definition}\label{def:first_order_embedding}\mcite[def. 2.3.26(ii)]{Hinman2005}
  We say that an \hyperref[def:function_invertibility/injective]{injective} \hyperref[def:first_order_homomorphism]{homomorphism} \( h: \mscrX \to \mscrY \) is an \term{embedding} if any of the following equivalent conditions hold:

  \begin{thmenum}
    \thmitem{def:first_order_embedding/inverse} The inverse of \( h \) on its image is also a homomorphism.
    \thmitem{def:first_order_embedding/predicates} For any predicate symbol \( p \),
    \begin{equation*}
      I(p) (x_1, \ldots, x_n) = J(p) \parens[\Big]{ h(x_1), \ldots, h(x_n) }.
    \end{equation*}
  \end{thmenum}
\end{definition}
\begin{comments}
  \item \Fullref{ex:bijective_order_homomorphism_not_isomorphism} demonstrates how a bijective homomorphism may fail to be an isomorphism.

  \item This condition can often be relaxed --- see \fullref{thm:automorphism_without_predicate_symbols} and \fullref{thm:totally_ordered_strict_isomorphisms}.
\end{comments}

\begin{definition}\label{def:first_order_isomorphism}\mcite[def. 2.3.1(i)]{Hinman2005}
  If a \hyperref[def:first_order_embedding]{first-order embedding} is \hyperref[def:function_invertibility/surjective]{surjective}, we call it an \term{isomorphism} and say that the structures are \term{isomorphic}. We call an isomorphism from a structure to itself an \term{automorphism}.
\end{definition}

\begin{example}\label{ex:bijective_order_homomorphism_not_isomorphism}
  Consider the \hyperref[def:integers]{set of integers} \( \BbbZ \) endowed with two different \hyperref[def:partially_ordered_set]{partial orders}:
  \begin{itemize}
    \item The standard total order \( \leq \) where \( n \leq m \) if there exists a nonnegative integer \( k \) such that \( n + k = m \).
    \item The equality \( = \) relation.
  \end{itemize}

  The identity \( \id(x) = x \) is an \hyperref[def:order_homomorphism]{order homomorphisms} from \( (\BbbZ, =) \) to \( (\BbbZ, \leq) \). Indeed, for any integers \( n \) and \( m \), \( n = m \) implies \( n \leq m \).

  Furthermore, the identity function is bijective. The inverse of \( \id \), which is again \( \id \), is not however a homomorphism from \( (\BbbZ, \leq) \) to \( (\BbbZ, =) \) since, for example, \( 1 \leq 2 \), but \( 1 \neq 2 \).

  Hence, \( \id: (\BbbZ, =) \to (\BbbZ, \leq) \) is a bijective homomorphism, but not an isomorphism.
\end{example}

\begin{proposition}\label{thm:automorphism_without_predicate_symbols}
  A bijective homomorphism over a language without predicate symbols is an \hyperref[def:first_order_isomorphism]{isomorphism}.
\end{proposition}
\begin{proof}
  If \( \mscrL \) has no predicate symbols, then \fullref{def:first_order_embedding/predicates} is vacuously satisfied.
\end{proof}

\begin{proposition}\label{thm:arbitrary_formulas_preserved_under_isomorphisms}
  A \hyperref[def:first_order_embedding]{first-order embeddings} preserves models of arbitrary closed formulas.

  More concretely, given some language \( \mscrL \), if \( \Gamma \) is a set of closed formulas and \( h: \mscrX \to \mscrY \) is an embedding between \hyperref[def:first_order_model]{models} of \( \Gamma \), then the image \( h[X] \) is also (the domain of) a model of \( \Gamma \).
\end{proposition}
\begin{comments}
  \item Compare this to \fullref{thm:positive_formulas_preserved_under_homomorphism}, which places restrictions on the formulas rather than the homomorphism.
  \item We say that embeddings preserve the validity arbitrary formulas.
\end{comments}
\begin{proof}
  The embedding condition allows us to extend the induction in our proof of \fullref{thm:arbitrary_formulas_preserved_under_isomorphisms} to the case of arbitrary formulas by instead requiring that \( \Bracks{\varphi}_v = \Bracks{\varphi}_w \) with the fixed variable assignments \( v \) and \( w \) from our proof of \fullref{thm:arbitrary_formulas_preserved_under_isomorphisms}.
\end{proof}

\begin{definition}\label{def:first_order_definability}\mcite[def. 2.3.37]{Hinman2005}
  Fix a \hyperref[def:first_order_syntax]{first-order language} \( \mscrL \) and a \hyperref[def:first_order_structure]{structure} \( \mscrX = (X, I) \) for \( \mscrL \).

  To every \hyperref[def:first_order_syntax/formula]{formula} \( \varphi \) whose \hyperref[def:first_order_syntax/formula_free_variables]{free variables} are among \( \xi_1, \ldots, \xi_n, \eta_1, \ldots, \eta_m \), and to every \( m \)-tuple \( u_1, \ldots, u_m \) of members of \( A \), which we call \term{parameters}, there corresponds a set \( A \subseteq X^n \) such that
  \begin{equation*}
    (x_1, \ldots, x_n) \in A \T{if and only if} \Bracks{\varphi}(x_1, \ldots, x_n, u_1, \ldots, u_m) = T,
  \end{equation*}
  where \( \Bracks{\varphi}_{\anon} \) denotes the valuation function defined in \fullref{def:propositional_valuation/valuation_function}.

  We say that \( \varphi \) \term{defines} \( A \) with parameters \( u_1, \ldots, u_m \). An arbitrary set \( A \subseteq X^n \) is \term{definable} with parameters \( u_1, \ldots, u_m \) if there exists a formula \( \varphi \) that defines \( A \), or simply \enquote{definable} if it is definable without parameters.
\end{definition}
\begin{comments}
  \item See \fullref{def:set_builder_notation} and \fullref{thm:cumulative_hierarchy_model_of_zfc} for how this concept deeply relates to set theory.
\end{comments}

\begin{proposition}\label{thm:automorphism_preserves_validity}\mcite[prop. 2.3.39]{Hinman2005}
  Let \( h: \mscrX \to \mscrY \) be a \hyperref[def:first_order_isomorphism]{first-order isomorphism}. Fix a formula \( \varphi \) in \( \mscrL \) whose free variables are among \( \xi_1, \ldots, \xi_n \). Then
  \begin{equation*}
    \Bracks{\varphi}_\mscrX(x_1, \ldots, x_n) = \Bracks{\varphi}_\mscrY\parens[\Big]{ h(x_1), \ldots, h(x_n) },
  \end{equation*}
  where \( \Bracks{\varphi}_{\anon} \) denotes the valuation function defined in \fullref{def:propositional_valuation/valuation_function}.
\end{proposition}
\begin{proof}
  Let \( x_1, \ldots, x_n \) be points in \( X \) such that
  \begin{equation*}
    \Bracks{\varphi}_\mscrX(x_1, \ldots, x_n) = T.
  \end{equation*}

  Since \( h \) is a homomorphism, it follows that
  \begin{equation*}
    \Bracks{\varphi}_\mscrY\parens[\Big]{h(x_1), \ldots, h(x_n)} = \Bracks{\varphi}_\mscrX(x_1, \ldots, x_n) = T.
  \end{equation*}

  Conversely, suppose that \( x_1, \ldots, x_n \) are points in \( X \) such that
  \begin{equation*}
    \Bracks{\varphi}_\mscrX\parens[\Big]{h(x_1), \ldots, h(x_n)} = T.
  \end{equation*}

  Then since \( h^{-1} \) is a homomorphism, we have
  \begin{equation*}
    \Bracks{\varphi}_\mscrY\parens[\Big]{h^{-1}(h(x_1)), \ldots, h^{-1}(h(x_n))}
    =
    \Bracks{\varphi}_\mscrX(x_1, \ldots, x_n)
    =
    T.
  \end{equation*}

  Therefore,
  \begin{equation*}
    \Bracks{\varphi}_\mscrY\parens[\Big]{ h(x_1), \ldots, h(x_n) } = T \T{if and only if} \Bracks{\varphi}_\mscrX(x_1, \ldots, x_n) = T,
  \end{equation*}
  which is equivalent to the statement of the proposition.
\end{proof}

\begin{corollary}\label{thm:automorphism_of_definable_set}
  Let \( \mscrX = (X, I) \) be a structure over some language \( \mscrL \).

  \begin{thmenum}
    \thmitem{thm:automorphism_of_definable_set/direct}\mcite[corr. 2.3.40]{Hinman2005} If the set \( A \subseteq X \) is \hyperref[def:first_order_definability]{definable} (without parameters) and if \( h: X \to X \) is an automorphism, then \( h(A) = A \).

    \thmitem{thm:automorphism_of_definable_set/contrapositive} If for some automorphism \( h: X \to X \) we have \( h(A) \neq A \), then the set \( A \subseteq X \) is not definable.
  \end{thmenum}
\end{corollary}
\begin{proof}
  \SubProofOf{thm:automorphism_of_definable_set/direct} If \( A \) is definable via \( \varphi \), then \fullref{thm:automorphism_preserves_validity} implies that,if \( (x_1, \ldots, x_n) \in A \), then
  \begin{equation*}
    \Bracks{\varphi}_\mscrX\parens[\Big]{ h(x_1), \ldots, h(x_n) } = \Bracks{\varphi}_\mscrX(x_1, \ldots, x_n) = T,
  \end{equation*}
  which in turn implies
  \begin{equation*}
    \parens[\Big]{ h(x_1), \ldots, h(x_n) } \in A.
  \end{equation*}

  Thus, \( A = h(A) \).

  \SubProofOf{thm:automorphism_of_definable_set/contrapositive} This is the contrapositive of \fullref{thm:automorphism_of_definable_set/direct}.
\end{proof}
