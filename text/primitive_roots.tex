\section{Primitive roots}\label{sec:primitive_elements}

\paragraph{Cyclotomic extensions}

\begin{definition}\label{def:cyclotomic_extension}\mcite[187]{Bourbaki2003Algebra4to7}
  We call the \hyperref[def:splitting_field]{splitting field} of \( X^n - 1 \) over \( \Bbbk \) the \( n \)-th \term[ru=круговое / циклотомическое (поле разложения) (\cite[204]{Кострикин2001АлгебраТом3})]{cyclotomic extension} of \( \Bbbk \).
\end{definition}
\begin{comments}
  \item The name is inspired by \hyperref[def:cyclotomic_polynomial]{cyclotomic polynomial}. \Fullref{thm:cyclotomic_polynomial_is_minimal} implies that, under certain compatibility conditions, the \( n \)-th cyclotomic extension is the splitting field for the \( n \)-th cyclotomic polynomial.
\end{comments}

\begin{proposition}\label{thm:small_cyclotomic_extensions}
  The first and second \hyperref[def:cyclotomic_extension]{cyclotomic extensions} of any field coincide with the field itself.
\end{proposition}
\begin{comments}
  \item For finite fields are more powerful result holds --- see \fullref{thm:finite_field_is_cyclotomic_extension}.
\end{comments}
\begin{proof}
  The only solution to \( X - 1 \) is \( 1 \), so the first cyclotomic extension must only contain \( 1 \).

  The solutions to \( X^2 - 1 \) are \( 1 \) and \( -1 \) because \fullref{thm:xn_minus_yn_factorization} implies that
  \begin{equation*}
    X^2 - 1 = (X - 1)(X + 1).
  \end{equation*}

  They coincide in a field of \hyperref[def:ring_characteristic]{characteristic} \( 2 \), in which case \( 1 \) is a double root, but otherwise they are distinct.
\end{proof}

\begin{proposition}\label{thm:finite_field_is_cyclotomic_extension}\mcite[thm. 2.49]{LidlNiederreiter1997FiniteFields}
  The \hyperref[def:finite_field]{finite field} \( \BbbF_q \) is the \( (q - 1) \)-th \hyperref[def:cyclotomic_extension]{cyclotomic extension} of itself.
\end{proposition}
\begin{comments}
  \item Hence, it is also the \( (q - 1) \)-th cyclotomic extension of any of its subfields.
\end{comments}
\begin{proof}
  \Fullref{thm:finite_fields/splitting} implies that the polynomial \( X^{q - 1} - 1 \) splits in \( \BbbF_q \).
\end{proof}

\paragraph{Roots of unity}

\begin{definition}\label{def:root_of_unity}\mimprovised
  We say that an element \( x \) is an \hyperref[def:integral_domain]{integral domain} is an \( n \)-th \term[ru=корень из единицы (\cite[43]{Фаддеев1984Алгебра}), en=root of unity (\cite[def. 2.41]{LidlNiederreiter1997FiniteFields})]{root of unity} if \( x^n = 1 \), i.e. if it is a \hyperref[def:root_of_polynomial]{root} of the polynomial \( X^n - 1 \).
\end{definition}
\begin{comments}
  \item All \( n \)-th roots of unity of the integral domain \( D \) lie in the \( n \)-th \hyperref[def:cyclotomic_extension]{cyclotomic extension} of the \hyperref[def:field_of_fractions]{field of fractions} of \( D \). The domain itself generally contains only some of the roots, however they are fairly well-structured because \fullref{thm:roots_of_unity_cyclic_group} implies that they form a cyclic group.

  \item Roots of unity are defined only for fields by \incite[def. 2.41]{LidlNiederreiter1997FiniteFields} and \incite[276]{Lang2002Algebra}, where \( n \) roots of unity exist in the \hyperref[def:algebraic_closure]{algebraic closure}. We see no harm in generalizing their definitions.
\end{comments}

\begin{lemma}\label{thm:roots_of_unity_multiplicity}\mcite[thm. 2.43(ii)]{LidlNiederreiter1997FiniteFields}
  Let \( \BbbK \) be the \( n \)-th \hyperref[def:cyclotomic_extension]{cyclotomic extension} of some field of characteristic \( p \). Then \( \BbbK \) by definition contains all \( n \)-th \hyperref[def:root_of_unity]{roots of unity}.

  Let \( e \) be the largest positive integer such that \( p^e \) divides \( n \). For convenience suppose that \( 0^0 = 1 \), so that \( e = 0 \) if \( p = 0 \). Let \( m \) be the quotient of \( n \) and \( p^e \).

  Then \( \BbbK \) contains \( m \) distinct \( n \)-th roots of unity, each with multiplicity \( p^e \).
\end{lemma}
\begin{proof}
  \Fullref{thm:newtons_binomial_theorem_positive_characteristic} implies that
  \begin{equation}\label{eq:thm:roots_of_unity_multiplicity/proof}
    X^n - 1
    =
    X^{m \cdot p^e} - 1^{p^e}
    \reloset {\eqref{eq:thm:newtons_binomial_theorem_positive_characteristic}} =
    (X^m - 1)^{p^e}.
  \end{equation}

  It follows that every root of \( X^m - 1 \) is a root of multiplicity at least \( p^e \) of \( X^n - 1 \).

  Since \( p \) does not divide \( m \), the \hyperref[def:algebraic_derivative]{algebraic derivative} \( m X^{m - 1} \) does not vanish, and has only one root --- \( 0 \). Then \( m X^{m-1} \) hence no common roots with \( X^m - 1 \), hence \( X^m - 1 \) has no multiple roots, implying that \( \BbbK \) has exactly \( m \) distinct \( m \)-th roots of unity.

  Since the total number of \( n \)-th roots of unity is \( n = p^e \cdot m \), it follows that there are \( m \) distinct roots, each with multiplicity \( p^e \).
\end{proof}

\begin{proposition}\label{thm:roots_of_unity_cyclic_group}
  Over an \hyperref[def:integral_domain]{integral domain} \( D \), the set of \( n \)-th \hyperref[def:root_of_unity]{roots of unity} is a \hyperref[def:cyclic_group]{cyclic} multiplicative group.
\end{proposition}
\begin{proof}
  Fix an integral domain \( D \) and a set \( R_n \) of \( n \)-th roots of unity.

  \SubProof{Proof that \( R_n \) is a subgroup of \( D^* \)} It is clear that \( 1 \) is a root of unity and that the product of roots of unity is again a root of unity. We only need to show that \( R_n \) is closed under inverses, but this is trivial because if
  \begin{equation*}
    1 = x^n = x \cdot x^{n-1},
  \end{equation*}
  then we can multiply by \( x^{-1} \) on the left to obtain
  \begin{equation*}
    x^{-1} = x^{n-1}.
  \end{equation*}

  \SubProof{Proof that \( R_n \) is cyclic}\mcite{MathSE:finite_subgroup_of_multiplicative_field_group}  Let \( \Bbbk \) be the \hyperref[def:field_of_fractions]{field of fractions} of \( D \) and let \( \BbbK \) be the \( n \)-th \hyperref[def:cyclotomic_extension]{cyclotomic extension} of \( \Bbbk \), that is, the \hyperref[def:splitting_field]{splitting field} of the polynomial \( X^n - 1 \).

  Then \( X^n - 1 \) then has exactly \( n \) roots in \( \BbbK \), counting multiplicities. We will examine \( R_n \) over \( \BbbK \).

  Let \( p \) be the \hyperref[def:ring_characteristic]{characteristic} of \( \BbbK \). \Fullref{thm:roots_of_unity_multiplicity} implies that there are exactly \( m \) distinct roots in \( R_n \), each of multiplicity \( p^e \), where \( e \) is the largest power of \( p \) divisible by \( n \) and \( m \) is the quotient \( n / p^e \). As in \Fullref{thm:roots_of_unity_multiplicity}, for convenience here we assume that \( 0^0 = 1 \) so that \( e = 0 \) if \( p = 0 \).

  Then \( R_n \) coincides with \( R_m \).

  Let \( G_d \) be the set of elements of \( R_m \) of \hyperref[def:group_element_order]{order} \( d \). Our goal is to show that \( G_d \) is nonempty whenever \( d \) divides \( m \).

  If \( G_d \) is nonempty and if \( x \) is in \( G_d \), then \( x^d = 1 \) and thus \( x \) is a root of the polynomial \( X^d - 1 \). Thus, \( G_d \subseteq R_d \).

  We have \( (x^k)^d = 1 \) for every power \( k \) of \( d \), hence the entire subgroup \( \braket{ x } \) generated by \( x \) belongs to \( R_d \). Since \( x \) has order \( d \), it follows that \( R_d = \braket{ x } \), that is, \( x \) is a generator of \( R_d \). Therefore, \( R_d \) is cyclic and \( G_d \) is a set of generators of \( R_d \).

  Furthermore, \fullref{thm:def:group_element_order/power} implies that \( x^k \) has order \( d \) if \( k \) and \( d \) are coprime, hence \( G_d \) contains at least \( \varphi(d) \) elements, where \( \varphi \) is \hyperref[def:eulers_totient_function]{Euler's totient function}. But \fullref{thm:def:cyclic_group/generators_cardinality} implies that \( G_d \) has at most \( \varphi(d) \) elements, thus \( G_d \) has exactly \( \varphi(d) \) elements.

  \Fullref{thm:def:group_element_order/group_order} implies that \( G_d \) is empty unless \( d \) divides \( m \). Then we have the partition
  \begin{equation}\label{eq:thm:roots_of_unity_cyclic_group/proof/partition}
    R_m = \bigcup \set{ G_d \given d \T{divides} m }.
  \end{equation}

  Therefore,
  \begin{equation}\label{eq:thm:roots_of_unity_cyclic_group/proof/ineq}
    m
    =
    \card(R_m)
    \reloset {\eqref{eq:thm:roots_of_unity_cyclic_group/proof/partition}} =
    \sum_{d \mid m} \card(G_d)
    \leq
    \sum_{d \mid m} \varphi(d)
    \reloset {\eqref{eq:thm:totient_divisor_sum}} =
    m.
  \end{equation}

  In order for equality to hold in \eqref{eq:thm:roots_of_unity_cyclic_group/proof/ineq}, \( G_d \) must be nonempty for \( d \mid m \). In particular, \( G_n \) is nonempty, hence there exists an element \( x \) of order \( m \).

  The subgroup \( \braket{ x } \) generated by \( x \) thus has \( m \) elements. But \( R_m \) has at most \( m \) elements due to \fullref{thm:def:integral_domain/root_limit}, hence \( x \) generates the entire group \( R_m \). Furthermore, \( R_m \) coincides with \( R_n \).

  Therefore, the set \( R_n \) of \( n \)-th roots of unity over \( \BbbK \) is a cyclic group with generator \( x \).

  Then \( R_n \cap D \) is a subgroup, and \fullref{thm:cyclic_subgroup_classification/cyclic} implies that it is also cyclic, but possibly with a different generator.
\end{proof}

\begin{lemma}\label{thm:finite_domain_roots_of_unity}
  In the \hyperref[def:finite_field]{finite field} \( \BbbF_q \), the nonzero elements are precisely the \( (q - 1) \)-th \hyperref[def:root_of_unity]{roots of unity}.
\end{lemma}
\begin{proof}
  \Fullref{thm:finite_fields/polynomial} implies that every element of \( \BbbF_q \) is a root of \( X^q - X \). The nonzero elements are thus roots of \( X^{q - 1} - 1 \), i.e. \( (q - 1) \)-th \hyperref[def:root_of_unity]{root of unity}. Furthermore, \( 0 \) is itself not a \( (q - 1) \)-th root of unity.
\end{proof}

\begin{proposition}\label{thm:finite_field_multiplicative_group_is_cyclic}
  In the \hyperref[def:finite_field]{finite field} \( \BbbF_q \), the \hyperref[def:semiring]{multiplicative group} \( \BbbF_q^* \) is
  \hyperref[def:cyclic_group]{cyclic}.
\end{proposition}
\begin{proof}
  \Fullref{thm:finite_domain_roots_of_unity} implies that \( \BbbF_q^* \) is the set of all \( (q - 1) \)-th roots of unity. \Fullref{thm:roots_of_unity_cyclic_group} then implies that \( \BbbF_q^* \) is cyclic.
\end{proof}

\begin{lemma}\label{thm:finite_field_roots_of_splitting_polynomial}
  Let \( \BbbF_{q^n} \) be some extension of the \hyperref[def:finite_field]{finite field} \( \BbbF_q \). If \( x^q = x \) for some element \( x \) of \( \BbbF_{q^n} \), then \( x \) belongs to \( \BbbF_q \).
\end{lemma}
\begin{proof}
  \Fullref{thm:finite_fields/polynomial} implies that the elements of \( \BbbF_q \) are roots of the polynomial \( X^q - X \). It has at most \( q \) roots by \fullref{thm:def:integral_domain/root_limit}, and \( \BbbF_q \) has \( q \) elements, hence every root of the polynomial belongs to \( \BbbF_q \).
\end{proof}

\begin{corollary}\label{thm:finite_splitting_field}
  Fix a polynomial \( f(X) \) over the \hyperref[def:finite_field]{finite field} \( \BbbF_q \). Let \( \BbbF_{q^n} \) be its \hyperref[def:splitting_field]{splitting field}\fnote{\Fullref{thm:splitting_field_is_finite_extension} implies that the splitting field of \( f(X) \) is a finite extension, and thus the number of elements is a power of \( q \)}. \Fullref{thm:finite_field_multiplicative_group_is_cyclic} implies that the multiplicative group of \( \BbbK \) is cyclic, hence every root of \( f(X) \) in \( \BbbK \) has a well-defined multiplicative order.

  If \( \alpha \) is a root of \( f(X) \) with order \( k \), then \( \alpha \) belongs to the subfield \( \BbbF_{q^m} \) of \( \BbbK \), where \( m \) is the smallest positive integer such that \( k \) divides \( q^m - 1 \).
\end{corollary}
\begin{comments}
  \item If we pick \( m \) with respect be the root of maximal order, then \( \BbbF_{q^m} \) will contain all roots of \( \alpha \).
\end{comments}
\begin{proof}
  If \( k \) is the order of \( \alpha \) and if \( s \) be the quotient of \( q^m - 1 \) and \( k \), then
  \begin{equation*}
    \alpha^{q^m - 1} = (\alpha^k)^s = 1^s = 1.
  \end{equation*}

  \Fullref{thm:finite_field_roots_of_splitting_polynomial} then implies that \( \alpha \) belongs to \( \BbbF_{q^m} \).
\end{proof}

\begin{example}\label{thm:multiplicative_group_of_z8}
  \Fullref{thm:finite_field_multiplicative_group_is_cyclic} fails for \( \BbbZ_8 \), which is not a field since \( 8 \) is not prime. The multiplicative group \( \BbbZ_8^* \) is not cyclic.

  Indeed, \fullref{thm:eulers_totient_theorem} implies that, if \( n < 8 \) is coprime to \( 8 \), then
  \begin{equation*}
    n^5 = 1 \pmod 8,
  \end{equation*}
  hence \( n \) has order at most \( 5 \). Actually, by \fullref{thm:def:group_element_order/neutral}, the order of \( n \) divides \( 5 \), and since \( 5 \) is prime it follows that the order of \( n \) is exactly \( 5 \).

  If \( n \) is not coprime to \( 8 \), since \( 2 \) is the only nontrivial divisor of \( 8 \), it follows that \( 2 \) divides \( n \). If \( n < 8 \), this leaves \( 2 \), which has order \( 3 \), and \( 4 \), which has order \( 2 \).

  Therefore, no element of \( \BbbZ_8^* \) has order \( 7 \), hence the group is not cyclic.
\end{example}

\paragraph{Primitive roots}

\begin{definition}\label{def:primitive_root_of_unity}\mcite[89]{Berlekamp2015AlgebraicCodingTheory}
  We say that an \( n \)-th \hyperref[def:root_of_unity]{root of unity} is \term[ru=первообразный (корень единицы) (\cite[90]{Тыртышников2017Алгебра})]{primitive} if it has multiplicative order \( n \).
\end{definition}
\begin{comments}
  \item \incite[def. 2.43]{LidlNiederreiter1997FiniteFields} instead define primitive roots of unity as generators of the group of all \( n \)-th roots of unity in the \( n \)-th \hyperref[def:cyclotomic_extension]{cyclotomic extension}, however they explicitly require \( n \) not to be a divisor of the characteristic. Without the latter restriction, their definition would encompass more cases.
\end{comments}

\begin{example}\label{ex:def:root_of_unity}
  We list examples of \hyperref[def:root_of_unity]{roots of unity}.
  \begin{thmenum}
    \thmitem{ex:def:root_of_unity/square} The square roots of unity in any domain are \( 1 \) and \( -1 \).

    If the \hyperref[def:ring_characteristic]{characteristic} of the domain is \( 2 \), then \( 1 = -1 \) and thus \( 1 \) is a repeated square root of unity. This is confirmed by \fullref{thm:roots_of_unity_multiplicity}.

    Otherwise, \( -1 \) is \hyperref[def:primitive_root_of_unity]{primitive}, while \( 1 \) generates the trivial subgroup.

    \thmitem{ex:def:root_of_unity/prime_powers} In the \hyperref[def:finite_field]{finite field} \( \BbbF_p \) with prime characteristic, the only \( p^n \)-th root of unity is \( 1 \), and it has multiplicity \( p^n \). This follows from \fullref{thm:lagranges_subgroup_theorem}

    \thmitem{ex:def:root_of_unity/f5} \fullref{thm:roots_of_unity_multiplicity} implies that there are \( 4 \) distinct \hyperref[def:finite_field_primitive_element]{primitive elements} modulo \( 5 \), i.e. primitive elements of \( \BbbF_5 \). These are precisely the nonzero elements of \( \BbbF_5 \).

    \thmitem{ex:def:root_of_unity/fourth_complex} The fourth roots of unity in \( \BbbC \) are \( 1 \), \( -1 \), \( i \) and \( -i \).

    \Fullref{thm:def:group_element_order/power} implies that the order of each of them is either \( 1 \), \( 2 \) or \( 4 \). Indeed, as discussed in \fullref{ex:def:root_of_unity/square}, \( 1 \) has order \( 1 \), \( -1 \) has order \( 2 \). The imaginary unit \( i \) and its inverse \( -i \) have order \( 4 \).

    Thus, the only primitive fourth roots of unity over \( \BbbZ \) are \hyperref[def:gaussian_integer]{Gaussian integers}, which exist in an extension of \( \BbbZ \).

    This also empirically confirms \fullref{thm:def:cyclic_group/generators_cardinality} --- \( \varphi(1) = \varphi(2) = 1 \) and there is only one root of both orders, however \( \varphi(4) = 2 \), and indeed there are two primitive roots.

    See \fullref{def:complex_root_of_unity} for a general discussion of roots of unity in \( \BbbC \).

    \thmitem{ex:def:root_of_unity/f2_cubic} Let us examine the \( n \)-th \hyperref[def:cyclotomic_extension]{cyclotomic extension} of the \hyperref[def:finite_field]{finite field} \( \BbbF_2 \) with two elements.

    \Fullref{thm:small_cyclotomic_extensions} implies that the first and second cyclotomic extensions coincide with \( \BbbF_2 \). Let us examine the third cyclotomic extension \( \BbbK \).

    \Fullref{thm:roots_of_unity_multiplicity} implies that \( \BbbK \) contains three distinct cubic roots of unity. \Fullref{thm:lagranges_subgroup_theorem} implies that the smallest extension of \( \BbbF_2 \) containing \( 3 \) elements is \( \BbbF_4 \).

    Per our discussion in \fullref{ex:def:finite_field/f4}, \( \BbbF_4 \) has elements \( 0 \), \( 1 \), \( \zeta \) and \( \zeta + 1 \), where \( \zeta^2 = \zeta + 1 \).

    Since \( 0 \) is not a root of unity, it follows that the roots are \( 1 \), \( \zeta \) and \( \zeta + 1 \). Furthermore, \( \zeta \) and \( \zeta + 1 \) are primitive because they are roots of the third \hyperref[def:cyclotomic_polynomial]{cyclotomic polynomial} \( X^2 + X + 1 \) and thus
    \begin{equation*}
      \zeta^2 = \zeta + 1
    \end{equation*}
    and
    \begin{equation*}
      (\zeta + 1)^2 = \zeta + 1 + 1 = \zeta.
    \end{equation*}
  \end{thmenum}
\end{example}

\begin{definition}\label{def:finite_field_primitive_element}
elementsWe say that an element of the \hyperref[def:finite_field]{finite field} \( \BbbF_q \) is \term[en=primitive element (\cite[def. 2.9]{LidlNiederreiter1997FiniteFields})]{primitive} if it satisfies any of the following equivalent conditions:
  \begin{thmenum}
    \thmitem{def:finite_field_primitive_element/unity}\mimprovised It is a \( (q - 1) \)-th root of unity.
    \thmitem{def:finite_field_primitive_element/generator}\mcite[def. 2.9]{LidlNiederreiter1997FiniteFields} It generates the multiplicative group \( \BbbF_q^* \).
  \end{thmenum}

  Following \incite[20]{Knuth1997ArtVol2}, if \( q \) is prime, we will call its primitive elements \enquote{primitive elements modulo \( q \)}.
\end{definition}
\begin{comments}
  \item See \fullref{rem:primitive_element_terminology} for a discussion of the terminology.
\end{comments}
\begin{defproof}
  \EquivalenceSubProof{def:finite_field_primitive_element/unity}{def:finite_field_primitive_element/generator} We must simply note that \( x \) is a \( (q - 1) \)-th root of unity if, by definition, it has multiplicative order \( q - 1 \), which is equivalent to its generated subgroup to have \( q - 1 \) elements --- the cardinality of the multiplicative group \( \BbbF_q^* \).
\end{defproof}

\begin{remark}\label{rem:primitive_element_terminology}
  The term \enquote{primitive element} in a field is unfortunately ambiguous.

  \begin{itemize}
    \item \incite[66]{Rotman2015AlgebraVol1}, \incite[124]{Albert1956Algebra} and \incite[def. 2.9]{LidlNiederreiter1997FiniteFields} use \enquote{primitive element} for what we call a generator of the multiplicative group of a \hyperref[def:finite_field]{finite field}. \incite[89]{Berlekamp2015AlgebraicCodingTheory} prefers the less ambiguous term \enquote{primitive field element}.

    In the context of fields of prime cardinality \( p \), \enquote{primitive root modulo \( p \)} is used by \incite[12]{Gentle2006RandomNumberGeneration} and \incite[def. 4.4.3]{Rosen2019DiscreteMathematics}. \incite[125]{Albert1956Algebra} and \incite[thm. 11.2.2]{Hall1986Combinatorics} uses \enquote{primitive roots} for arbitrary finite fields, however we find that terminology confusing considering we also discuss primitive \( n \)-th root of unity.

    \item \incite[A.V.40]{Bourbaki2003Algebra4to7}, \incite[214]{Jacobson1985AlgebraPart1} and \incite[244]{Lang2002Algebra} use \enquote{primitive element} for what we call a \enquote{generator of a \hyperref[def:simple_extension]{simple field extension}}.
  \end{itemize}
\end{remark}

\begin{proposition}\label{thm:primitive_element_cardinality}
  The number of \hyperref[def:finite_field_primitive_element]{primitive elements} in \( \BbbF_q \) is \( \varphi(q - 1) \), where \( \varphi \) is \hyperref[def:eulers_totient_function]{Euler's totient function}.
\end{proposition}
\begin{proof}
  The order of the multiplicative group of \( \BbbF_q \) is \( q - 1 \), and \fullref{thm:def:cyclic_group/generators_cardinality} implies that it has \( \varphi(q - 1) \) generators.
\end{proof}

\paragraph{Discrete logarithms}

\begin{definition}\label{def:discrete_logarithm}\mcite[def. 4.4.4]{Rosen2019DiscreteMathematics}
  Fix a \hyperref[def:prime_number]{prime number}. Let \( b \) be a \hyperref[def:finite_field_primitive_element]{primitive elements modulo} \( p \).

  Then, for any \hi{positive} integer \( x < p \), there exists a \hi{nonnegative} integer \( y \) such that
  \begin{equation}\label{eq:def:discrete_logarithm}
    x = b^y \pmod p.
  \end{equation}

  We say that \( y \) is a \term{discrete logarithm} of \( x \) to the base \( b \).
\end{definition}

\begin{example}\label{ex:def:discrete_logarithm}
  We list examples of \hyperref[def:discrete_logarithm]{discrete logarithms}.
  \begin{thmenum}
    \thmitem{ex:def:discrete_logarithm/mod2} Modulo \( 2 \), where the only square root of unity is \( 1 \), only \( 1 \) is a discrete logarithm.

    \thmitem{ex:def:discrete_logarithm/mod5} Modulo \( 5 \), the powers of \( 3 \) are shown in \cref{tab:ex:def:discrete_logarithm/mod5}.

    \begin{table}[!ht]
      \begin{equation*}
        \begin{array}{*{3}c}
          \toprule
          x & y & 2^y \\
          \midrule
          1 & 0 & 2^0 = 1 \\
          2 & 1 & 2^1 = 2 \\
          3 & 3 & 2^3 = 8 \\
          4 & 2 & 2^2 = 4 \\
          \bottomrule
        \end{array}
        \qquad
        \begin{array}{*{3}c}
          \toprule
          x & y & 3^y \\
          \midrule
          1 & 0 & 3^0 = 1 \\
          2 & 3 & 3^3 = 27 \\
          3 & 1 & 3^1 = 3 \\
          4 & 2 & 3^2 = 9 \\
          \bottomrule
        \end{array}
      \end{equation*}
      \caption{The \hyperref[def:discrete_logarithm]{discrete logarithms} with bases \( 2 \) and \( 3 \) modulo \( 5 \).}\label{tab:ex:def:discrete_logarithm/mod5}
    \end{table}

    Thus, both \( 2 \) and \( 3 \) are primitive roots, and every positive integer less than \( 5 \) has a discrete logarithm with base \( 2 \) or \( 3 \) modulo \( 5 \).

    \Fullref{thm:primitive_element_cardinality} implies that there are \( \varphi(4) = 2 \) primitive roots modulo \( 5 \). Obviously \( 1 \) is not a primitive root, however \( 4 \) is thus not primitive also. Indeed, it has order \( 2 \) in the group of fourth roots of unity, however \( 4 \) not being primitive can be verified directly as follows:
    \begin{equation*}
      4^{2k} = 16^k = 1^k = 1 \pmod 5,
    \end{equation*}
    hence \( 4^{2k} = 1 \pmod 5 \) for even exponents and \( 4^{2k + 1} = 4 \) for odd exponents.

    \thmitem{ex:def:discrete_logarithm/mod7} \Fullref{thm:primitive_element_cardinality} implies that there are only \( \varphi(6) = 2 \) roots of unity modulo \( 7 \).

    We can rule out most candidates since they have multiplicative order smaller than \( 6 \):
    \begin{itemize}
      \item \( 1^1 = 1 \pmod 7 \)
      \item \( 2^3 = 8 = 1 \pmod 7 \)
      \item \( 4^3 = 64 = 1 \pmod 7 \)
      \item \( 6^2 = 36 = 1 \pmod 7 \)
    \end{itemize}

    Therefore, the primitive roots modulo \( 7 \) are \( 3 \) and \( 5 \).
  \end{thmenum}
\end{example}

\paragraph{Cyclotomic polynomials}

\begin{definition}\label{def:cyclotomic_polynomial}\mcite[def. 2.44]{LidlNiederreiter1997FiniteFields}
  Fix a field \( \Bbbk \) of characteristic \( p \) and a positive integer \( n \) not divisible by \( p \). Consider the \( n \)-th \hyperref[def:cyclotomic_extension]{cyclotomic extension} \( \BbbK \) of \( \Bbbk \). Let \( \alpha \) be an \( n \)-th \hyperref[def:primitive_root_of_unity]{primitive} \hyperref[def:root_of_unity]{root of unity} in \( \BbbK \).

  We define the \( n \)-th \term[ru=круговой / циклотомический (многочлен) (\cite[130]{Тыртышников2017Алгебра})]{cyclotomic polynomial} over \( \Bbbk \) as
  \begin{equation}\label{eq:def:cyclotomic_polynomial}
    Q_n(X) \coloneqq \prod_{\gcd(k, n) = 1} (X - \alpha^k).
  \end{equation}
\end{definition}
\begin{comments}
  \item \Fullref{thm:def:group_element_order/power} implies that the roots of \( Q_n \) are precisely the primitive \( n \)-th roots of unity.
  \item We will show in \fullref{thm:def:cyclotomic_polynomial/coefficients} that the coefficients \( Q_n \) are integers (and not more general elements of the \( n \)-th cyclotomic extension). This determines \( Q_n \) uniquely up to the characteristic of \( \Bbbk \).
\end{comments}
\begin{defproof}
  We must prove that \( Q_n \) does not depend on the choice of \( a \). Let \( b \) be another primitive root of unity and consider
  \begin{equation*}
    Q_n'(X) \coloneqq \prod_{\gcd(k, n) = 1} (X - b^k).
  \end{equation*}

  Since \( b \) is a primitive root of unity, there exists some positive integer \( m \) such that \( a^m = b \). By definition, the degree of both \( a \) and \( b \) is \( n \), hence \fullref{thm:def:group_element_order/power} implies that \( m \) and \( n \) are coprime. \Fullref{thm:def:coprime_elements/gcd_product} then implies that \( n \) is coprime with \( mk \) whenever it is coprime with \( k \). Therefore,
  \begin{equation*}
    Q_n'(X) = \prod_{\gcd(mk, n) = 1} (X - a^{mk}) = Q_n(X).
  \end{equation*}
\end{defproof}

\begin{proposition}\label{thm:def:cyclotomic_polynomial}
  Fix a field \( \Bbbk \) of characteristic \( p \) and a positive integer \( n \) not divisible by \( p \). Let \( \BbbK \) be the \( n \)-th \hyperref[def:cyclotomic_extension]{cyclotomic extension} \( \BbbK \).

  \hyperref[def:cyclotomic_polynomial]{Cyclotomic polynomials} over \( \Bbbk \) have the following basic properties.
  \begin{thmenum}
    \thmitem{thm:def:cyclotomic_polynomial/splitting} \( \BbbK \) is a \hyperref[def:splitting_field]{splitting field} for the \( n \)-th \hyperref[def:cyclotomic_polynomial]{cyclotomic polynomial} \( Q_n(X) \) over \( \Bbbk \).

    \item This proposition is trivial unless we acknowledge that, due to \fullref{thm:def:cyclotomic_polynomial/coefficients}, the coefficients of \( Q_n(X) \) belong to \( \Bbbk \).

    \thmitem{thm:def:cyclotomic_polynomial/simple_extension} \( \BbbK \) is a \hyperref[def:simple_field_extension]{simple} \hyperref[def:algebraic_extension]{algebraic extension} of \( \Bbbk \), generated by any of the roots of \( Q_n(X) \).

    \thmitem{thm:def:cyclotomic_polynomial/product} We have
    \begin{equation}\label{eq:thm:def:cyclotomic_polynomial/product}
      X^n - 1 = \prod_{d \mid n} Q_d(X).
    \end{equation}

    \thmitem{thm:def:cyclotomic_polynomial/coefficients}\cite[thm. 2.45(ii)]{LidlNiederreiter1997FiniteFields} The coefficients of \( Q_n(X) \) are integers.

    \thmitem{thm:def:cyclotomic_polynomial/uniqueness} The \( n \)-th cyclotomic polynomials over fields with the same characteristic coincide.

    \thmitem{thm:def:cyclotomic_polynomial/prime} If \( n \) is prime, then
    \begin{equation}\label{eq:thm:def:cyclotomic_polynomial/prime}
      Q_n(X) = \sum_{k=0}^{n-1} X^k.
    \end{equation}

    \thmitem{thm:def:cyclotomic_polynomial/odd} If \( 1 < 2n < p \) and if \( n \) is odd, then
    \begin{equation}\label{eq:thm:def:cyclotomic_polynomial/odd}
      Q_{2n}(X) = Q_n(-X).
    \end{equation}
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:cyclotomic_polynomial/splitting} We have defined \( Q_n(X) \) via its roots in \( \BbbK \), and \( \BbbK \) as a splitting field of \( X^n - 1 \). Since the only roots of \( Q_n(X) \) are primitive \( n \)-th roots of unity, it follows that no smaller field contains all roots of \( X^n - 1 \).

  \SubProofOf{thm:def:cyclotomic_polynomial/simple_extension} As a splitting field, \( \BbbK \) is algebraic. It is simple since the roots of \( Q_n(X) \) are primitive roots of unity, hence any of them generates the other roots of unity adjoined to \( \Bbbk \).

  \SubProofOf{thm:def:cyclotomic_polynomial/product} In \( \BbbK \), both \( X^n - 1 \) and the cyclotomic polynomials split.

  Since \( p \) does not divide \( n \), \fullref{thm:roots_of_unity_multiplicity} implies that there are \( d \) distinct roots of unity for every divisor \( d \) of \( n \). \Fullref{thm:def:cyclic_group/generators_cardinality} then implies that there are \( \varphi(d) \) primitive \( d \)-th roots of unity. These are precisely the roots fo \( Q_d(X) \).

  Every primitive \( d \)-th root of unity is also a primitive \( n \)-th root of unity if \( d \) divides \( n \). \Fullref{thm:totient_divisor_sum} implies that the roots of the product
  \begin{equation*}
    \prod_{d \mid n} Q_d(X)
  \end{equation*}
  are \( n \) distinct \( n \)-th roots of unity.

  Then \eqref{eq:thm:def:cyclotomic_polynomial/product} follows.

  \SubProofOf{thm:def:cyclotomic_polynomial/coefficients} We will use induction on \( n \). The base case \( Q_1(X) = X - 1 \) is clear, so let \( n > 1 \) and suppose that the proposition holds for the \( d \)-th cyclotomic polynomial, where \( d < n \).

  Let
  \begin{equation}\label{eq:thm:def:cyclotomic_polynomial/coefficients/proof/step}
    f(X) \coloneqq \prod_{\substack{d \mid n \\ d \neq n}} Q_d(X).
  \end{equation}

  We can thus apply the inductive hypothesis to \( f(X) \), and conclude that the coefficients of \( f(X) \) are integers. \Fullref{thm:def:cyclotomic_polynomial/product} implies that
  \begin{equation*}
    Q_n(X) = \frac {X^n - 1} {f(X)},
  \end{equation*}
  hence the coefficients of \( Q_n(X) \) also belong to \( \Bbbk \).

  \SubProofOf{thm:def:cyclotomic_polynomial/uniqueness} Let \( Q_n(X) \) and \( Q_n'(X) \) be the \( n \)-th cyclotomic polynomials over the fields \( \Bbbk \) and \( \Bbbk' \) of characteristic \( p \).

  Via induction on \( n \), similarly to \fullref{thm:def:cyclotomic_polynomial/coefficients}, we can show that
  \begin{equation*}
    Q_n(X) = \frac {X^n - 1} {f(X)} = \frac {X^n - 1} {f(X)'} = Q_n'(X),
  \end{equation*}
  where \( f(X) \) and \( f(X)' \) are defined by \eqref{eq:thm:def:cyclotomic_polynomial/coefficients/proof/step} and are equal by the inductive hypothesis.

  \SubProofOf{thm:def:cyclotomic_polynomial/prime} If \( n \) is prime, it has no divisors except \( 1 \) and itself, thus \fullref{thm:def:cyclotomic_polynomial/product} implies that
  \begin{equation*}
    X^n - 1 = \prod_{d \mid n} Q_d(X) = Q_1(X) \cdot Q_n(X).
  \end{equation*}

  \Fullref{thm:xn_minus_yn_factorization} implies that
  \begin{equation}\label{eq:thm:def:cyclotomic_polynomial/prime/proof}
    X^n - 1 = (X - 1) \sum_{k=0}^{n-1} X^k.
  \end{equation}

  Since \( Q_1(X) = X - 1 \), \eqref{eq:thm:def:cyclotomic_polynomial/prime/single} follows from \eqref{eq:thm:def:cyclotomic_polynomial/prime/proof/single}.

  \SubProofOf{thm:def:cyclotomic_polynomial/odd} Suppose that \( 1 < 2n < p \), so that all relevant cyclotomic polynomials are defined.

  If \( n \) is odd, \fullref{thm:xn_minus_yn_factorization} implies that
  \begin{equation*}
    X^{2n} - 1 = (X^n - 1) (X^n + 1) = -(X^n - 1) ((-X)^n - 1).
  \end{equation*}

  \Fullref{thm:def:cyclotomic_polynomial/product} implies that
  \begin{equation*}
    X^{2n} - 1 = \prod_{d \mid 2n} Q_d(X) = \underbrace{\parens[\Big]{ \prod_{d \mid n} Q_d(X) }}_{X^n - 1} \cdot \parens[\Big]{ \prod_{d \mid n} Q_{2d}(X) }.
  \end{equation*}

  Dividing by \( X^n - 1 \), we obtain
  \begin{equation}\label{eq:thm:def:cyclotomic_polynomial/odd/proof/recurrence}
    \prod_{d \mid n} Q_{2d}(X) = (-X)^n - 1.
  \end{equation}

  Since \( n \) is odd, its divisors are odd, so it remains to use induction on \( n \) and apply the inductive hypothesis to \( Q_{2d} \).

  \SubProof*{Proof of base case} For base case \( n = 3 \), we must show that \( Q_2(X) \cdot Q_6(X) \) equals \( -X^3 - 1 \).

  \fullref{thm:def:cyclotomic_polynomial/prime} implies that \( Q_2(X) = X + 1 \). To calculate \( Q_6(X) \), we divide \( X^3 - 1 \) by \( X + 1 \) and verify that its roots are primitive sixth roots of unity. Indeed, \Fullref{thm:xn_minus_yn_factorization} implies that
  \begin{equation*}
    \frac {(-X)^3 - 1} {-(-X) + 1}
    =
    X^2 - X + 1.
  \end{equation*}

  If \( \alpha \) is a root of this polynomial, then
  \begin{equation}\label{eq:thm:def:cyclotomic_polynomial/odd/proof/q6}
    \alpha^2 = \alpha - 1,
  \end{equation}
  thus
  \begin{balign*}
    \alpha^6
    &\reloset {\eqref{eq:thm:def:cyclotomic_polynomial/odd/proof/q6}} =
    (\alpha - 1)^3
    = \\ &=
    \alpha^3 - 3\alpha^2 + 3\alpha - 1
    = \\ &=
    \alpha^3 - \cancel{3\alpha^2} + \cancel{3\alpha^2} + 2
    \reloset {\eqref{eq:thm:def:cyclotomic_polynomial/odd/proof/q6}} = \\ &=
    \alpha \cdot (\alpha - 1) + 2
    = \\ &=
    \alpha^2 - \alpha + 2
    \reloset {\eqref{eq:thm:def:cyclotomic_polynomial/odd/proof/q6}} = \\ &=
    1.
  \end{balign*}

  Then \( \alpha \) is a sixth root of unity. We will now show that it has order \( 6 \). Indeed:
  \begin{itemize}
    \item \( \alpha = 1 \) implies that \( \alpha^2 = 0 \), hence also \( \alpha = 0 \), which is a contradiction.
    \item \( \alpha^2 = 1 \) implies that \( \alpha = 0 \), hence \( \alpha^2 = 0 \), which is again a contradiction.
    \item \( \alpha^3 = 1 \) implies that
    \begin{equation*}
      1
      =
      \alpha^3
      \reloset {\eqref{eq:thm:def:cyclotomic_polynomial/odd/proof/q6}} =
      (\alpha - 1) \alpha
      =
      \alpha^2 - \alpha
      \reloset {\eqref{eq:thm:def:cyclotomic_polynomial/odd/proof/q6}} =
      -1,
    \end{equation*}
    which is again a contradiction.

    \item \( \alpha^4 = 1 \) implies that
    \begin{equation*}
      1
      =
      \alpha^4
      \reloset {\eqref{eq:thm:def:cyclotomic_polynomial/odd/proof/q6}} =
      (\alpha - 1)^2
      =
      (\alpha^2 - \alpha) - (\alpha - 1)
      \reloset {\eqref{eq:thm:def:cyclotomic_polynomial/odd/proof/q6}} =
      \alpha^2 - \alpha - \alpha^2
      =
      -\alpha,
    \end{equation*}
    hence \( \alpha = -1 \). But then
    \begin{equation*}
      1
      =
      \alpha^2
      \reloset {\eqref{eq:thm:def:cyclotomic_polynomial/odd/proof/q6}} =
      \alpha - 1
      =
      -2,
    \end{equation*}
    which is a contradiction.

    \item \( \alpha^5 = 1 \) implies that \( \alpha^6 = \alpha \), hence \( \alpha = 1 \) or \( \alpha = 0 \). Both lead to contradictions.
  \end{itemize}

  Therefore, \( \alpha \) is indeed a primitive sixth root of unity.

  \SubProof*{Proof of inductive step} Suppose that \eqref{eq:thm:def:cyclotomic_polynomial/odd} holds for the \( d \)-th cyclotomic polynomial, where \( d < n \). Then \eqref{eq:thm:def:cyclotomic_polynomial/odd/proof/recurrence} implies that
  \begin{equation*}
    \prod_{d \mid n} Q_{2d}(X) = Q_{2n} \cdot \prod_{\substack{d \mid n \\ d \neq n}} \underbrace{Q_{2d}(X)}_{Q_d(-X)} = (-X)^n - 1.
  \end{equation*}

  Then
  \begin{equation*}
    Q_{2n}(X) = \frac {(-X)^n - 1} {\displaystyle \prod_{\substack{d \mid n \\ d \neq n}} Q_{-X}} = Q_n(-X).
  \end{equation*}
\end{proof}

\begin{example}\label{ex:def:cyclotomic_polynomial}
  We list examples of \hyperref[def:cyclotomic_polynomial]{cyclotomic polynomials}.
  \begin{thmenum}
    \thmitem{ex:def:cyclotomic_polynomial/q1} The first cyclotomic polynomial is \( Q_1(X) = X - 1 \).

    \thmitem{ex:def:cyclotomic_polynomial/q2} The second cyclotomic polynomial is \( Q_2(X) = X + 1 \) because \( -1 \) generates both \( 1 \) and \( -1 \).

    This can also be shown via \fullref{thm:def:cyclotomic_polynomial/prime}.

    \thmitem{ex:def:cyclotomic_polynomial/q4} Suppose that we are working over characteristic different from \( 2 \).

    Since \( 2 \) is the only proper divisor of \( 4 \), \fullref{thm:def:cyclotomic_polynomial/product} implies that
    \begin{equation*}
      X^4 - 1 = Q_4(X) \cdot Q_2(X) \cdot Q_1(X) = Q_4(X) \cdot (X + 1) (X - 1).
    \end{equation*}

    \Fullref{thm:xn_minus_yn_factorization} implies that
    \begin{equation*}
      X^4 - 1 = (X^2 - 1) (X^2 + 1) = (X - 1) (X + 1) (X^2 + 1),
    \end{equation*}
    hence
    \begin{equation*}
      Q_4(X) = X^2 + 1.
    \end{equation*}

    \thmitem{ex:def:cyclotomic_polynomial/q6} As shown in our proof of \fullref{thm:def:cyclotomic_polynomial/odd}, if the characteristic is at least \( 7 \), then \( Q_6(X) = X^2 - X + 1 \).
  \end{thmenum}
\end{example}

\begin{proposition}\label{thm:cyclotomic_polynomials_irreducible}
  In a field of characteristic \( 0 \), all \hyperref[def:cyclotomic_polynomial]{cyclotomic polynomials} are \hyperref[def:domain_divisibility/irreducible]{irreducible}.
\end{proposition}
\begin{comments}
  \item We will neither prove nor use this proposition. Several proofs can be found in \cite[thm. 2]{Weintraub2013CyclotomicPolynomials}.
  \item For fields of positive characteristic this does not hold, leading to the concept of \hyperref[def:finite_field_primitive_polynomial]{primitive polynomials}. An explicit counterexample for a reducible cyclotomic polynomial is given in \fullref{ex:def:finite_field_primitive_polynomial/f2_quartic}.
\end{comments}

\paragraph{Irreducible polynomials over finite fields}

\begin{proposition}\label{thm:roots_of_polynomial_over_finite_field}\mcite{MathSE:roots_of_an_irreducible_polynomial_in_a_finite_field}
  Fix a univariate polynomial \( f(X) \) of degree \( n \) over a \hyperref[def:finite_field]{finite field} \( \BbbF_q \).

  If \( \alpha \) is a root of \( f(X) \) in \( \BbbF_{q^n} \), then \( \alpha, \alpha^q, \alpha^{q^2}, \cdots, \alpha^{q^{n-1}} \) are roots of \( f(X) \).
\end{proposition}
\begin{proof}
  Let \( a_0, \ldots, a_n \) be the coefficients of \( f(X) \), so that
  \begin{equation*}
    f(X) = \sum_{i=0}^n a_i X^i.
  \end{equation*}

  \Fullref{thm:finite_fields/polynomial} implies that \( x^q = x \) for every member \( x \) of \( \BbbF_q \), hence, by induction,
  \begin{equation}\label{eq:thm:roots_of_polynomial_over_finite_field/proof/power}
    a_i^{q^k} = (a_i^q)^{q^{k-1}} = a_i^{q^{k-1}} = \cdots = a_i.
  \end{equation}

  Then
  \begin{equation*}
    f(\alpha^{q^k})
    =
    \sum_{i=0}^n a_i \alpha^{i q^k}
    \reloset {\eqref{eq:thm:roots_of_polynomial_over_finite_field/proof/power}} =
    \sum_{i=0}^n a_i^{q^k} \alpha^{i q^k}
    =
    \sum_{i=0}^n (a_i X^i)^{q^k}
    \reloset {\eqref{eq:thm:newtons_binomial_theorem_positive_characteristic}} =
    \parens[\Big]{ \sum_{i=0}^n a_i X^i }^{q^k}
    =
    f(\alpha)^{q^k}
    =
    0.
  \end{equation*}

  Therefore, \( \alpha, \alpha^q, \alpha^{q^2}, \cdots, \alpha^{q^{n-1}} \) are roots of \( f(X) \).
\end{proof}

\begin{proposition}\label{thm:irreducible_polynomial_over_finite_field}\mcite{MathSE:roots_of_an_irreducible_polynomial_in_a_finite_field}
  Fix an \hyperref[def:domain_divisibility/irreducible]{irreducible polynomial} \( f(X) \) of degree \( n \) over a \hyperref[def:finite_field]{finite field} \( \BbbF_q \).

  If \( \alpha \) is a root of \( f(X) \) in \( \BbbF_{q^n} \), then \( \alpha, \alpha^q, \alpha^{q^2}, \cdots, \alpha^{q^{n-1}} \) are the \( n \) distinct roots of \( f(X) \), each having the same multiplicative order dividing \( q^n - 1 \).
\end{proposition}
\begin{comments}
  \item See \fullref{ex:def:finite_field_primitive_polynomial} for concrete examples relating to this proposition.
  \item The multiplicative order of \( \alpha \) may be less than \( q^n - 1 \), in which case \( \alpha \) will not be a primitive root of \( \BbbF_{q^n} \). This is one motivation for introducing \hyperref[def:finite_field_primitive_polynomial]{primitive polynomials}.
\end{comments}
\begin{proof}
  \Fullref{thm:roots_of_polynomial_over_finite_field} implies that \( \alpha, \alpha^q, \alpha^{q^2}, \cdots, \alpha^{q^{n-1}} \) are roots of \( f(X) \).

  We will first build a polynomial out of the distinct roots of \( f(X) \), and then prove that it coincides with \( g(X) \).

  Suppose that \( \alpha, \alpha^q, \alpha^{q^2}, \cdots, \alpha^{q^{m-1}} \) are distinct, but \( \alpha^{q^m} = \alpha^{q^i} \) for some \( 0 < i < m \). We claim that \( i = 0 \).

  Indeed, if \( i > 0 \), we have
  \begin{equation*}
    \parens[\Big]{ \alpha^{q^{m-1}} - \alpha^{q^{i-1}} }^q
    \reloset {\eqref{eq:thm:newtons_binomial_theorem_positive_characteristic}} =
    \alpha^{q^m} - \alpha^{q^i}
    =
    0,
  \end{equation*}
  contradicting the minimality of \( m \).

  It follows that \( \alpha, \alpha^q, \alpha^{q^2}, \cdots, \alpha^{q^{m-1}} \) are distinct and that \( \alpha^{q^m} = \alpha \).

  Consider the polynomial
  \begin{equation*}
    g(X) \coloneqq \prod_{i=0}^{m-1} (X - \alpha^{q^i}).
  \end{equation*}

  Let \( b_0, \ldots, b_m \) be the coefficients of \( g(X) \), so that
  \begin{equation*}
    g(X) = \sum_{i=0}^m b_i X^i.
  \end{equation*}

  We will show that the coefficients of \( g(X) \) lie in \( \BbbF_q \), from where it will follow that \( g(X) \) divides \( f(X) \).

  We have
  \begin{align*}
    g(X)^q
    =
    \prod_{i=0}^{m-1} (X - \alpha^{q^i})^q
    \reloset {\eqref{eq:thm:newtons_binomial_theorem_positive_characteristic}} =
    \prod_{i=0}^{m-1} (X^q - \alpha^{q^{i + 1}})
    =
    \prod_{i=1}^m (X^q - \alpha^{q^i})
    \reloset {\alpha^{q^m} = \alpha} =
    \prod_{i=0}^{m-1} (X^q - \alpha^{q^i})
    =
    g(X^q),
  \end{align*}
  and
  \begin{equation*}
    g(X)^q
    =
    \parens[\Big]{ \sum_{i=0}^m b_i X^i }^q
    \reloset {\eqref{eq:thm:newtons_binomial_theorem_positive_characteristic}} =
    \sum_{i=0}^m b_i^q X^{qi}.
  \end{equation*}

  Combining them, we conclude that
  \begin{equation*}
    \sum_{i=0}^m b_i^q X^{qi} = g(X)^q = g(X^q) = \sum_{i=0}^m b_i X^{qi},
  \end{equation*}
  hence \( b_i = b_i^q \) for every coefficient \( b_i \) of \( g(X) \).

  \Fullref{thm:finite_field_roots_of_splitting_polynomial} implies that the coefficients of \( g(X) \) belong to \( \BbbF_q \).

  Therefore, \( g(X) \) is a non-unit polynomial in \( \BbbF_q[X] \) that divides \( f(X) \). Since \( f(X) \) is irreducible, it follows that it is a scalar multiple of \( f(X) \). Therefore, \( m = n \).

  Then we have found \( n \) distinct roots for \( f(X) \). It remains to show that each of them has order \( q^n - 1 \).

  We will rely on \fullref{thm:finite_field_multiplicative_group_is_cyclic}, which implies that the multiplicative group of \( \BbbF_{q^n} \) is cyclic. Let \( \beta \) be a generator of the group. Then there exists some positive integer \( k < q^m \) for which \( \alpha = \beta^k \).

  \Fullref{thm:def:group_element_order/power} implies that the multiplicative order of \( \alpha^{q^i} = \beta^{k \cdot q^i} \) is
  \begin{equation}\label{eq:thm:irreducible_polynomial_over_finite_field/order}
    \frac {q^n - 1} {\gcd(q^n - 1, k \cdot q^i)}.
  \end{equation}

  If \( d \) is a common divisor of \( q^n - 1 \) and \( k \), it obviously also divides \( k \cdot q^i \). Conversely, suppose that \( d \) is a common divisor of \( q^n - 1 \) and \( k \cdot q^i \). \Fullref{thm:finite_fields/cardinality} implies that \( q \) is a positive power of the characteristic \( p \) of \( \BbbF_q \). Then \( p \) is the only prime divisor of \( q^i \), and, unless \( q^i \) and \( d \) are coprime, \( p \) also divides \( d \). If \( p \) divides \( d \), it divides \( q^n - 1 \). \Fullref{thm:n_plus_1_coprime} implies that \( q^n - 1 \) and \( q^n \) are coprime, however, and \( p \) divides \( q^n \), leading to a contradiction. Therefore, \( d \) and \( q^i \) are coprime, and thus \( d \) divides \( k \).

  We have obtained that \( d \) is a common divisor of \( q^n - 1 \) and \( k \) if and only if it is a common divisor of \( q^n - 1 \) and \( k \cdot q^i \). It follows via \eqref{eq:thm:irreducible_polynomial_over_finite_field/order} that all the roots of \( f(X) \) have the same order.
\end{proof}

\paragraph{Primitive polynomials}

\begin{definition}\label{def:finite_field_primitive_polynomial}\mcite[def. 3.15]{LidlNiederreiter1997FiniteFields}
  We say that a \hyperref[def:polynomial_algebra/polynomials]{polynomial} \( f(X) \) of degree \( n \) over a \hyperref[def:finite_field]{finite field} \( \BbbF_q \) is \term{primitive} if it is the \hyperref[def:algebraic_element_minimal_polynomial]{minimal polynomial} over \( \BbbF_q \) of a \hyperref[def:finite_field_primitive_element]{primitive element} of \( \BbbF_{q^n} \).
\end{definition}
\begin{comments}
  \item This definition is unrelated to primitive polynomials in general \hyperref[def:integral_domain]{integral domains} in the sense of \fullref{def:domain_primitive_polynomial}. See \fullref{rem:primitive_polynomial_terminology}.

  \item The precise relation to \hyperref[def:cyclotomic_polynomial]{cyclotomic polynomials} is given in \fullref{thm:primitive_polynomial_cyclotomic_factor}.

  \item See \fullref{ex:def:finite_field_primitive_polynomial} for examples and counterexamples related to primitive polynomials.
\end{comments}

\begin{remark}\label{rem:primitive_polynomial_terminology}
  The term \enquote{primitive polynomial} has multiple unrelated established meanings:
  \begin{itemize}
    \item In \hyperref[def:bezout_domain]{Bezout domains}, it refers to polynomials with coprime coefficients, and this definition further generalizes for arbitrary \hyperref[def:integral_domain]{integral domains} in \fullref{def:domain_primitive_polynomial}.

    \item In \hyperref[def:finite_field]{finite fields}, it refers to minimal polynomials of primitive elements, as defined in \fullref{def:finite_field_primitive_polynomial}.
  \end{itemize}

  Fortunately, every nonzero polynomial over a field is primitive in the sense of \fullref{def:domain_primitive_polynomial}, which eliminates most of the possible confusion.

  \incite[106]{Berlekamp2015AlgebraicCodingTheory} remarks that
  \begin{displayquote}
    Following Dickson (1901) and Albert (1956), all coding theorists now define a \textit{primitive polynomial} of degree \( m \) as an irreducible factor of \( Q^{(q^m - 1)} \) over \( \op{GF}(q) \). Some writers in other specialties still use the classical terminology, according to which a polynomial is primitive iff its coefficients are relatively prime rational integers.
  \end{displayquote}

  Berlekamp uses the notation \( \op{GF}(q) \) for finite fields of order \( q \) (from \enquote{Galois field}) and the notation \( Q^{(d)}(x) \) for \hyperref[def:cyclotomic_polynomial]{cyclotomic polynomials}. We will show in \fullref{thm:primitive_polynomial_cyclotomic_factor} that his definition is equivalent to ours, modulo us additionally requiring primitive polynomials to be monic.

  Berlekamp's latter cited reference is \cite{Albert1956Algebra}, which gives a definition closely resembling ours.

  \incite[38]{Gentle2006RandomNumberGeneration} instead refers to irreducible polynomials as \enquote{primitive}, even though, as shown in \fullref{ex:def:finite_field_primitive_polynomial/f2_quartic}, their roots may not be primitive elements.
\end{remark}

\begin{example}\label{ex:def:finite_field_primitive_polynomial}
  We list examples of \hyperref[def:finite_field_primitive_polynomial]{primitive polynomials}:
  \begin{thmenum}
    \thmitem{ex:def:finite_field_primitive_polynomial/f2_quadratic} Consider the general quadratic polynomial \( f(X) = X^2 + bX + c \) over \( \BbbF_2 \). \Fullref{thm:small_degree_polynomial_without_roots_irreducible} implies that if neither \( 0 \) nor \( 1 \) is a root of \( f(X) \), it is irreducible over \( \BbbF_2 \). There are four quadratic polynomials, and only irreducible one has \( b = c = 1 \), that is, \( f(X) = Q_3(X) = X^2 + X + 1 \). This is the third \hyperref[def:cyclotomic_polynomial]{cyclotomic polynomial}, discussed in \fullref{ex:def:finite_field/f4} and \fullref{ex:def:root_of_unity/f2_cubic}. Both of its roots are primitive elements of \( \BbbF_4 \).

    Then \( Q_3(X) \) is a primitive polynomial.

    Every root \( \alpha \) of \( Q_3(X) \) must satisfy \( \alpha^2 = \alpha + 1 \), which empirically verifies the conclusion from \fullref{thm:irreducible_polynomial_over_finite_field} that all roots of an irreducible polynomial have the same order.

    \thmitem{ex:def:finite_field_primitive_polynomial/f2_cubic} Now consider the general cubic polynomial \( f(X) = X^3 + bX^2 + cX + d \), again over \( \BbbF_2 \).

    There are \( 8 \) cubic polynomials. We are looking for irreducible cubic polynomials, and \fullref{thm:small_degree_polynomial_without_roots_irreducible} implies that a sufficient condition for irreducibility is that neither \( 0 \) nor \( 1 \) should be a root of \( f(X) \).

    If \( d \) is zero, then \( 0 \) is a root of \( f(X) \). Otherwise, if both \( b \) and \( c \) are nonzero, \( 1 \) is a root of \( f(X) \). This leaves us with two polynomials, namely \( g(X) = X^3 + X^2 + 1 \) and \( h(X) = X^3 + X + 1 \).

    Let \( \alpha \) be a root of \( g(X) \). We have
    \begin{equation}\label{ex:def:finite_field_primitive_polynomial/f2_cubic/alpha_third}
      \alpha^3 = \alpha^2 + 1.
    \end{equation}

    Then
    \begin{equation}\label{ex:def:finite_field_primitive_polynomial/f2_cubic/alpha_fourth}
      \alpha^4
      =
      \alpha^3 \cdot \alpha
      \reloset {\eqref{ex:def:finite_field_primitive_polynomial/f2_cubic/alpha_third}} =
      (\alpha^2 + 1) \cdot \alpha
      =
      \alpha^3 + \alpha
      \reloset {\eqref{ex:def:finite_field_primitive_polynomial/f2_cubic/alpha_third}} =
      \alpha^2 + 1 + \alpha
    \end{equation}
    and
    \begin{equation}\label{ex:def:finite_field_primitive_polynomial/f2_cubic/alpha_eight}
      \alpha^8
      \reloset {\eqref{ex:def:finite_field_primitive_polynomial/f2_cubic/alpha_fourth}} =
      (\alpha^2 + \alpha + 1)^2
      \reloset {\eqref{eq:thm:newtons_binomial_theorem_positive_characteristic}} =
      \alpha^4 + \alpha^2 + 1
      \reloset {\eqref{ex:def:finite_field_primitive_polynomial/f2_cubic/alpha_fourth}} =
      \cancel{\alpha^2} + \alpha + \cancel{1} + \cancel{\alpha^2} + \cancel{1}
      =
      \alpha.
    \end{equation}

    The multiplicative order of \( \alpha \) is at most \( 7 \), and \fullref{thm:finite_field_roots_of_splitting_polynomial} implies that \( \alpha \) belongs to \( \BbbF_8 \).

    \Fullref{thm:irreducible_polynomial_over_finite_field} implies that, since \( g(X) \) is irreducible, all its roots have the same degree, which divides \( 7 \). But \( 7 \) is prime, hence the order of \( \alpha \) is either \( 1 \) or \( 7 \). If \( \alpha = 1 \), \eqref{ex:def:finite_field_primitive_polynomial/f2_cubic/alpha_third} implies that \( 1 = \alpha^3 = \alpha^2 + 1 = 1 + 1 = 0 \), which is a contradiction.

    Therefore, the order of \( \alpha \) is exactly \( 7 \).

    We have shown that \( g(X) \) is not only irreducible --- its roots are primitive elements of \( \BbbF_8 \), and thus \( g(X) \) satisfies the definition of a primitive polynomial.

    We can similarly show that \( h(X) = X^3 + X + 1 \) is also primitive.

    \thmitem{ex:def:finite_field_primitive_polynomial/f2_quartic} We will show that the fifth \hyperref[def:cyclotomic_polynomial]{cyclotomic polynomial} \( Q_5(X) = X^4 + X^3 + X^2 + X + 1 \) is irreducible but not primitive.

    To see that it is irreducible, suppose that \( Q_5(X) = g(X) \cdot h(X) \). Suppose that \( g(X) \) is not constant. Then the degree of \( g(X) \).

    \begin{itemize}
      \item Since neither \( 0 \) nor \( 1 \) is a root of \( Q_5(X) \), \( g(X) \) cannot be linear since it would have a root, which would also be a root of \( Q_5(X) \).

      \item If \( g(X) \) is quadratic or cubic, it must be irreducible since otherwise one of its factors would have a root. We already saw in \fullref{ex:def:finite_field_primitive_polynomial/f2_quadratic} that the only irreducible quadratic polynomial over \( \BbbF_2 \) is \( X^2 + X + 1 \) and in \fullref{ex:def:finite_field_primitive_polynomial/f2_cubic} that the only irreducible cubic polynomials are \( X^3 + X^2 + 1 \) and \( X^3 + X + 1 \). Neither of these divide \( Q_5(X) \):
      \begin{align*}
        Q_5(X) &= X^2 \cdot (X^2 + X + 1) + (X + 1), \\
        Q_5(X) &= X \cdot (X^3 + X^2 + 1) + (X^2 + 1), \\
        Q_5(X) &= (X + 1) \cdot (X^3 + X + 1) + X.
      \end{align*}

      Hence, \( g(X) \) cannot be quadratic or cubic.

      \item It remains for \( g(X) \) to be quartic, in which case it can only coincide with \( Q_5(X) \).
    \end{itemize}

    It follows that \( Q_5(X) \) is indeed irreducible. We will now show that it is not primitive.

    \Fullref{thm:finite_splitting_field} implies that every root \( \alpha \) of \( Q_5(X) \) belongs to the extension \( \BbbF_{2^m} \) of \( \BbbF_2 \), where \( m \) is the smallest positive integer such that the multiplicative order of \( \alpha \) divides \( 2^m - 1 \).

    For any root \( \alpha \) of \( Q_5(X) \), we have
    \begin{equation}\label{eq:ex:def:finite_field_primitive_polynomial/f2_quartic/alpha_fourth}
      \alpha^4 = \alpha^3 + \alpha^2 + \alpha + 1
    \end{equation}
    and thus
    \begin{equation*}
      \alpha^5
      \reloset{\eqref{eq:ex:def:finite_field_primitive_polynomial/f2_quartic/alpha_fourth}} =
      \alpha^4 + \alpha^3 + \alpha^2 + \alpha
      \reloset{\eqref{eq:ex:def:finite_field_primitive_polynomial/f2_quartic/alpha_fourth}} =
      \alpha^4 + \alpha^4 + 1
      =
      1.
    \end{equation*}

    Then the order of \( \alpha \) is thus either \( 1 \) or \( 5 \). If \( \alpha = 1 \), \eqref{eq:ex:def:finite_field_primitive_polynomial/f2_quartic/alpha_fourth} implies that \( \alpha^4 = 0 \), which in turn implies that \( \alpha = 0 \), leading to a contradiction. Thus, the multiplicative order of \( \alpha \) is \( 5 \). This empirically verifies the conclusion from \fullref{thm:irreducible_polynomial_over_finite_field} that all roots of an irreducible polynomial have the same order.

    Then \( m \) is the minimum positive integer such that \( 5 \) divides \( 2^m - 1 \), hence \( m = 4 \).

    Therefore, even though the roots of \( Q_5(X) \) belong to \( \BbbF_{16} \), as require by the definition of primitive polynomials, none of them is a primitive element of \( \BbbF_{16} \).
  \end{thmenum}
\end{example}

\begin{proposition}\label{thm:primitive_polynomial_cyclotomic_factor}
  A monic polynomial \( f(X) \) of degree \( n \) over \( \BbbF_q \) is \hyperref[def:finite_field_primitive_polynomial]{primitive} if and only if it is an \hyperref[def:domain_divisibility/irreducible]{irreducible} factor of the \hyperref[def:cyclotomic_polynomial]{cyclotomic polynomial} \( Q_{q^n - 1}(X) \).
\end{proposition}
\begin{proof}
  \SufficiencySubProof Suppose that \( f(X) \) is a minimal polynomial of a primitive element \( \alpha \) of \( \BbbF_{q^n} \).

  Then \( \alpha \) is multiplicative order \( q^n - 1 \), and hence is a primitive \( (q^n - 1) \)-th root of unity. It is therefore a root of the cyclotomic polynomial \( Q_{q^n - 1}(X) \).

  \Fullref{thm:irreducible_polynomial_over_finite_field} implies that all \( n \) roots of \( f(X) \) have the same order, and hence all are primitive. Then every root of \( f(X) \) is a root of \( Q_{q^n - 1}(X) \), hence \( f(X) \) divides \( Q_{q^n - 1}(X) \).

  \NecessitySubProof Suppose that \( f(X) \) is a monic irreducible factor of \( Q_{q^n - 1}(X) \) with coefficients in \( \BbbF_q \).

  Then all roots of \( f(X) \) are primitive elements of \( \BbbF_{q^n} \), and \fullref{thm:irreducible_polynomial_is_minimal} implies that \( f(X) \) is a minimal polynomial for each of its roots.

  Therefore, \( f(X) \) is a primitive polynomial.
\end{proof}
