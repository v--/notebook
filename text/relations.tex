\subsection{Relations}\label{subsec:relations}

\begin{definition}\label{def:cartesian_product}
  We are now in a vicious cycle where we need binary Cartesian products in order to define arbitrary Cartesian products. We will do this as quickly as possible, prior to introducing relations and functions.

  \begin{thmenum}
    \thmitem{def:cartesian_product/kuratowski_pair}\mcite[36]{Enderton1977Sets} We define the \term{Kuratowski pair} or simply \term{ordered pair} \( \braket{ x, y } \) of the sets \( x \) and \( y \) as
    \begin{equation*}
      \braket{ x, y } \coloneqq \set{ \set{ x }, \set{ x, y } }.
    \end{equation*}

    This is a simple and widespread definition that encodes the order of \( x \) and \( y \), unlike, for example, the set \( \set{ x, y } \).

    We will later use the notation \( (x, y) \), but until \fullref{rem:kuratowski_pairs_and_tuples}, we want to distinguish between Kuratowski pairs and \( 2 \)-tuples.

    The following \hyperref[con:predicate_formula]{predicate formula} encodes this notion and will be used in \( \ref{eq:def:function/predicate}[\rho, \sigma, \tau] \):
    \begin{equation*}\taglabel[\op{IsPair}]{eq:def:cartesian_product/kuratowski_pair_predicate}
      \ref{eq:def:cartesian_product/kuratowski_pair_predicate}[\rho, \sigma, \tau] \coloneqq \qforall \xi \parens[\Bigg]{ \xi \in \rho \syniff \parens[\Big]{ \parens[\Big]{ \qforall {\eta \in \xi} \eta \syneq \sigma } \synvee \parens[\Big]{ \qforall {\eta \in \xi} (\eta \syneq \sigma \synvee \eta \syneq \tau) } } }
    \end{equation*}

    \thmitem{def:cartesian_product/indexed_family}\mimprovised We define an \term{indexed family} as a set \( i \) of Kuratowski pairs where \( \braket{ k, A } \in i \) and \( \braket{ k, B } \in i \) together imply \( A = B \). It is conventional to denote this unique set corresponding to \( k \) as \( A_k \) without an explicit reference to \( i \).

    We define the underlying \term{index set} of the family as
    \begin{equation*}
      \mscrK \coloneqq \set{ k \given \qexists A \braket{ k, A } \in i }.
    \end{equation*}

    The family itself can then be denoted as
    \begin{equation*}
      \seq{ A_k }_{k \in \mscrK}.
    \end{equation*}

    If \( A_k \in \mscrA \) for every \( k \in \mscrK \), we sometimes write
    \begin{equation*}
      \seq{ A_k }_{k \in \mscrK} \subseteq \mscrA,
    \end{equation*}
    although the latter is an embedding rather than set inclusion.

    \thmitem{def:cartesian_product/tuple}\mimprovised We say that the indexed family \( \seq{ x_k }_{k \in \mscrK} \) is a \term{tuple} from the indexed family \( \seq{ A_k }_{k \in \mscrK} \) if both have the same index set and if, for every \( k \in \mscrK \), the value \( x_k \) belongs to \( A_k \).

    We will later see that this is precisely a \hyperref[def:choice_function]{choice function}.

    \thmitem{def:cartesian_product/product}\mcite[54]{Enderton1977Sets} Finally, we define the \term[bg=Декартово произведение (\cite[368]{ГеновМиховскиМоллов1991}), ru=Декартово произведение (\cite[26]{Гуров2013})]{Cartesian product} of an indexed family \( \seq{ A_k }_{k \in \mscrK} \) is the set of all tuples from this family. We denote the Cartesian product by
    \begin{equation*}
      \prod_{k \in \mscrK} A_k.
    \end{equation*}

    With the availability of \hyperref[def:function]{functions} in \fullref{subsec:functions}, we will be able to redefine the Cartesian product as the set
    \begin{equation*}
      \prod_{k \in \mscrK} A_k = \set*{ f: A \to \bigcup_{k \in \mscrK} A_k \given* \qforall {k \in \mscrK} k \in A_k }.
    \end{equation*}
  \end{thmenum}
\end{definition}

\begin{definition}\label{def:sequence}\mimprovised
  We will call families indexed by \( \omega \) \term{infinite sequences} or simply \term{sequences}. We will start indexing at \( 1 \) rather than \( 0 \); this issue is discussed in \fullref{rem:peano_arithmetic_zero}.

  We will use several notations, depending on the context:
  \begin{itemize}
    \item \( \seq{ A_k }_{k \in \BbbN} \), which is the notation for general indexed families from \fullref{def:cartesian_product/indexed_family}.
    \item \( \seq{ A_k }_{k=1}^\infty \), which easily extends to cases such as \( \seq{ A_k }_{k=m}^n \) when the index set is \( \set{ m, \ldots, n } \).
    \item \( (A_1, A_2, \ldots) \), which is used when explicitly enumerating members of the sequence.
  \end{itemize}

  It is conventional to write a family \( \seq{ A_k }_{k \in n} \) indexed by a natural number \( n \) using the notation \( (A_1, \cdots, A_n) \), with or without the outer parentheses. A family indexed by \( n \) is called a \term{finite sequence} of \term{length} \( n \), although \enquote{\( n \)-tuple} is often used.

  Some common terms regarding the length of sequences:
  \begin{itemize}
    \item \term{Singletons} for \( n = 1 \) (distinct from \hyperref[rem:singleton_sets]{singleton sets}, but the two notions can be conflated).
    \item \term{Pairs} for \( n = 2 \) (distinct from \hyperref[def:cartesian_product/kuratowski_pair]{Kuratowski pairs}, as explained in \fullref{rem:kuratowski_pairs_and_tuples}, but also conflated).
    \item \term{Triples} for \( n = 3 \).
    \item \term{Quadruples} for \( n = 4 \).
  \end{itemize}
\end{definition}

\begin{remark}\label{rem:kuratowski_pairs_and_tuples}
  Note that the \enquote{\hyperref[def:sequence]{sequence} tuple} \( (A, B) \)
  \begin{equation*}
    (A, B) = \set[\Bigg]{ \set[\Big]{ \set{ 0 }, \set{ 0, A } }, \set[\Big]{ \set{ 1 }, \set{ 1, B } } }
  \end{equation*}
  is formally different from the \hyperref[def:cartesian_product/kuratowski_pair]{Kuratowski pair}
  \begin{equation*}
    \braket{ A, B } = \set[\Big]{ \set{ A }, \set{ A, B } }.
  \end{equation*}

  This is one reason we hurried to define general Cartesian products --- we wanted to avoid working with tuples defined in terms of Kuratowski pairs. We even introduced a special notation for them, just so we can avoid any confusion. Nevertheless, it is conventional to conflate Kuratowski pairs with \( \set{ 0, 1 } \)-indexed tuples.

  We similarly conflate the tuples \( (A, (B, C)) \), \( ((A, B), C) \) and \( (A, B, C) \).
\end{remark}

\medskip

\begin{definition}\label{def:relation}\mcite[41]{Enderton1977Sets}
  Let \( A_1, \ldots, A_n \) be a \hyperref[def:sequence]{finite sequence} of sets. We call any subset
  \begin{equation*}
    R \subseteq A_1 \times \cdots \times A_n
  \end{equation*}
  of their \hyperref[def:cartesian_product/product]{Cartesian product} an \( n \)-ary \term[bg=релация (\cite[367]{ГеновМиховскиМоллов1991}), ru=отношение (\cite[25]{КолмогоровДрагалин2006})]{relation}.

  We say that the values
  \begin{equation*}
    x_1 \in A_n, \ldots, x_n \in A_n
  \end{equation*}
  are \term{related} with respect to \( R \) if \( (x_1, \ldots, x_n) \in R \).

  Relations are sometimes implicitly assumed to be binary (i.e. \( n = 2 \)), for example by \incite[7]{Kelley1975} or by \incite[1]{Engelking1989}. Herbert Enderton initially defines them as binary in \mcite[40]{Enderton1977Sets}, but gives a more general definition one page later. We discuss binary relations specifically in \fullref{def:binary_relation}, and give here definitions that hold more generally.

  \begin{thmenum}[series=def:relation]
    \thmitem{def:relation/arity} For some small values of \( n \), we use the adjectives from \fullref{def:operation_arity} for describing the relation arity (e.g. unary, binary).

    \thmitem{def:relation/single_set} If all \( A_k \) for \( k = 1, \ldots, n \) are equal to the set \( A \), we say that \( R \subseteq A^n \) is a relation \hi{on \( A \)}.

    \thmitem{def:relation/empty} The relation is \term{empty} if it is the empty set, i.e. if no two elements are related.
  \end{thmenum}
\end{definition}

\begin{definition}\label{def:binary_relation}\mcite[40]{Enderton1977Sets}
  An important special case of \hyperref[def:relation]{relations} are \term{binary relations}. Given two sets, a binary relation between them is a subset of their \hyperref[def:cartesian_product]{Cartesian product}.

  In addition to the terminology for \fullref{def:relation}, we also introduce the following terms:
  \begin{thmenum}[series=def:binary_relation]
    \thmitem{def:binary_relation/inverse}\mcite[44]{Enderton1977Sets} We defined the \term{converse relation} of \( R \) as
    \begin{equation*}
      R^{-1} \coloneqq \set{ (y, x) \given (x, y) \in R }.
    \end{equation*}

    \thmitem{def:binary_relation/diagonal}\mcite[8]{Kelley1975} For every set \( A \), we define a special relation,
    \begin{equation*}
      \increment_A \coloneqq \set{ (x, x) \given x \in A },
    \end{equation*}
    which we call the \term[ru=диагональное (отношение) (\cite[def. 2.7]{Гуров2013})]{diagonal relation} or \term{identity relation}.

    \thmitem{def:binary_relation/composition}\mcite[44]{Enderton1977Sets} Given two binary relations \( R \subseteq A \times B \) and \( T \subseteq B \times C \), we define their composition as
    \begin{equation*}
      T \bincirc R \coloneqq \set*{ (x, z) \in A \times C \given* \qexists {y \in B} \parens[\Big]{ (x, y) \in R \T{and} (y, z) \in T } }.
    \end{equation*}
  \end{thmenum}

  Whenever \( A = B \) and \( R \) is simply a binary relation over \( A \), the following are commonly used properties. They are presented as first-order formulas that can be used as axioms for some theory (with \hyperref[rem:first_order_formula_conventions/infix]{infix notation} for \( R \)):
  \begin{thmenum}[resume=def:binary_relation]
    \thmitem{def:binary_relation/reflexive}\mcite[def. 6.2.14(i)]{Hinman2005} We call \( R \) \term[bg=рефлексивна (релация) (\cite[369]{ГеновМиховскиМоллов1991}), ru=рефлексивное (отношение) (\cite[def. 2.7]{Гуров2013})]{reflexive} if \( \Delta_A \subseteq R \), i.e. if every element of \( A \) is related with itself.

    The following formula is used as an axiom for \hyperref[def:strict_partial_order]{nonstrict partial orders} and \hyperref[def:entourage]{entourages}:
    \begin{equation}\label{eq:def:binary_relation/reflexive}
      \qforall \xi (\xi \mathbin{R} \xi).
    \end{equation}

    \thmitem{def:binary_relation/irreflexive}\mcite[def. 6.2.14(ii)]{Hinman2005} We call \( R \) \term[ru=антирефлексивное (отношение) (\cite[def. 2.7]{Гуров2013})]{irreflexive} if \( \Delta_A \cap R = \varnothing \), i.e. if no element of \( A \) is related with itself.

    The following formula is used as an axiom for \hyperref[def:strict_partial_order]{strict partial orders}:
    \begin{equation}\label{eq:def:binary_relation/irreflexive}
      \synneg \qexists \xi (\xi \mathbin{R} \xi).
    \end{equation}

    \thmitem{def:binary_relation/symmetric}\mcite[def. 6.2.14(ix)]{Hinman2005} We call \( R \) \term[bg=симетрична (релация) (\cite[369]{ГеновМиховскиМоллов1991}), ru=симметрическое (отношение) (\cite[def. 2.7]{Гуров2013})]{symmetric} if \( R = R^{-1} \).

    The following formula is used as an axiom for \hyperref[def:equivalence_relation]{equivalence relations}, \hyperref[def:undirected_multigraph]{undirected graphs} and \hyperref[def:entourage]{entourages}:
    \begin{equation}\label{eq:def:binary_relation/symmetric}
      \xi \mathbin{R} \eta \synimplies \eta \mathbin{R} \xi.
    \end{equation}

    \thmitem{def:binary_relation/antisymmetric}\mcite[example 2.2.1(ii)(c)]{Hinman2005} We call \( R \) \term[bg=антисиметрична (релация) (\cite[369]{ГеновМиховскиМоллов1991}), ru=антисимметрическое (отношение) (\cite[def. 2.7]{Гуров2013})]{antisymmetric} if \( R \cap R^{-1} = \Delta_X \).

    The following formula is used as an axiom for \hyperref[def:partially_ordered_set]{partial orders}:
    \begin{equation}\label{eq:def:binary_relation/antisymmetric}
      (\xi \mathbin{R} \eta \synwedge \eta \mathbin{R} \xi) \synimplies \xi \syneq \eta.
    \end{equation}

    \thmitem{def:binary_relation/transitive}\mcite[def. 6.2.14(iii)]{Hinman2005} We call \( R \) \term[bg=транзитивна (релация) (\cite[369]{ГеновМиховскиМоллов1991}), ru=транзитивное (отношение) (\cite[def. 2.7]{Гуров2013})]{transitive} if \( R = R \bincirc R \).

    The following formula is used as an axiom for \hyperref[def:partially_ordered_set]{preorders}:
    \begin{equation}\label{eq:def:binary_relation/transitive}
      (\xi \mathbin{R} \eta \synwedge \eta \mathbin{R} \zeta) \synimplies \xi \mathbin{R} \zeta.
    \end{equation}

    \thmitem{def:binary_relation/connected}\mcite[63]{Enderton1977Sets} We call \( R \) \term[ru=полное (отношение) (\cite[def. 2.7]{Гуров2013})]{connected} if any two member of \( A \) are related.

    The following formula is used as an axiom for \hyperref[def:totally_ordered_set]{nonstrict total orders}:
    \begin{equation}\label{eq:def:binary_relation/connected}
      \qforall \xi \qforall \eta (\xi \mathbin{R} \eta \synvee \eta \mathbin{R} \xi).
    \end{equation}

    \thmitem{def:binary_relation/trichotomy}\mcite[62]{Enderton1977Sets} We say that \( R \) satisfies \term[bg=трихотомия (\cite[11]{Тагамлицки1971Диф})]{trichotomy} if every two elements of \( A \) are either related or equal.

    The following formula is used as an axiom for \hyperref[def:totally_ordered_set]{strict total orders}:
    \begin{equation}\label{eq:def:binary_relation/trichotomy}
      \qforall \xi \qforall \eta (\xi \mathbin{R} \eta \synvee \eta \mathbin{R} \xi \synvee \eta = \xi).
    \end{equation}
  \end{thmenum}
\end{definition}
\begin{comments}
  \item Relations are the semantical counterpart to \hyperref[def:first_order_structure/interpretation/predicate]{first-order predicates} and are equivalent to Boolean-valued functions, as discussed in \fullref{rem:boolean_valued_functions_and_predicates}.
\end{comments}

\begin{example}\label{ex:def:binary_relation}
  \hyperref[def:binary_relation]{Binary relations} are used in vastly different contexts:
  \begin{itemize}
    \item \hyperref[def:function]{Functions} are special binary relations.
    \item \hyperref[sec:order_theory]{Orders} are also special binary relations.
    \item \hyperref[def:directed_graph]{Directed graphs} can be defined as binary relations.
    \item \hyperref[def:entourage]{Entourages} are binary relations in \hyperref[def:uniform_space]{uniform spaces}.
    \item Relations are equivalent to Boolean-valued functions as shown in \fullref{rem:boolean_valued_functions_and_predicates}, and are often used for defining semantics of predicate symbols in \hyperref[subsec:first_order_logic]{first-order logic}.
  \end{itemize}
\end{example}

\begin{definition}\label{def:equivalence_relation}\mimprovised
  If a binary relation on the set \( A \) is \hyperref[def:binary_relation/reflexive]{reflexive}, \hyperref[def:binary_relation/symmetric]{symmetric} and \hyperref[def:binary_relation/transitive]{transitive}, we call it an \term[ru=отношение эквивалентности (\cite[28]{Винберг2014})]{equivalence relation}. In other words, an equivalence relation is a symmetric \hyperref[def:preordered_set]{preorder}.

  We often denote equivalence relations via the symbol \( \sim \).

  \begin{thmenum}
    \thmitem{def:equivalence_relation/coset} We define the \term{equivalence class} of \( x \in A \), also called its \term{coset}, as the set
    \begin{equation*}
      [x] \coloneqq \set{ y \in A \given x \sim y }
    \end{equation*}
    of all elements of \( A \) that are related to \( x \).

    \thmitem{def:equivalence_relation/quotient} We define the \term{quotient set} of \( A \) by \( \sim \) as the set
    \begin{equation*}
      A / {\sim} \ \coloneqq \set{ [x] \given x \in A }.
    \end{equation*}

     If we have a canonical way to choose a representative from each coset, then \( A / {\sim} \) may be regarded as a subset of \( A \). In general, this is not a subset relation but only an embedding.

    \thmitem{def:equivalence_relation/projection} Using forward references to \fullref{subsec:functions}, we define the \term{canonical projection} as the function
    \begin{equation*}
      \begin{aligned}
        &\pi: A \to A / {\sim}  \\
        &\pi(x) \coloneqq [x].
      \end{aligned}
    \end{equation*}

    If we have a fixed \hyperref[def:choice_function]{choice function} \( c: A / {\sim} \to A \), we can also define the canonical embedding
    \begin{equation*}
      \begin{aligned}
        &\iota: A / {\sim} \to A \\
        &\iota([x]) \coloneqq c(x).
      \end{aligned}
    \end{equation*}

    We sometimes have an obvious choice function, for example in \fullref{thm:representatives_in_univariate_polynomial_quotient_set}. In this case, the canonical projection may be regarded as a function from \( A \) to the subset \( c(A / {\sim}) \) of \( A \). Otherwise, \( \pi \) can be regarded as a \hyperref[def:function]{set-valued map}.
  \end{thmenum}
\end{definition}

\begin{example}\label{ex:def:equivalence_relation}
  We list examples of \hyperref[def:equivalence_relation]{equivalence relations}:
  \begin{thmenum}
    \thmitem{ex:def:equivalence_relation/tuple} Given a \hyperref[def:cartesian_product/product]{Cartesian product} \( \prod_{k \in \mscrK} A_k \), for every \( m \in \mscrK \) we can define the equivalence relation
    \begin{equation*}
       \seq{ x_k }_{k \in \mscrK} \sim_m \seq{ y_k }_{k \in \mscrK} \T{if} x_m = y_m.
    \end{equation*}

    Then the quotient \(\prod_{k \in \mscrK} A_k / {\sim_m} \) has exactly one coset for every member of \( A_m \).
  \end{thmenum}
\end{example}

\begin{concept}\label{con:congruence_modulo_relation}
  If \( x \sim y \) for some \hyperref[def:equivalence_relation]{equivalence relation}, we say that they are \term{congruent modulo} \( \sim \). This concept specializes to congruence modulo normal subgroups defined in \fullref{rem:congruence_modulo_substructure}.
\end{concept}

\begin{proposition}\label{thm:equality_is_smallest_equivalence_relation}
  The equality \hyperref[def:binary_relation]{relation} \( = \) is the intersection of all equivalence relations.
\end{proposition}
\begin{proof}
  It is equivalent to the \hyperref[def:binary_relation/diagonal]{diagonal relation} \( \Delta_X \). It is the smallest reflexive (resp. symmetric and transitive) relation on \( A \), that is, the intersection of all reflexive (resp. symmetric and transitive) relations.
\end{proof}

\begin{definition}\label{def:set_cover}\mcite[44]{Engelking1989}
  A \term{cover} of \( A \) is a \hyperref[rem:family_of_sets]{family} \( \mscrA \subseteq \pow(A) \) of nonempty subsets of \( A \) such that \( A = \bigcup \mscrA \). We sometimes use the term more loosely and say that an arbitrary family of sets \( \mscrA \) is a cover of \( A \) if \( A \subseteq \bigcup \mscrA \). The two definitions are identical if we intersect each set in \( \mscrA \) with \( A \) and exclude the empty sets.
\end{definition}

\begin{definition}\label{def:set_partition}\mcite[57]{Enderton1977Sets}
  A \term{partition} of \( A \) is a pairwise \hyperref[def:subset]{disjoint} \hyperref[def:set_cover]{cover}. In other words, the cover \( \mscrA \) is a partition if and only if each element of \( A \) belong to exactly one set in \( \mscrA \).
\end{definition}

\begin{proposition}\label{thm:equivalence_partition}
  Fix a set \( A \). Let \( {\sim} \) be a binary relation of \( A \). The following are equivalent:
  \begin{thmenum}
    \thmitem{thm:equivalence_partition/equivalence} \( {\sim} \) is an \hyperref[def:equivalence_relation]{equivalence relation}.

    \thmitem{thm:equivalence_partition/partition} There exists a \hyperref[def:set_partition]{partition} \( \mscrA \) of \( A \) such that \( x \sim y \) if and only if they belong to the same set in the partition \( \mscrA \).
  \end{thmenum}
\end{proposition}
\begin{proof}
  \ImplicationSubProof{thm:equivalence_partition/equivalence}{thm:equivalence_partition/partition} Let \( {\sim} \) be an equivalence relation on \( A \). The quotient set \( A / {\sim} \) is a partition. Indeed:
  \begin{itemize}
    \item Every element \( x \in A \) belongs exactly one equivalence class \( [x] \) by definition.

    \item The equivalence classes are disjoint. Indeed, assume the contrary. Then there exist \( x \) and \( y \) such that \( [x] \cap [y] \neq \varnothing \) and yet \( x \not\sim y \).

    Let \( z \in [x] \cap [y] \). Then \( z \sim x \) and \( z \sim y \), thus from transitivity of \( {\sim} \) we have \( x \sim z \sim y \) and hence \( x \sim y \), which contradicts our assumption that \( x \not\sim y \).

    Hence, either \( [x] = [x] \) or \( [x] \cap [y] = \varnothing \). That is, different equivalence classes are disjoint.
  \end{itemize}

  \ImplicationSubProof{thm:equivalence_partition/partition}{thm:equivalence_partition/equivalence} Let \( \mscrA \) be a partition of \( A \) such that \( x \sim y \) if and only if they both belong to the same set in \( \mscrA \).

  Given \( x \in A \), denote by \( A_x \) the set in \( \mscrA \) which contains \( x \). The family \( \seq{ A_x }_{x \in A} \) is well-defined since \( \mscrA \) is a partition, which means that \( x \) belongs to exactly one set in \( \mscrA \).

  \SubProofOf*[def:binary_relation/reflexive]{reflexivity} Clearly \( A_x = A_x \), hence \( x \sim x \).

  \SubProofOf*[def:binary_relation/symmetric]{symmetry} If \( x \sim y \), then \( A_x = A_y \), which implies \( A_y = A_x \) and thus \( x \sim y \).

  \SubProofOf*[def:binary_relation/transitive]{transitivity} If \( x \sim y \) and \( y \in z \), then \( A_x = A_y = A_z \) and thus \( x \sim z \).
\end{proof}

\begin{definition}\label{def:relation_closures}\mimprovised
  Let \( R \subseteq A^2 \) be a binary relation on the set \( A \). We introduce several \hyperref[def:moore_closure_operator]{Moore closure operators}:
  \begin{thmenum}
    \thmitem{def:relation_closures/reflexive} We define the \term{reflexive closure} of \( R \) as
    \begin{equation*}
      \cl^R(R) \coloneqq R \cup \Delta_X.
    \end{equation*}

    \thmitem{def:relation_closures/symmetric} We define the \term{symmetric closure} of \( R \) as
    \begin{equation*}
      \cl^S(R) \coloneqq R \cup R^{-1}.
    \end{equation*}

    \thmitem{def:relation_closures/transitive} We define the \term{transitive closure} of \( R \) as
    \begin{equation*}
      \cl^T(R) \coloneqq \bigcup \set{ R^k \given k = 1, 2, \ldots },
    \end{equation*}
    where \( R^k \) is iterated \hyperref[def:binary_relation/composition]{composition} of \( R \).

    Note that this is very different from the transitive closure of a set defined in \fullref{def:transitive_closure_of_a_set}.
  \end{thmenum}
\end{definition}

\begin{definition}\label{def:transitive_reduction}\mcite[44]{Rosen1999}
  Fix a binary relation \( R \). We say that \( Q \subseteq R \) is a \term{transitive reduction} of \( R \) if it is a \hyperref[def:extremal_points/maximal_and_minimal_element]{minimal} relation such that \( \cl^T(Q) = \cl^T(R) \).

  If there exists a smallest relation, it is the unique transitive reduction, and we denote it by \( \red^T(R) \).
\end{definition}

\begin{proposition}\label{thm:def:relation_closures}
  \hyperref[def:relation_closures]{Binary relation closures} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:relation_closures/reflexive_relation} The symmetric and transitive closures of a reflexive relation are also symmetric.
    \thmitem{thm:def:relation_closures/symmetric_relation} The reflexive and transitive closures of a symmetric relation are also symmetric.
    \thmitem{thm:def:relation_closures/transitive_relation} The reflexive closure of a transitive relation is also transitive. The symmetric closure of a transitive relation may not be transitive --- see \fullref{ex:thm:def:relation_closures/symmetric_and_transitive}.

    \thmitem{thm:def:relation_closures/reflexive_and_symmetric} The reflexive and symmetric closures commute:
    \begin{equation}\label{eq:thm:def:relation_closures/reflexive_and_symmetric}
      \cl^S \cl^R(R) = \cl^R \cl^S(R).
    \end{equation}

    \thmitem{thm:def:relation_closures/reflexive_and_transitive} The transitive and reflexive closures commute:
    \begin{equation}\label{eq:thm:def:relation_closures/reflexive_and_transitive}
      \cl^R \cl^T(R) = \cl^T \cl^R(R).
    \end{equation}

    \thmitem{thm:def:relation_closures/symmetric_and_transitive} For the transitive and symmetric closures of \( R \) we have
    \begin{equation}\label{eq:thm:def:relation_closures/symmetric_and_transitive}
      \cl^S \cl^T(R) \subseteq \cl^T \cl^S(R).
    \end{equation}

    The converse holds if \( R \) is symmetric but not in general --- see \fullref{ex:thm:def:relation_closures/symmetric_and_transitive}.
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:relation_closures/reflexive_relation} Trivial.
  \SubProofOf{thm:def:relation_closures/symmetric_relation} Trivial.
  \SubProofOf{thm:def:relation_closures/transitive_relation} Trivial.
  \SubProofOf{thm:def:relation_closures/reflexive_and_symmetric} Trivial.
  \SubProofOf{thm:def:relation_closures/reflexive_and_transitive} The reflexive closure only adds pairs of the form \( (x, x) \). Thus, if \( (x, y) \in \cl^T(\cl^R(R)) \) for \( x \neq y \), then \( (x, y) \in \cl^T(R) \subseteq \cl^R(\cl^T(R)) \).

  Conversely, if \( (x, y) \in \cl^R(\cl^T(R)) \) for \( x \neq y \), then \( (x, y) \in \cl^T(R) \subseteq \cl^R(\cl^T(R)) \).

  \SubProofOf{thm:def:relation_closures/symmetric_and_transitive} If \( (x, y) \in \cl^S(\cl^T(R)) \), then we have the following possibilities:
  \begin{itemize}
    \item If \( (x, y) \in R \), obviously \( (x, y) \in \cl^T(\cl^S(R)) \).
    \item If \( (x, y) \in \cl^T(R) \setminus R \), then there exists some natural number \( k > 1 \) such that \( (x, y) \in R^k \).

    Since \( R^k \subseteq [\cl^S(R)]^k \), as can be shown via induction, we have \( (x, y) \in [\cl^S(R)]^k \). We thus conclude that \( (x, y) \in \cl^T(\cl^S(R)) \).

    \item Finally, if \( (x, y) \not\in \cl^T(R) \), then \( (y, x) \in \cl^T(R) \). As in the previous step, we can show that \( (y, x) \in \cl^T(\cl^S(R))) \). The latter set is symmetric, hence \( (x, y) \in \cl^T(\cl^S(R)) \).
  \end{itemize}

  Since \( (x, y) \) was arbitrary, we conclude that \eqref{eq:thm:def:relation_closures/symmetric_and_transitive} holds.

  Furthermore, if \( R \) is symmetric, then
  \begin{equation*}
    \cl^T \cl^S(R)
    =
    \cl^T(R)
    \reloset {\ref{thm:def:relation_closures/reflexive_relation}} =
    \cl^S \cl^T(R).
  \end{equation*}
\end{proof}

\begin{example}\label{ex:thm:def:relation_closures/symmetric_and_transitive}
  We will show that \hyperref[def:relation_closures/symmetric]{symmetric} and \hyperref[def:relation_closures/transitive]{transitive} closures of relations do not commute. This is also a consequence of the difference between \hyperref[def:graph_connectedness/weak]{weak} and \hyperref[def:graph_connectedness/strong]{strong} connectedness of directed (multi)graphs.

  Consider the set \( A = \set{ a, b, c } \) and the relation \( R = \set{ (a, b), (c, b) } \).

  \begin{figure}[!ht]
    \begin{equation*}
      \includegraphics[page=1]{output/ex__thm__def__relation_closures__symmetric_and_transitive}
    \end{equation*}
    \caption{The relation \( R \) from \fullref{ex:thm:def:relation_closures/symmetric_and_transitive} regarded as \hyperref[def:directed_graph]{directed graphs} with the additional arcs from \( \cl^S(R) \) dashed.}\label{fig:ex:thm:def:relation_closures/symmetric_and_transitive}
  \end{figure}

  It should be noted that \( R \) is \hyperref[def:binary_relation/transitive]{transitive}. Thus,
  \begin{equation*}
    \cl^S(\cl^T(R)) = \cl^S(R) = R \cup \set{ (b, a), (b, c) }.
  \end{equation*}

  The latter set is not transitive because \( (a, b) \) and \( (b, c) \) both belong to \( \cl^S(R) \), but \( (a, c) \) does not.

  This shows that the converse of \eqref{eq:thm:def:relation_closures/symmetric_and_transitive} does not hold in general.
\end{example}

\begin{proposition}\label{thm:equivalence_closure}
  The \hyperref[def:relation_closures/reflexive]{reflexive}, \hyperref[def:relation_closures/symmetric]{symmetric} and \hyperref[def:relation_closures/transitive]{transitive} closure \( \cl^T \cl^S \cl^R (R) \) of any relation \( R \) is an \hyperref[def:equivalence_relation]{equivalence relation}.
\end{proposition}
\begin{comments}
  \item This holds for any permutation of the closures as long as \( \cl^T \) is applied \hi{after} \( \cl^S \). This latter restriction is due to \fullref{thm:def:relation_closures/symmetric_and_transitive}.
  \item An alternative construction of the equivalence closure is given in \fullref{ex:fixed_point_recursion_for_relations}.
\end{comments}
\begin{proof}
  Let \( R \subseteq A \times B \) be an arbitrary relation. By \fullref{thm:def:relation_closures/reflexive_relation}, \( \cl^S \cl^R (R) \) is reflexive. It is also symmetric as the symmetric closure of \( \cl^R(R) \).

  Then the transitive closure \( \cl^T \cl^S \cl^R (R) \) is also symmetric and reflexive by \fullref{thm:def:relation_closures/reflexive_relation} and \fullref{thm:def:relation_closures/symmetric_relation}.

  Therefore, \( \cl^T \cl^S \cl^R (R) \) is an equivalence relation.
\end{proof}
