\section{Figurate numbers}\label{sec:figurate_numbers}

\begin{remark}\label{ex:pythagoreanism}\mcite{Жмудь1990Пифагор}
  Pythagoras of Samos, famous for \fullref{thm:pythagorean_theorem}, was a secretive polymath who lived during the 5th century BC.

  He was known as the founder of a school, now called Pythagoreanism, which contributed, among other areas, to arithmetic and geometry. Due to their secrecy, little is known about Pythagoreans or their achievements, although a lot is attributed to them.

  The Pythagorean school is known for linking together concepts from arithmetic, geometry, music theory and possibly metaphysics.
\end{remark}

\begin{concept}\label{con:figurate_number}
  As discussed in \fullref{con:coordinate_systems}, Descartes is attributed for connecting algebra and geometry after introducing coordinate systems in 1637 in his \enquote{La Géométrie}. Two millennia earlier, Greek geometers found many different connections between \hyperref[def:integers]{positive integers} and \hyperref[con:geometric_shape]{geometric figures}. Integers arising from such connections are referred to as \term[en=figurate number (\cite[xv]{Deza2012FigurateNumbers}), ru=фигурные числа (\cite[14]{АлександровМаркушевичХинчин1963ЭнциклопедияТом4})]{figurate numbers}, and a some of the terminology is still relevant.

  To quote Elena and Michel Deza in \cite[xv]{Deza2012FigurateNumbers}, their book on figurate numbers,
  \begin{displayquote}
    In general, a figurate number is a number that can be represented by regular and discrete geometric pattern of equally spaced points.
  \end{displayquote}

  The philosophical development leading to figurate numbers is described briefly by Boris Rosenfeld in \cite{АлександровМаркушевичХинчин1963ЭнциклопедияТом4}. Rosenfeld, Zhmud and the Deza spouses, as well as \incite[1; 2]{Apostol1976AnalyticNumberTheory}, attribute the concept to the \hyperref[ex:pythagoreanism]{Pythagorean school}.

  We will describe several kinds of figurate numbers by using \hyperref[def:point_configuration]{point configurations} as a formalism.
\end{concept}

\paragraph{Triangular numbers}

\begin{definition}\label{def:triangular_point_configuration}\mimprovised
  We say that a \hyperref[def:point_configuration]{point configuration} \( T \) is \term{triangular} if it is the intersection of a \hyperref[def:hexagonal_point_lattice]{hexagonal point lattice} \( L \) with an \hyperref[def:triangle/equilateral]{equilateral triangle} \( ABC \), possibly \hyperref[def:degenerate_polytope]{degenerate}, whose vertices are in \( L \). We call \( L \) the \term{generating lattice} and \( ABC \) --- the \term{bounding triangle} of \( T \).

  To avoid the pathologies discussed in \fullref{fig:ex:def:triangular_point_configuration/tetractys}, we also require \hyperref[def:primitive_lattice_vector]{primitive vectors} of \( \vect{AB} \) and \( \vect{AC} \) to be \hyperref[def:minimal_lattice_vector]{minimal vectors} of \( L \).
\end{definition}
\begin{comments}
  \item This definition allows us to geometrically describe \hyperref[def:triangular_number]{triangular numbers}. See the discussion in \fullref{rem:triangular_point_configurations}.
\end{comments}

\begin{remark}\label{rem:triangular_point_configurations}
  We define \hyperref[def:triangular_point_configuration]{triangular point configurations} as an attempt to formalize geometric descriptions of \hyperref[def:triangular_number]{triangular numbers}.

  The number of points in these configurations is studied in \fullref{thm:triangular_point_configuration_cardinality}. The recurrence obtained there is readily inferred from an informal geometric description in the spirit of \cref{fig:def:triangular_point_configuration/basic/21} by \incite[34]{ConwayGuy1998Numbers} and \incite[4]{Deza2012FigurateNumbers}, who discuss figurate numbers in depth, as well as by \incite[2]{Apostol1976AnalyticNumberTheory} and \incite[14]{АлександровМаркушевичХинчин1963ЭнциклопедияТом4}.

  Following the aforementioned authors, we allow here degenerate one-point configurations where all vertices of the bounding triangle coincide.
\end{remark}

\begin{example}\label{ex:def:triangular_point_configuration}
  We list some examples of \hyperref[def:triangular_point_configuration]{triangular point configurations}:

  \begin{thmenum}
    \thmitem{ex:def:triangular_point_configuration/basic} We illustrate the construction of several configurations in \cref{fig:def:triangular_point_configuration}. These correspond to the first few \hyperref[def:triangular_number]{triangular numbers}.

    \Cref{fig:def:triangular_point_configuration/basic} is based on the illustration by \incite[2]{Apostol1976AnalyticNumberTheory} used to motivate triangular numbers.

    \begin{figure}[!ht]
      \begin{subcaptionblock}[t]{0.45\textwidth}
        \centering
        \includegraphics[page=1]{output/ex__def__triangular_point_configuration__basic}
        \caption{The generating lattice and bounding triangles for configurations with \( 1 \), \( 3 \), \( 6 \), \( 10 \), \( 15 \) and \( 21 \) points.}\label{fig:def:triangular_point_configuration/basic/triangles}
      \end{subcaptionblock}
      \hfill
      \begin{subcaptionblock}[t]{0.45\textwidth}
        \centering
        \includegraphics[page=2]{output/ex__def__triangular_point_configuration__basic}
        \caption{A configuration with \( 21 \) points.}\label{fig:def:triangular_point_configuration/basic/21}
      \end{subcaptionblock}
      \caption{Several \hyperref[def:triangular_point_configuration]{triangular point configurations} discussed in \fullref{ex:def:triangular_point_configuration/basic}.}\label{fig:def:triangular_point_configuration/basic}
    \end{figure}

    \thmitem{ex:def:triangular_point_configuration/pathological} If we allow the primitive vectors of a \hyperref[def:triangular_point_configuration]{triangular point configurations} not to be minimal, the configurations can contain \enquote{too many} points.

    We noted in \fullref{ex:primitive_lattice_vectors_not_basis} that in such cases the primitive vectors may generate a strict \hyperref[def:point_sublattice]{sublattice}. The points outside this sublattice can still end up in the triangular configuration. This is undesired since triangular configurations would not correspond to triangular numbers, and thus to the informal triangular arrangements of points discussed in \fullref{rem:triangular_point_configurations}.

    \begin{figure}[!ht]
      \begin{subcaptionblock}{0.45\textwidth}
        \centering
        \includegraphics[page=1]{output/ex__def__triangular_point_configuration__pathological}
      \end{subcaptionblock}
      \hfill
      \begin{subcaptionblock}{0.45\textwidth}
        \centering
        \includegraphics[page=2]{output/ex__def__triangular_point_configuration__pathological}
      \end{subcaptionblock}
      \caption{The configuration of \( 19 \) points from \fullref{ex:def:triangular_point_configuration/pathological} lying on a hexagonal point lattice and bounded by an equilateral triangle but not satisfying the minimality condition from \fullref{def:triangular_point_configuration}.}\label{fig:ex:def:triangular_point_configuration/pathological}
    \end{figure}

    \thmitem{ex:def:triangular_point_configuration/tetractys}\mcite[1]{Cornford1923PythagoreanMysticism} The \term[ru=тетрактида (\cite[99]{Жмудь1990Пифагор})]{tetractys} is a schematic \hyperref[def:triangular_point_configuration]{triangular configuration} of \( 10 \) points arranged in \( 4 \) rows. An illustration is given in \cref{fig:ex:def:triangular_point_configuration/tetractys}.

    \begin{figure}[!ht]
      \centering
      \includegraphics[page=1]{output/ex__def__triangular_point_configuration__tetractys}
      \caption{The \hyperref[ex:def:triangular_point_configuration/tetractys]{tetractys}.}\label{fig:ex:def:triangular_point_configuration/tetractys}
    \end{figure}

    It is attributed to the \hyperref[ex:pythagoreanism]{Pythagorean school} as a geometric representation of concordant ratios in music theory. Other scientific and mystic properties ascribed to the tetractys are discussed  by \incite[1]{Cornford1923PythagoreanMysticism} and \incite[99]{Жмудь1990Пифагор}.
  \end{thmenum}
\end{example}

\begin{lemma}\label{thm:primitive_hexagonal_lattice_vector_norm}
  Fix a \hyperref[def:hexagonal_point_lattice]{hexagonal point lattice} \( L \). Let \( u \) and \( v \) be equinormed vectors in \( L \) such that \( \measuredangle(u, v) \) is a multiple of \( \pi / 3 \). Suppose that \( u \) is \hyperref[def:primitive_lattice_vector]{primitive}.

  Then \( v \) is primitive if and only if \( \norm{u} = \norm{v} \).
\end{lemma}
\begin{proof}
  Denote the (measure of the) angle between \( u \) and \( v \) by \( \alpha \).

  Let \( v' \) be a rotation of \( u \) by \( \alpha \) radians. \Fullref{thm:hexagonal_point_lattice_vector_rotation} implies that \( v' \) is a point of \( L \). It is unidirectional with \( v \), thus \( v' = a v \) for some positive real number \( a \). Since \( u \) and \( v' \) are congruent, they have the same norm,
  \begin{equation*}
    \norm{u} = \norm{v'} = a \norm{v}.
  \end{equation*}

  Similarly, let \( u \) be a rotation of \( v \) by \( 2\pi - \alpha \) radians. Then \( u' = b u \) for some positive integer \( b \). Thus,
  \begin{equation*}
    \norm{u} = a \norm{v} = a \norm{u'} = a b \norm{u},
  \end{equation*}
  hence \( ab = 1 \). It follows that \( a = 1 / b \).

  \begin{itemize}
    \item If \( v \) is primitive, then \( a \) is an integer, hence \( a = b = 1 \) and \( \norm{u} = \norm{v} \).
    \item Conversely, if \( \norm{u} = \norm{v} \), then \( a = 1 \) and hence \( b = 1 \).
  \end{itemize}
\end{proof}

\begin{lemma}\label{thm:hexagonal_point_lattice_equilateral_triangle}
  If the vertices of an \hyperref[def:triangle/equilateral]{equilateral triangle} belong to a \hyperref[def:hexagonal_point_lattice]{hexagonal point lattice}, all sides of the triangle contain the same amount of points of the lattice.
\end{lemma}
\begin{comments}
  \item We have an analogous lemma for hypercubes in hypercubic lattices --- see \fullref{thm:hypercubic_point_lattice_hypercube}.
\end{comments}
\begin{proof}
  Let \( L \) be a hexagonal point lattice and let \( ABC \) be an equilateral triangle whose vertices are in \( L \).

  By definition, the vectors \( \vect{AB} \) and \( \vect{AC} \) are linearly independent and the angle between them is \( \pi / 3 \) radians.

  Let \( B' \) be the point of \( L \) on the segment \( AB \) closest to \( A \), and similarly let \( C' \) be the point of \( L \) on \( AC \) closest to \( A \). Consider the \hyperref[def:primitive_lattice_vector]{primitive vectors} \( u \coloneqq \vect{AB'} \) and \( v \coloneqq \vect{AC'} \)\fnote{Note that it is possible for \( u \) and \( v \) not to form a basis, as shown in \fullref{ex:primitive_lattice_vectors_not_basis}.}.

  The segment \( AB \) has \( \norm{\vect{AB}} / \norm{u} \) points because the points on \( AB \) translations of \( A \) by multiples of \( u \), and similarly for \( AC \).

  \Fullref{thm:primitive_hexagonal_lattice_vector_norm} implies that, since \( \vect{AB} \) and \( \vect{AC} \) have the same norm, so do \( u \) and \( v \). It follows that the number of lattice points in \( AB \) and in \( AC \) coincide, that is,
  \begin{equation*}
    \frac {\norm{\vect{AB}}} {\norm{u}} = \frac {\norm{\vect{AC}}} {\norm{v}}.
  \end{equation*}

  Denote this common value by \( k \). Then both \( AB \) and \( AC \) have \( k + 1 \) points.

  For the third side \( BC \), note that
  \begin{equation*}
    \norm{BC} = \norm{AC} - \norm{AB} = k(v - u).
  \end{equation*}

  \Fullref{thm:v_minus_u_as_rotation} implies that \( v - u \) is a rotation of \( v \) by \( \pi / 3 \) radians. Then they have the same norm. \Fullref{thm:primitive_hexagonal_lattice_vector_norm} then that, since \( v \) is primitive, so is \( v - u \).

  Then the side \( BC \) also contains \( k + 1 \) points of \( L \).
\end{proof}

\begin{definition}\label{def:triangular_point_configuration_order}\mimprovised
  We define the \term{order} of a \hyperref[def:triangular_point_configuration]{triangular point configuration} as the number of lattice points on any of the sides of its bounding triangle. For degenerate triangles, we define the order to be \( 1 \).
\end{definition}
\begin{comments}
  \item We have an analogous notion for hypercubic configurations --- see \fullref{def:hypercubic_point_configuration_order}.
\end{comments}
\begin{defproof}
  \Fullref{thm:hexagonal_point_lattice_equilateral_triangle} implies that all sides have the same amount of points, so the notion is well-defined.
\end{defproof}

\begin{proposition}\label{thm:triangular_point_configuration_existence}
  For every positive integer \( n \), there exists at least one \hyperref[def:triangular_point_configuration]{triangular point configuration} of \hyperref[def:triangular_point_configuration_order]{order} \( n \).
\end{proposition}
\begin{proof}
  Let \( L \) be the \hyperref[def:hexagonal_point_lattice]{standard hexagonal point lattice} and let \( \set{ u, v } \) be its standard basis. Fix a point \( A \) in \( L \).

  Let \( B \) be the translation of \( A \) by \( (n - 1)u \), and \( C \) --- the translation of \( A \) by \( (n - 1)v \).

  If \( n = 1 \), then \( ABC \) is by definition a degenerate triangle.

  Let \( n > 1 \). \Fullref{thm:hexagonal_point_lattice_minimal_basis} implies that \( u \) and \( v \) form a basis of \( L \).

  For the side \( BC \), we have
  \begin{equation*}
    \norm{\vect{BC}} = \norm{\vect{AC} - \vect{BC}} = (n - 1) \norm{v - u}.
  \end{equation*}

  \Fullref{thm:v_minus_u_as_rotation} implies that \( v - u \) is also minimal, thus the triangle \( ABC \) is equilateral.

  Then the intersection of \( ABC \) and \( L \) is a triangular point configuration of order \( n \).
\end{proof}

\begin{proposition}\label{thm:triangular_point_configuration_cardinality}
  The number of points in a \hyperref[def:triangular_point_configuration]{triangular point configuration} of \hyperref[def:triangular_point_configuration_order]{order} \( n \) is
  \begin{equation}\label{eq:thm:triangular_point_configuration_cardinality}
    m = \sum_{k=1}^n k.
  \end{equation}
\end{proposition}
\begin{proof}
  Fix a triangular point configuration \( T \) with bounding triangle \( ABC \) and generating lattice \( L \). Denote its order by \( n \).

  We have handled the case where \( ABC \) is a degenerate triangle with \( n = 1 \), which implies \( m = 1 \), thus satisfying \eqref{eq:thm:triangular_point_configuration_cardinality}. Suppose that \( ABC \) is non-degenerate.

  Then \( n > 1 \). Consider the primitive vectors \( u \coloneqq \vect{AB} / (n - 1) \) and \( v \coloneqq \vect{AC} / (n - 1) \). Due to the imposed minimality condition in \fullref{def:triangular_point_configuration}, they are minimal, and \fullref{thm:hexagonal_point_lattice_minimal_basis} implies that they form a basis of \( L \).

  Let \( \alpha \), \( \beta \) and \( \gamma \) be the \hyperref[def:barycentric_coordinate_system]{barycentric coordinates} for the point \( P \) with respect to \( ABC \) with origin \( A \). Let \( b \coloneqq (n - 1)\beta \) and \( c \coloneqq (n - 1)\gamma \). Then
  \begin{equation*}
    \vect{AP} = \beta \vect{AB} + \gamma \vect{AC} = \beta (n - 1) u + \gamma (n - 1) v = bu + cv.
  \end{equation*}

  Since \( \alpha + \beta + \gamma = 1 \), we conclude that \( b + c \leq n - 1 \). Since \( \beta \) and \( \gamma \) are nonnegative, so are \( b \) and \( c \).

  If \( P \) is in \( L \), then \( b \) and \( c \) are integers. To determine the number of points of \( L' \) in \( ABC \), we thus need to count the number of nonnegative integers \( b \) and \( c \) satisfying \( b + c \leq n - 1 \).

  In the equation \( b + c = k - 1 \), the value \( c \) is determined by \( b \) and \( k \), thus the solutions in positive integers are determined by the possible values for \( b \), which are \( 0, \ldots, k - 1 \). Therefore, there are
  \begin{equation*}
    m = \sum_{k=1}^n k
  \end{equation*}
  positive integer solutions to \( b + c \leq n - 1 \).

  We have shown that \( T \) contains \( m \) points of \( L \). This concludes the proof.
\end{proof}

\begin{definition}\label{def:triangular_number}
  We say that the positive integer \( m \) is a \term[en=triangular number (\cite[1]{Deza2012FigurateNumbers}), ru=треугольное число (\cite[14]{АлександровМаркушевичХинчин1963ЭнциклопедияТом4})]{triangular number} if any of the following equivalent conditions hold:
  \begin{thmenum}
    \thmitem{def:triangular_number/geometric} There exists a \hyperref[def:triangular_point_configuration]{triangular configuration} of \( m \) points.

    \thmitem{def:triangular_number/arithmetic} There exists a positive integer \( n \) such that
    \begin{equation}\label{eq:def:triangular_number/arithmetic}
      m = \sum_{k=1}^n k.
    \end{equation}
  \end{thmenum}
\end{definition}
\begin{comments}
  \item \Fullref{thm:numeric_arithmetic_progression_partial_sums} implies that
  \begin{equation*}
    m = \sum_{k=1}^n k = \frac {n(n + 1)} 2 = \binom n 2.
  \end{equation*}

  \item Of course, there exists a sequence of triangular numbers indexed by \( n \).

  \item We can see several triangular numbers in \cref{fig:def:triangular_point_configuration}. On the other hand, \cref{fig:ex:triangular_point_configuration_minimality} shows that the minimality condition in \fullref{def:triangular_point_configuration} is important in order for the two definition to be equivalent.

  \item In the literature, the geometric description of triangular numbers is usually only given informally. See the discussion in \fullref{rem:triangular_point_configurations}.

  \item \incite[48]{Knuth1997ArtVol1} calls triangular numbers \enquote{termial numbers} and introduces the notation \( n? \) for the \( n \)-th \enquote{termial}.
\end{comments}
\begin{proof}
  \ImplicationSubProof{def:triangular_number/geometric}{def:triangular_number/arithmetic} Fix a triangular point configuration \( T \) with \( m \) points. Let \( n \) be its \hyperref[def:triangular_point_configuration_order]{order}.

  \Fullref{thm:triangular_point_configuration_cardinality} then implies that \eqref{eq:def:triangular_number/arithmetic} holds.

  \ImplicationSubProof{def:triangular_number/arithmetic}{def:triangular_number/geometric} Suppose that a positive integer \( n \) exists such that \eqref{eq:def:triangular_number/arithmetic} holds.

  \Fullref{thm:triangular_point_configuration_existence} constructs a triangular point configuration of order \( n \). \Fullref{thm:triangular_point_configuration_cardinality} then implies that this configuration has exactly \( m \) elements.
\end{proof}

\paragraph{Hypercubic numbers}

\begin{definition}\label{def:hypercubic_point_configuration}\mimprovised
  We say that a \hyperref[def:point_configuration]{point configuration} \( T \) in \( \BbbR^d \) is \term{hypercubic} of dimension \( d \) if it is the intersection of a \( d \)-dimensional \hyperref[def:hypercubic_point_lattice]{hypercubic lattice} \( L \) with a \( d \)-dimensional \hyperref[def:hypercube]{hypercube} \( H \), possibly \hyperref[def:degenerate_polytope]{degenerate}, whose vertices are in \( L \). We call \( L \) the \term{generating lattice} and \( H \) --- the \term{bounding hypercube} of \( T \).

  As in \fullref{def:triangular_point_configuration}, we additionally require the \hyperref[def:primitive_lattice_vector]{primitive vector} of the directional vectors of every side to be \hyperref[def:minimal_lattice_vector]{minimal}.

  Based on the dimension \( d \), we will replace the term \enquote{hypercubic} with \term{square} or \term{cubic} in accordance with \fullref{def:hypercube_terminology}.
\end{definition}

\begin{example}\label{ex:def:hypercubic_point_configuration}
  We list some examples of \hyperref[def:hypercubic_point_configuration]{hypercubic point configurations}:

  \begin{thmenum}
    \thmitem{ex:def:hypercubic_point_configuration/square} We illustrate the construction of several square point configurations in \cref{fig:def:hypercubic_point_configuration}. These correspond to the first few \hyperref[def:hypercubic_number]{square numbers}.

    \Cref{fig:def:hypercubic_point_configuration/square} is based on the illustration by \incite[2]{Apostol1976AnalyticNumberTheory} used to motivate square numbers.

    \begin{figure}[!ht]
      \begin{subcaptionblock}[t]{0.45\textwidth}
        \centering
        \includegraphics[page=1]{output/ex__def__hypercubic_point_configuration__square}
        \caption{The generating lattice and bounding squares for configurations with \( 1 \), \( 4 \), \( 9 \), \( 16 \), \( 25 \) and \( 36 \) points.}\label{fig:def:hypercubic_point_configuration/square/squares}
      \end{subcaptionblock}
      \hfill
      \begin{subcaptionblock}[t]{0.45\textwidth}
        \centering
        \includegraphics[page=2]{output/ex__def__hypercubic_point_configuration__square}
        \caption{A configuration with \( 36 \) point.}\label{fig:def:hypercubic_point_configuration/square/25}
      \end{subcaptionblock}
      \caption{Several \hyperref[def:hypercubic_point_configuration]{square point configurations}.}\label{fig:def:hypercubic_point_configuration/square}
    \end{figure}

    \thmitem{ex:def:hypercubic_point_configuration/cubic} We illustrate several cubic point configurations in \cref{fig:ex:def:hypercubic_point_configuration/cubic}. Drawings of cubic configurations quickly become cluttered.

    \begin{figure}[!ht]
    \hfill
      \begin{subcaptionblock}{0.3\textwidth}
        \centering
        \includegraphics[page=1]{output/ex__def__hypercubic_point_configuration__cubic__8}
      \end{subcaptionblock}
      \hfill
      \begin{subcaptionblock}{0.3\textwidth}
        \centering
        \includegraphics[page=1]{output/ex__def__hypercubic_point_configuration__cubic__27}
      \end{subcaptionblock}
      \hfill
      \begin{subcaptionblock}{0.3\textwidth}
        \centering
        \includegraphics[page=1]{output/ex__def__hypercubic_point_configuration__cubic__64}
      \end{subcaptionblock}
      \caption{The bounding cubes for \hyperref[def:hypercube_point_configuration]{cubic configurations} of \( 8 \), \( 27 \) and \( 64 \) points.}\label{fig:ex:def:hypercubic_point_configuration/cubic}
    \end{figure}
  \end{thmenum}
\end{example}

\begin{lemma}\label{thm:hypercubic_point_lattice_hypercube}
  If the vertices of a \hyperref[def:hypercube]{hypercube} belong to a \hyperref[def:hypercubic_point_lattice]{hypercubic point lattice}, all sides of the hypercube contain the same amount of points of the lattice.
\end{lemma}
\begin{comments}
  \item We have an analogous lemma for triangles in triangular lattices --- see \fullref{thm:hypercubic_point_lattice_hypercube}. We only need to use the analog of \fullref{thm:primitive_hexagonal_lattice_vector_norm} once, so we prove it inline.
\end{comments}
\begin{proof}
  Consider a hypercube \( H \) of dimension \( d \) with vertices in the hypercubic point lattice \( L \).

  Fix a vertex \( A \) of \( H \) and let \( B_1, \ldots, B_d \) be its adjacent vertices. For \( k = 1, \ldots, d \), Let \( B_k' \) be the point of \( L \) on the segment \( A B_k \) closest to \( A \), and denote the vector \( \vect{A B_k'} \) by \( v_k \). Since both \( A \) and \( B_k' \) belong to \( L \), so does \( v_k \).

  Fix any \( 1 < k \leq d \). Since \( H \) is a parallelotope, the vectors \( v_1, \ldots, v_d \) are orthogonal. Thus, in the plane generated by \( v_1 \) and \( v_k \), we can rotate \( v_1 \) by either \( \pi / 2 \) or \( 3\pi / 2 \) radians to obtain a vector \( v_k' \) unidirectional with \( v_k \). \Fullref{thm:hypercubic_point_lattice_vector_rotation} implies that \( v_k' \) is again a lattice vector, hence \( v_k' = a v_k \) for some real number \( a \geq 1 \). Similarly, we can rotate \( v_k \) to obtain a vector \( v_1' \) unidirectional with \( v_1 \), hence \( v_1' = b v_1 \) for some real number \( b \geq 1 \). Since \( v_k' \) and \( v_1 \) have the same norm, as do \( v_1' \) and \( v_k \), we have
  \begin{equation*}
    \norm{v_k} = \norm{v_1'} = a \norm{v_1} = a \norm{v_k'} = ab \norm{v_k},
  \end{equation*}
  hence \( ab = 1 \).

  Since both \( a \geq 1 \) and \( b \geq 1 \), we conclude that \( a = b = 1 \). Therefore, \( v_1 \) and \( v_k \) have the same norm.

  Generalizing on \( k \), we conclude that the family \( v_1, \ldots, v_d \) is equinormed. Since \( H \) is a hypercube, so are \( \vect{AB_1}, \ldots, \vect{AB_d} \). Then
  \begin{equation*}
    \frac {\norm{\vect{A B_1}}} {\norm{v_1}} = \cdots = \frac {\norm{\vect{A B_d}}} {\norm{v_d}}.
  \end{equation*}

  The points on the segment \( AB_k \) are the translations of \( A \) by \( v_k \), thus we conclude that every side of \( H \) incident with \( A \) has the same amount of points.

  Every side of \( H \) is a translation of some of the sides incident with \( A \), so we can also conclude that every side of \( H \) has the same amount of points.
\end{proof}

\begin{definition}\label{def:hypercubic_point_configuration_order}
  We define the \term{order} of a \hyperref[def:hypercubic_point_configuration]{hypercubic point configuration} as the number of lattice points on any of the sides of its bounding hypercube. For degenerate hypercubes, we define the order to be \( 1 \).
\end{definition}
\begin{comments}
  \item We have an analogous notion for triangular configurations --- see \fullref{def:triangular_point_configuration_order}.
\end{comments}

\begin{proposition}\label{thm:hypercubic_point_configuration_existence}
  For every \hyperref[def:euclidean_space]{Euclidean space} \( \BbbR^d \) and every positive integer \( n \), there exists at least one \hyperref[def:hypercubic_point_configuration]{hypercubic point configuration} of \hyperref[def:hypercubic_point_configuration_order]{order} \( n \).
\end{proposition}
\begin{proof}
  We can simply scale the \hyperref[def:unit_hypercube]{unit hypercube} by \( n - 1 \) and take its intersection with the \hyperref[def:integer_point_lattice]{integer point lattice} \( \BbbZ^d \).
\end{proof}

\begin{proposition}\label{thm:hypercubic_point_configuration_cardinality}
  The number of points in a \( d \)-dimensional \hyperref[def:hypercubic_point_configuration]{hypercubic point configuration} of \hyperref[def:hypercubic_point_configuration_order]{order} \( n \) is \( n^d \).
\end{proposition}
\begin{proof}
  Fix a \( d \)-dimensional hypercubic point configuration \( T \) with bounding hypercube \( H \) and generating lattice \( L \). Denote its order by \( n \).

  The proposition is trivial for degenerate hypercubes, so suppose that \( H \) is non-degenerate.

  Then \( n > 1 \). Fix a vertex \( A \), let \( B_1, \ldots, B_d \) be its adjacent vertices, and define the primitive vector \( v_k \coloneqq \vect{A B_k} / (n - 1) \) for \( k = 1, \ldots, d \).

  Due to the imposed minimality condition in \fullref{def:hypercubic_point_configuration}, they are minimal, and \fullref{thm:hypercubic_point_lattice_minimal_basis} implies that they form a basis of \( L \).

  Let \( a_1, \ldots, a_n \) be the \hyperref[def:affine_coordinate_system]{affine coordinates} for the point \( P \) with respect to \( A v_1 \cdots v_d \). Then
  \begin{equation*}
    \vect{AP} = \sum_{k=1}^d a_k v_k.
  \end{equation*}

  Since \( H \) is a hypercube, we have \( 0 \leq a_k \leq n - 1 \) for every \( k = 1, \ldots, d \).

  Then, since \( v_1, \ldots, v_d \) is a basis of \( L \), the points of the intersection \( T = H \cap L \) have integer coordinates between \( 0 \) and \( n - 1 \).

  There are \( n \) such integers per dimension, thus the number of points in \( T \) is \( n^d \).
\end{proof}

\begin{definition}\label{def:hypercubic_number}
  We say that the positive integer \( m \) is a \term[en=hypercube number (\cite[\S 3.2.4]{Deza2012FigurateNumbers})]{hypercubic number} or \term{perfect hypercube} of dimension \( d \) if any of the following equivalent conditions hold:
  \begin{thmenum}
    \thmitem{def:hypercubic_number/geometric}\mimprovised There exists a \hyperref[def:hypercubic_point_configuration]{hypercubic configuration} of \( m \) points.

    \thmitem{def:hypercubic_number/arithmetic}\mcite[\S 3.2.4]{Deza2012FigurateNumbers} There exists a positive integer \( n \) such that \( m = n^d \).
  \end{thmenum}

  Based on the dimension \( d \), we will replace the term \enquote{hypercubic} with \term[ru=квадратное (число) (\cite[14]{АлександровМаркушевичХинчин1963ЭнциклопедияТом4}), en=square (number) (\cite[1]{Deza2012FigurateNumbers})]{square} or \term[ru=кубическое (число) (\cite[14]{АлександровМаркушевичХинчин1963ЭнциклопедияТом4}), en=cubic (number) (\cite[1]{Deza2012FigurateNumbers})]{cubic} in accordance with \fullref{def:hypercube_terminology}.
\end{definition}
\begin{proof}
  \ImplicationSubProof{def:hypercubic_number/geometric}{def:hypercubic_number/arithmetic} Fix a \( d \)-dimensional hypercubic point configuration \( T \) with \( m \) points. Let \( n \) be its \hyperref[def:hypercubic_point_configuration_order]{order}.

  \Fullref{thm:hypercubic_point_configuration_cardinality} then implies that \( m = n^d \)

  \ImplicationSubProof{def:hypercubic_number/arithmetic}{def:hypercubic_number/geometric} Suppose that a positive integer \( n \) exists such that \( m = n^d \).

  \Fullref{thm:hypercubic_point_configuration_existence} constructs a \( d \)-dimensional hypercubic point configuration of order \( n \). \Fullref{thm:hypercubic_point_configuration_cardinality} then implies that this configuration has exactly \( m \) elements.
\end{proof}

\paragraph{Pythagorean triples}

\begin{definition}\label{def:fermat_equation}\mcite[291]{Rosen2018DiscreteHandbook}
  The \term{Fermat equation} of order \( n \) over the \hyperref[def:ring]{ring} \( R \) is the \hyperref[def:algebraic_equation]{algebraic equation}
  \begin{equation}\label{eq:def:fermat_equation}
    a^n + b^n = c^n.
  \end{equation}

  The case \( n = 2 \) is known as the \term[en=Pythagorean equation (\cite[\S 4.3.1]{Deza2012FigurateNumbers})]{Pythagorean equation} because of its connection with \fullref{thm:pythagorean_theorem} via \hyperref[def:pythagorean_triples]{Pythagorean triples}.
\end{definition}

\begin{theorem}[Fermat's last theorem]\label{thm:fermats_last_theorem}\mcite[8]{Хинчин1934ТеоремаФерма}
  \hyperref[def:fermat_equation]{Fermat's equation} has no \hyperref[def:algebraic_equation]{nontrivial solutions} over the \hyperref[def:integers]{ring of integers} if \( n > 2 \).
\end{theorem}
\begin{comments}
  \item We will neither prove nor use this theorem. We present it because of its significance, which is discussed in \fullref{rem:thm:fermats_last_theorem}.
\end{comments}

\begin{remark}\label{rem:thm:fermats_last_theorem}
  \Fullref{thm:fermats_last_theorem} is infamous for being very easy to formulate, yet nearly impossible to prove. The first known proof was indirect --- Andrew Wiles published \cite{Wiles1995FermatsTheorem} in 1995, where he proved the Shimura-Taniyama conjecture (which is itself out of scope for this monograph), relying on Ken Ribet's proof of Fermat's theorem from the conjecture.

  The abstract of \cite{Wiles1995FermatsTheorem} is
  \begin{displayquote}
    When Andrew John Wiles was 10 years old, he read Eric Temple Bell's \textit{The Last Problem} and was so impressed by it that he decided that he would be the first person to prove Fermat's Last Theorem. This theorem states that there are no nonzero integers \( a \), \( b \), \( c \), \( n \) with \( n > 2 \) such that \( a^n + b^n = c^n \). The object of this paper is to prove that all semistable elliptic curves over the set of rational numbers are modular. Fermat's Last Theorem follows as a corollary by virtue of previous work by Frey, Serre and Ribet.
  \end{displayquote}

  Several books were written on the history of the theorem and the attempts to prove it. One of them was already mentioned. According to another, \incite[8]{Хинчин1934ТеоремаФерма}, in 1670 the son of Pierre de Fermat published a book about \hyperref[def:algebraic_equation/diophantine]{Diophantine equations}, containing some notes from Pierre the Fermat in its margins.

  Next to the \hyperref[def:fermat_equation]{Pythagorean equation}, Fermat wrote a note, which can be found in the original Latin in the very beginning of Wiles' paper. In \cite[291]{Rosen2018DiscreteHandbook} it has been translated as follows:
  \begin{displayquote}
    However, it is impossible to write a cube as the sum of two cubes, a fourth power as the sum of two fourth powers and in general any power the sum of two similar powers. For this I have discovered a truly wonderful proof, but the margin is too small to contain it.
  \end{displayquote}

  The aforementioned books were published decades prior to Wiles' proof, and naturally do not discuss the proof itself, nor the methods used to prove it.

  We will show in \fullref{thm:fermat_curve_rational_points_via_fermat_triples} how the problem can be restated geometrically.
\end{remark}

\begin{definition}\label{def:pythagorean_triangle}\mcite[146]{Киселёв2004Геометрия}
  We say that a \hyperref[def:triangle/right]{right triangle} is \term[ru=пифагоровый (треугольник)]{Pythagorean} if its sides have integer lengths.

  The smallest such triangles have sides of length \( 3 \), \( 4 \) and \( 5 \) and are referred to as \term[en=Egyptian triangle (\cite[\S 4.3.1]{Deza2012FigurateNumbers})]{Egyptian triangles}.

  \begin{figure}[!ht]
    \begin{subcaptionblock}[t]{0.40\textwidth}
      \centering
      \includegraphics[page=1]{output/def__pythagorean_triangle__3_4_5}
      \caption{An Egyptian triangle.}\label{fig:def:pythagorean_triangle/3_4_5}
    \end{subcaptionblock}
    \hfill
    \begin{subcaptionblock}[t]{0.55\textwidth}
      \centering
      \includegraphics[page=1]{output/def__pythagorean_triangle__5_12_13}
      \caption{A triangle with sides of length \( 5 \), \( 12 \) and \( 13 \).}\label{fig:def:pythagorean_triangle/5_12_13}
    \end{subcaptionblock}
    \caption{Two \hyperref[def:pythagorean_triangle]{Pythagorean triangles}.}\label{fig:def:pythagorean_triangle/basic}
  \end{figure}
\end{definition}
\begin{comments}
  \item Both this definition and \fullref{def:pythagorean_triple} are inspired by \fullref{thm:pythagorean_theorem}.
\end{comments}

\begin{definition}\label{def:pythagorean_triple}
  We say that a triple \( (a, b, c) \) of positive integers is a \term[en=Pythagorean triple (\cite[\S 4.3.1]{Deza2012FigurateNumbers}), ru=пифагорова тройка (\cite[27]{ГашковЧубариков2005Сложность})]{Pythagorean triple} if any of the following equivalent conditions hold:
  \begin{thmenum}
    \thmitem{def:pythagorean_triple/geometric}\mimprovised There exists a \hyperref[def:pythagorean_triangle]{Pythagorean triangle} whose sides have lengths \( a \), \( b \) and \( c \).

    \thmitem{def:pythagorean_triple/arithmetic}\mcite[\S 4.3.1]{Deza2012FigurateNumbers} The numbers solve the \hyperref[def:fermat_equation]{Pythagorean equation}
    \begin{equation}\label{eq:def:pythagorean_triple}
      a^2 + b^2 = c^2.
    \end{equation}
  \end{thmenum}
\end{definition}
\begin{comments}
  \item Unlike \hyperref[def:triangular_number]{triangular} and \hyperref[def:hypercubic_number]{hypercubic} numbers discussed above, we do not rely on \hyperref[def:point_configuration]{point configurations} for defining Pythagorean triples.
\end{comments}

\begin{definition}\label{def:rational_point}\mcite[12]{Morita2001DiffGeometry}
  We say that a point in a \hyperref[def:euclidean_space]{Euclidean space} is \term[ru=рациональная точка (\cite[19]{Постников1987ГеометрияТом3})]{rational} if its coordinates are \hyperref[def:rational_numbers]{rational numbers}.
\end{definition}

\begin{proposition}\label{thm:fermat_curve_rational_points_via_fermat_triples}
  In the \hyperref[def:euclidean_space]{Euclidean plane}, the \hyperref[def:rational_point]{rational point} \( (a / b, c / d) \) belongs to the \hyperref[def:fermat_curve]{Fermat curve} of degree \( n > 1 \) if and only if \( (ad, bc, bd) \) solves \hyperref[def:fermat_equation]{Fermat's equation} of degree \( n \).
\end{proposition}
\begin{comments}
  \item The rational points of the \hyperref[def:circle]{unit circle} correspond to \hyperref[def:pythagorean_triple]{Pythagorean triples}.
  \item As a consequence of \fullref{thm:fermats_last_theorem}, there are no rational points on Fermat curves of degree \( n > 2 \).
\end{comments}
\begin{proof}
  The Fermat curve of degree \( n \) at a rational point reduces to
  \begin{equation*}
    (a / b)^n + (c / d)^n = 1.
  \end{equation*}

  Multiplying it by \( (bd)^n \), we obtain Fermat's equation
  \begin{equation*}
    (ad)^n + (bc)^n = (bd)^n.
  \end{equation*}
\end{proof}
