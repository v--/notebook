\subsection{Graph walks}\label{subsec:graph_walks}

\paragraph{Walks and paths}

\begin{definition}\label{def:graph_walk}\mimprovised
  We will define several related notions, all of which are commonly called \term[bg=маршрут (\cite[11]{Мирчев2001Графи}), ru=маршрут (\cite[23]{ЕмеличевИПр1990Графы}), en=walk (\cite[10]{Diestel2017Graphs})]{walks}. The relationship between them is discussed in \fullref{rem:undirected_walks} and \fullref{thm:walk_in_undirected_counterpart}.

  Consider a (finite or infinite) nonempty alternating sequence
  \begin{equation}\label{eq:def:graph_walk}
    v_0, e_1, v_1, e_2, v_2, \cdots, e_{n-1}, v_{n-1}, e_n, v_n, \cdots
  \end{equation}
  where \( v_k \) are vertices and \( e_k \) are arcs or edges.

  \begin{thmenum}[series=def:graph_walk]
    \thmitem{def:graph_walk/directed} In a \hyperref[def:directed_multigraph]{directed multigraph}, we say that \eqref{eq:def:graph_walk} is a \term{directed walk} if \( h(e_k) = v_{k-1} \) and \( t(e_k) = v_k \) for \( k = 1, 2, \ldots \). We usually avoid the adjective \enquote{directed} and refer to \enquote{walks}. This suggests the notation
    \begin{equation}\label{eq:def:graph_walk/directed}
      v_0 \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots \reloset {e_{n-1}} \to v_{n-1} \reloset {e_n} \to v_n \reloset {e_{n+1}} \to \cdots
    \end{equation}
    or, in the case of \hyperref[def:directed_graph]{simple directed graphs},
    \begin{equation*}
      v_0 \to v_1 \to \cdots \to v_{n-1} \to v_n \to \cdots.
    \end{equation*}

    \thmitem{def:graph_walk/generalized} Again in a directed multigraph, we say that \eqref{eq:def:graph_walk} is a \term{generalized walk} if \( \set{ h(e_k), t(e_k) } = \set{ v_{k-1}, v_k } \) for every \( k = 1, 2, \ldots \). We call the arc \( e_k \) \term{positively oriented} if \( h(e_k) = v_{k-1} \) and \term{negatively oriented} otherwise.

    Notation-wise, we can reverse negatively oriented arrows, e.g.
    \begin{equation*}
      v_0 \reloset {e_1} \to v_1 \reloset {e_2} \leftarrow v_2 \reloset {e_3} \to v_3 \reloset {e_4} \to \cdots
    \end{equation*}

    \thmitem{def:graph_walk/undirected} In an \hyperref[def:hypergraph/multigraph]{undirected multigraph} (or, more generally, a \hyperref[def:hypergraph]{hypergraph}), trying to adapt both \hyperref[def:graph_walk/directed]{directed walks} and \hyperref[def:graph_walk/generalized]{generalized walks} leads to the same definition. We say that \eqref{eq:def:graph_walk} is a \term{walk} if, for every index \( k \), the vertices \( v_{k-1} \) and \( v_k \) and endpoints of \( e_k \).

    Since walks in undirected graphs and hypergraphs are directed in nature, we use the notations for directed paths and, when speaking about arbitrary-kind graphs, refer to them as \enquote{directed walks} (e.g. in \fullref{def:graph_cycle}).

    (or, more generally, a \hyperref[def:hypergraph]{hypergraph})
  \end{thmenum}

  \begin{figure}[!ht]
    \begin{equation}\label{eq:fig:def:graph_walk}
      \begin{aligned}
        \includegraphics{output/def__graph_walk}
      \end{aligned}
    \end{equation}
    \caption{A \hyperref[def:graph_walk/path]{path}'s \hyperref[def:graph_walk/subgraph]{induced subgraph} in an \hyperref[def:hypergraph/multigraph]{undirected multigraph}.}\label{fig:def:graph_walk}
  \end{figure}

  We introduce the following terminology:
  \begin{thmenum}[resume=def:graph_walk]
    \thmitem{def:graph_walk/subgraph} Each walk induces a \hyperref[def:directed_multigraph/subgraph]{subgraph} consisting of only those vertices and edges in the walk.

    \thmitem{def:graph_walk/length} We define the \term{length} of a walk as its \hyperref[thm:well_ordered_order_type_existence]{ordinal type}, that is, the number of arcs or edges in case of finite walks and \hyperref[thm:omega_is_an_ordinal]{smallest infinite ordinal} \( \omega \) otherwise.

    We will prefer the symbol \( \infty \) to \( \omega \).

    \thmitem{def:graph_walk/subwalk} If one walk is a \hyperref[def:contiguous_subsequence]{contiguous subsequence} of another, we say that it is a \term{subwalk}.

    \thmitem{def:graph_walk/empty} Each vertex \( v \) induces an \term{empty walk} of length \( 0 \).

    \thmitem{def:graph_walk/endpoints} We call \( v_0 \) and \( v_n \) the \term{endpoints} of the walk --- similarly to arcs, we call \( v_0 \) the \term{head}, and \( v_n \) --- the \term{tail}.

    Infinite walks have no tail.

    \thmitem{def:graph_walk/path}\mcite[191]{Erickson2019Algorithms} We say that the walk is a \term[bg=път (\cite[11]{Мирчев2001Графи}), ru=путь (\cite[278]{БелоусовТкачёв2004ДискретнаяМатематика})]{path} if it has no repeated vertices\fnote{Having no repeated vertices also implies having no repeated edges, but not vice versa.}. Unless the path is closed, it can be fully recovered from its induced subgraph, for which reason we can conflate the two.

    \thmitem{def:graph_walk/closed}\mcite[def. 1.1.3]{Knauer2019AlgGraphTheory} We say that a finite walk is \term{closed} if the two endpoints coincide.

    \thmitem{def:graph_walk/reachable}\mcite[191]{Erickson2019Algorithms} We say that the vertex \( v \) is \term[ru=достижимая (вершина) (\cite[278]{БелоусовТкачёв2004ДискретнаяМатематика})]{reachable} from \( u \) if there exists a (possibly trivial) path from \( u \) to \( v \).

    \thmitem{def:graph_walk/concatenation} The \term{concatenation} of the walks
    \begin{equation*}
      v_0 \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots \reloset {e_{n-1}} \to v_{n-1} \reloset {e_n} \to v_n
    \end{equation*}
    and
    \begin{equation*}
      v_n \reloset {e_{n+1}} \to v_{n+1} \reloset {e_{n+2}} \to \cdots \reloset {e_{m-1}} \to v_{m-1} \reloset {e_m} \to v_m \reloset {e_{m+1}} \to \cdots
    \end{equation*}
    is the walk
    \begin{equation*}
      v_0 \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots \reloset {e_n} \to v_n \reloset {e_{n+1}} \to \cdots \reloset {e_m} \to v_m  \reloset {e_{m+1}} \to \cdots
    \end{equation*}

    Note that the tail of the first walk must be the head of the second. The second walk may be infinite, but the first must be finite.
  \end{thmenum}
\end{definition}
\begin{comments}
  \item It may seem tempting to define walks as sequences of arcs (without explicitly mentioning any vertices). This does, however, introduce an additional difficulty --- we can no longer distinguish different empty paths. An alternative is to define walks as a starting vertex followed by a sequence of arcs or edges, but the definition given above has the advantage of being more widely accepted --- see \fullref{rem:graph_walk_terminology/walk}. Furthermore, hypergraph walks as defined by \cite[300]{ЕмеличевИПр1990Графы} may be ambiguous if the vertices are not explicitly specified.
\end{comments}

\begin{proposition}\label{thm:walk_in_undirected_counterpart}
  Let \( G \) be a \hyperref[def:directed_multigraph]{directed multigraph} and \( \hyperref[def:graph_functors/multi_forgetful]{U_M}(G) \) be its undirected counterpart. Then the sequence \eqref{eq:def:graph_walk} is a \hyperref[def:graph_walk/undirected]{walk} in \( \hyperref[def:graph_functors/multi_forgetful]{U_M}(G) \) if and only if it is a \hyperref[def:graph_walk/generalized]{generalized walk} in \( G \).
\end{proposition}
\begin{proof}
  We have adjusted our definitions so that this holds.
\end{proof}

\begin{proposition}\label{thm:def:graph_walk}
  \hyperref[def:graph_walk]{Graph walks} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:graph_walk/finite_graph_infinite_walk} In a \hyperref[def:graph_cardinality/order]{finite-order graph}, every infinite \hyperref[def:graph_walk]{walk} must pass through the same vertex infinitely many times.

    \thmitem{thm:def:graph_walk/finite_graph_finite_path} In a finite-order graph, every \hyperref[def:graph_walk/path]{path} is finite.
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:graph_walk/finite_graph_infinite_walk} Follows from \fullref{thm:pigeonhole_principle/infinitary}.

  \SubProofOf{thm:def:graph_walk/finite_graph_finite_path} Follows from \fullref{thm:def:graph_walk/finite_graph_finite_path}.
\end{proof}

\begin{remark}\label{rem:graph_walk_terminology}
  We will discuss how terminology related to \hyperref[def:graph_walk]{graph walks} differs across authors.

  \begin{thmenum}
    \thmitem{rem:graph_walk_terminology/walk} The term \enquote{walk} is used by
    \begin{itemize}
      \item \incite[21]{Diestel2017Graphs}, \incite[13]{Harary1969Graphs}, \incite[4]{Bollobas1998Graphs}, \incite[571]{Stanley2012CombinatoricsVol1}, \incite[22]{ЕмеличевИПр1990Графы} (as \enquote{маршрут}) and \incite[\S 7.2.3]{Новиков2013ДискретнаяМатематика} (as \enquote{маршрут}) for a finite alternating sequence of vertices and incident edges in simple undirected graphs. We generalize this definition to directed graphs and optionally allow walks to be infinite.

      \item \incite[191]{Erickson2019Algorithms} for a sequence of adjacent vertices. This coincides with our usage in the case of simple undirected graphs.

      \item \incite[12]{Мирчев2001Графи} (as \enquote{маршрут}) for a sequence of (undirected) edges where consecutive arcs have an endpoint in common. This coincides with our usage in the case of nonempty finite walks in undirected graphs.
    \end{itemize}

    \thmitem{rem:graph_walk_terminology/path} The term \enquote{path} is used by
    \begin{itemize}
      \item \incite[13]{Harary1969Graphs} and \incite[571]{Stanley2012CombinatoricsVol1} for walks with distinct vertices. We use this definition.

      \item \incite[377]{Knuth1997ArtVol1} and \incite[191]{Erickson2019Algorithms} also for walks with distinct vertices, however our definition of \enquote{walk} differs from theirs.

      \item \incite[def. 10.4.1]{Rosen2019DiscreteMathematics} for sequences of (undirected) edges for which there exist sequences of vertices that jointly constitute what we call a walk.

      \item \incite[6]{Diestel2017Graphs} and \incite[4]{Bollobas1998Graphs} for a subgraph with an implicit ordering of the vertices and one arc for every pair of consecutive vertices. This also roughly coincides with our usage in the case of undirected graphs.

      \item \incite[def. 1.1.3]{Knauer2019AlgGraphTheory}, \incite[13]{GondranMinoux1984Graphs} and \incite[11]{Мирчев2001Графи} for a sequence of arcs where the tail of each arc is the head of the next. This corresponds to what we call finite nonempty directed walks.

      \item \incite[278]{БелоусовТкачёв2004ДискретнаяМатематика} for a sequence of pairwise adjacent vertices in simple directed graphs. This corresponds to what we call finite paths.
    \end{itemize}

    \thmitem{rem:graph_walk_terminology/simple_path} The term \enquote{simple path} is used by
    \begin{itemize}
      \item \incite[def. 1.1.3]{Knauer2019AlgGraphTheory}, \incite[279]{БелоусовТкачёв2004ДискретнаяМатематика} (as \enquote{простой путь}) and \incite[11]{Мирчев2001Графи} for walks with no repeated vertices --- what we call \enquote{paths}. \incite[32]{GondranMinoux1984Graphs} use \enquote{elementary path} instead. \incite[279]{БелоусовТкачёв2004ДискретнаяМатематика} allow the endpoints to coincide.
    \end{itemize}

    \thmitem{rem:graph_walk_terminology/semipath} The term \enquote{semipath} is used by
    \begin{itemize}
      \item \incite[def. 1.1.3]{Knauer2019AlgGraphTheory} for what we call nonempty finite generalized walks.
    \end{itemize}

    \thmitem{rem:graph_walk_terminology/trail} The term \enquote{trail} is used by
    \begin{itemize}
      \item \incite[13]{Harary1969Graphs}, \incite[571]{Stanley2012CombinatoricsVol1} and \incite[5]{Bollobas1998Graphs} for walks with no repeated arcs.
    \end{itemize}

    \thmitem{rem:graph_walk_terminology/chain} The term \enquote{chain} is used by
    \begin{itemize}
      \item \incite[22]{ЕмеличевИПр1990Графы} (as \enquote{цепь}) and \incite[\S 7.2.3]{Новиков2013ДискретнаяМатематика} (as \enquote{цепь}) for walks with no repeated arcs. In case of no repeated vertices, both use \enquote{simple chain} (\enquote{простая цепь}).

      \item \incite[12]{GondranMinoux1984Graphs} and \incite[10]{Мирчев2001Графи} as (as \enquote{верига}) for a sequence of arcs where consecutive arcs have an endpoint in common. This corresponds to what we call finite nonempty generalized walks.

      \item \incite[278]{БелоусовТкачёв2004ДискретнаяМатематика} as (as \enquote{цепь}) for possibly infinite sequences of pairwise adjacent vertices in simple undirected graphs. This corresponds to what we call paths.
    \end{itemize}
  \end{thmenum}
\end{remark}

\begin{remark}\label{rem:undirected_walks}
  We will discuss two topics related to the direction of graph walks.

  Consider the path
  \begin{equation*}
    a \to b \to c
  \end{equation*}
  in the graph
  \begin{equation*}
    \begin{aligned}
      \includegraphics[page=1]{output/rem__undirected_walk}
    \end{aligned}
  \end{equation*}

  Denote this graph by \( D \). The path discussed can be drawn graphically as
  \begin{equation*}
    \begin{aligned}
      \includegraphics[page=2]{output/rem__undirected_walk}
    \end{aligned}
  \end{equation*}

  The doubling functor \( D_S \) from \fullref{def:graph_functors/simple_doubling} suggests defining walks in a \hyperref[def:undirected_graph]{simple undirected graph} \( G \) as walks in \( D_S(G) \). The following is the same path in the graph's undirected counterpart \hyperref[def:graph_functors/simple_forgetful]{\( U_S(D) \)}:
  \begin{equation*}
    \begin{aligned}
      \includegraphics[page=3]{output/rem__undirected_walk}
    \end{aligned}
  \end{equation*}

  This leads to \fullref{def:graph_walk/undirected}.

  The following is the path discussed above in the doubling \( D_S(U_S(D)) \):
  \begin{equation*}
    \begin{aligned}
      \includegraphics[page=4]{output/rem__undirected_walk}
    \end{aligned}
  \end{equation*}

  Roughly speaking, directed walks in the doubling \( D_S(U_S(D)) \) allow stringing together arcs that are opposite in \( D \). For example, consider the generalized walk
  \begin{equation}\label{eq:def:graph_walk/generalized/example}
    c \leftarrow b \leftarrow a.
  \end{equation}

  It can easily be drawn graphically in \( D_S(U_S(D)) \)
  \begin{equation*}
    \begin{aligned}
      \includegraphics[page=5]{output/rem__undirected_walk}
    \end{aligned}
  \end{equation*}

  But if we want to consider this walk in \( D \), we cannot, because has no arc from \( c \) to \( b \) nor from \( b \) to \( a \). This leads to the generalized walks, which we define in \fullref{def:graph_walk/generalized}.

  Thus, \eqref{eq:def:graph_walk/generalized/example} is an undirected path in \( D \). It is technically also an undirected in \( D_S(U_S(D)) \). It is, however, also a directed path in \( D_S(U_S(D)) \), and we prefer not to use both terms simultaneously.
\end{remark}

\begin{definition}\label{def:directed_multigraph_free_category}\mcite[48]{MacLane1998Categories}
  Let \( G = (V, A, h, t) \) be a \hyperref[def:directed_multigraph]{directed multigraph}. We define the \term{free category} \( F(G) \) generated by \( G \) as follows:
  \begin{itemize}
    \item The \hyperref[def:category/objects]{set of objects} is the set of vertices \( V \).

    \item The \hyperref[def:category/morphisms]{morphisms} between two vertices are the \hyperref[def:graph_walk/directed]{directed walks} between them.

    \item The \hyperref[def:category/composition]{composition of the morphisms} \( p: u \to v \) and \( q: v \to w \) is their \hyperref[def:graph_walk/concatenation]{concatenation}:
    \begin{equation*}
      q \bincirc p = p \cdot q.
    \end{equation*}

    \item The \hyperref[def:category/identity]{identity morphism} on the vertex \( v \) is the \hyperref[def:graph_walk/empty]{empty walk} at \( v \). This is the primary motivation for having a distinct empty path at every vertex.
  \end{itemize}

  Since \( F(G) \) is already defined for every directed multigraph \( G \), if we also define how it acts on \hyperref[def:directed_multigraph/homomorphism]{morphisms}, this will make \( F \) a \hyperref[def:functor]{functor} from the \hyperref[def:directed_multigraph/category]{category of small directed multigraphs} to the \hyperref[def:directed_multigraph/category]{category of small categories}.

  For every small category \( \cat{C} \) and every directed multigraph homomorphism
  \begin{equation*}
    (g_V, g_A): G \to U(\cat{C}),
  \end{equation*}
  consider the following functor, which \enquote{evaluates} walks from \( G \) inside \( \cat{C} \):
  \begin{equation}\label{eq:def:directed_multigraph_free_category/functor_from_homomorphism}
    \begin{aligned}
      &G: F(G) \to \cat{C}, \\
      &G(v) \coloneqq g_V(v) \\
      &G\parens*{ v \overset {e_1} \to \anon \overset \cdots \to \anon \overset {e_n} \to \anon } \coloneqq \begin{cases}
        \id_v,                                                                                                  &n = 0, \\
        g_A(e_n) \bincirc G(v \overset {e_1} \to \anon \overset \cdots \to \anon \overset {e_{n-1}} \to \anon), &n > 0,
      \end{cases}
    \end{aligned}
  \end{equation}

  Put \( F(f_V, f_A) \coloneqq G \). Parameterized on \( G \) and \( (f_V, f_A) \), \( F \) becomes a functor from directed multigraphs to categories.
\end{definition}
\begin{comments}
  \item We will see in \fullref{ex:def:category_adjunction/dm_cat} that \( F \) is actually left adjoint to the corresponding forgetful functor. The new identity loops are an important part of this adjunction.
\end{comments}

\paragraph{Cycles}

\begin{definition}\label{def:graph_cycle}
  We say that the \hyperref[def:graph_walk/closed]{closed} \hyperref[def:graph_walk]{walk}
  \begin{equation}\label{eq:def:graph_cycle}
    v_0 \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots \reloset {e_{n-1}} \to v_{n-1} \reloset {e_n} \to v_n
  \end{equation}
  is a \term[bg=цикъл (\cite[11]{Мирчев2001Графи}), ru=цикл (\cite[279]{БелоусовТкачёв2004ДискретнаяМатематика}), en=cycle (\cite[13]{Harary1969Graphs})]{cycle} if any of the following equivalent conditions hold:
  \begin{thmenum}
    \thmitem{def:graph_cycle/direct}\mcite[279]{БелоусовТкачёв2004ДискретнаяМатематика} The walk is nonempty, the vertices \( v_1, \ldots, v_n \) are distinct, and so are the arcs/edges \( e_1, \ldots, e_n \).

    \thmitem{def:graph_cycle/simplified}\mimprovised The walk is nonempty, the vertices \( v_1, \ldots, v_n \) are distinct and, in case the graph is undirected and \( n = 2 \), additionally \( e_1 \neq e_2 \).

    \thmitem{def:graph_cycle/degree}\mcite[13]{GondranMinoux1984Graphs} In the \hyperref[def:graph_walk/subgraph]{induced subgraph} of the walk, every vertex has \hyperref[def:graph_cardinality/directed_degree]{degree} \( 2 \).
  \end{thmenum}
\end{definition}
\begin{defproof}
  \ImplicationSubProof{def:graph_cycle/simplified}{def:graph_cycle/direct}

  \SubProof*{Proof for directed (multi)graphs} Suppose that \( n > 0 \) and that the vertices \( v_1, \ldots, v_n \) are distinct.

  If \( e_i = e_j \) for some \( 1 \leq i < j \leq n \), then \( v_i = v_j \), which contradicts out assumption that the vertices are distinct. Thus, the arcs \( e_1, \ldots, e_n \) are distinct.

  \SubProof*{Proof for undirected (multi)graphs} Suppose that the vertices \( v_1, \ldots, v_n \) are distinct. Suppose additionally that, if \( n = 2 \), we have \( e_1 \neq e_2 \). We will show that the edges \( e_1, \ldots, e_n \) are distinct.

  With the additional hypothesis, clearly the edges are distinct if \( n = 2 \). If \( n = 1 \), there is only one edge, which is vacuously unique. So suppose that \( n > 2 \).

  If \( e_i = e_j \) for some \( 1 \leq i < j \leq n \), then
  \begin{equation*}
    \set{ v_{i - 1}, v_i } = \set{ v_{j - 1}, v_j },
  \end{equation*}
  which leads to following possibilities:
  \begin{itemize}
    \item If \( v_i = v_j \) and \( v_{i-1} = v_{j-1} \), this contradicts our assumption that vertices are unique.
    \item If \( v_i = v_{j-1} \) and \( v_{i-1} = v_j \), we again have two possibilities:
    \begin{itemize}
      \item If \( i < j - 1 \), then \( v_i = v_{j - 1} \) leads to a contradiction.
      \item Otherwise, if \( i = j - 1 \), then \( v_{j-2} = v_j \).
      \begin{itemize}
        \item If \( j = 2 \), then \( v_n = v_0 = v_2 \) leads to a contradiction since \( n > 2 \).
        \item If \( j > 2 \), then \( v_{j-2} = v_j \) contradicts the assumption that \( v_1, \ldots, v_n \) are distinct.
      \end{itemize}
    \end{itemize}
  \end{itemize}

  In all cases, we have reached a contradiction, thus \( e_i = e_j \) implies \( i = j \). Therefore, the edges \( e_1, \ldots, e_n \) are distinct.

  \ImplicationSubProof{def:graph_cycle/direct}{def:graph_cycle/degree} Suppose that \( n > 0 \) and that \( e_1, \ldots, e_n \) and \( v_1, \ldots, v_n \) are distinct.

  \begin{itemize}
    \item For every \( k = 0, \ldots, n - 1 \), the vertex \( v_k \) has out-degree \( 1 \) in the induced sub`graph because only the \( e_{k+1} \) starts at \( v_k \).

    \item For every \( k = 1, \ldots, n \), the vertex \( v_k \) has in-degree \( 1 \) because only the \( e_k \) ends at \( v_k \).
  \end{itemize}

  Thus, the degree of every vertex \( v_k \), where \( 0 < k < n \), is \( 2 \). Since \( v_0 = v_k \), however, its degree is also \( 2 \).

  \ImplicationSubProof{def:graph_cycle/degree}{def:graph_cycle/simplified} Suppose that, in the induced subgraph of the walk, \( \deg(v_k) = 2 \) for \( k = 1, \ldots, n \).

  Since in a empty walk the vertex has zero degree, we conclude that the path is not trivial --- that is, we hae \( n > 0 \).

  \SubProof*{Proof for directed (multi)graphs} Via induction on \( k = 1, \ldots, n \), will show that the vertices \( v_1, \ldots, v_k \) are all distinct.

  The base case \( k = 1 \) is vacuous. Suppose that \( v_1, \ldots, v_k \) and \( e_1, \ldots, e_k \) for some \( k < n \) are distinct and consider \( v_{k+1} \) and \( e_{k+1} \).

  If we suppose that \( e_{k+1} \) occurs among \( e_1, \ldots, e_k \), say \( e_{k+1} = e_i \) for some \( i \leq k \), then \( v_{i - 1} = v_k \), which is a contradiction. Therefore, the arcs \( e_1, \ldots, e_{k+1} \) are all distinct.

  Again aiming at a contradiction, suppose that \( e_i = e_{k+1} \) for some \( i \leq k \).
  \begin{itemize}
    \item If \( e_i = e_{k+1} \), then \( v_{i-1} = v_k \), which contradicts the inductive hypothesis.
    \item Otherwise, \( e_i \) and \( e_{k+1} \) both end at \( v_{k+1} \), hence the in-degree of \( v_{k+1} \) in the induced subgraph is at least \( 2 \).
    \begin{itemize}
      \item If \( k + 1 = n \), then \( v_{k+1} = v_n = v_0 \), hence \( e_1 \) starts at \( v_{k+1} \) and the out-degree of \( v_{k+1} \) is at least \( 1 \).
      \item Otherwise, if \( k + 1 < n \), then the out-degree is again at least \( 1 \) because of \( e_{k+2} \).
    \end{itemize}

    In both cases, the total degree of \( v_{k+1} \) (in the induced subgraph) is at least \( 3 \). This contradicts out initial assumption that the degree is exactly \( 2 \).
  \end{itemize}

  The obtained contradictions show that the vertices \( v_1, \ldots, v_{k+1} \) must be distinct.

  We have proved the inductive step. Thus, it remains for \( v_1, \ldots, v_n \) to all be distinct.

  \SubProof*{Proof for undirected (multi)graphs if \( n = 1 \)} If there is only one edge, its only vertex is vacuously the unique in the walk.

  \SubProof*{Proof for undirected (multi)graphs if \( n = 2 \)} In this case \( v_0 = v_2 \) and \( v_1 = v_1 \), thus the endpoints of \( e_1 \) and \( e_2 \) coincide.

  If \( e_1 = e_2 \), then \( \deg(v_0) = \deg(v_1) = 1 \), which contradicts the assumption that the degree of all vertices is \( 2 \). It remains for \( e_1 \) and \( e_2 \) to be parallel but not equal.

  \SubProof*{Proof for undirected (multi)graphs if \( n > 2 \)} In this case we proceed analogously to the directed case.
\end{defproof}

\begin{remark}\label{rem:graph_cycle_terminology}
  Similarly to \fullref{rem:graph_cycle_terminology}, we list how different authors use the term \enquote{cycle} and the related term \enquote{circuit} differently.

  \begin{thmenum}
    \thmitem{rem:graph_cycle_terminology/circuit} The term \enquote{circuit} is used by
    \begin{itemize}
      \item \incite[5]{Bollobas1998Graphs} for closed walks with no repeated arcs.

      \item \incite[13]{GondranMinoux1984Graphs} for what we call closed nonempty walks.

      \item \incite[def. 10.4.1]{Rosen2019DiscreteMathematics} for closed walks in undirected (multi)graphs.

      \item \incite[def. 1.1.3]{Knauer2019AlgGraphTheory} and \incite[279]{БелоусовТкачёв2004ДискретнаяМатематика} (as \enquote{контур}) for nonempty closed walks where only the endpoints may repeat, but only for simple directed graphs.

      \item \incite[11]{Мирчев2001Графи} (as \enquote{контур}) for closed nonempty generalized walks.
    \end{itemize}

    \thmitem{rem:graph_cycle_terminology/cycle} The term \enquote{cycle} is used by
    \begin{itemize}
      \item \incite[279]{БелоусовТкачёв2004ДискретнаяМатематика} (as \enquote{цикл}) for \fullref{def:graph_cycle/direct}.

      \item \incite[22]{ЕмеличевИПр1990Графы} (as \enquote{цикл}) and \incite[\S 7.2.3]{Новиков2013ДискретнаяМатематика} (as \enquote{цикл}) for closed walks with no repeated arcs, which generalizes our usage.

      \item \incite[11]{Мирчев2001Графи} (as \enquote{цикъл}) for closed directed walks, which generalizes our usage in the case of directed graphs.

      \item \incite[example 10.2.6]{Rosen2019DiscreteMathematics} for (undirected) cycle graphs as defined in \fullref{def:cycle_graph}, and in \cite[def. 10.4.2]{Rosen2019DiscreteMathematics} for closed directed walks.

      \item \incite[191]{Erickson2019Algorithms} for closed walks that \enquote{enter and leave each vertex at most once}. This coincides with our usage.

      \item \incite[13]{Harary1969Graphs}, \incite[8]{Diestel2017Graphs}, \incite[5]{Bollobas1998Graphs} and \incite[377]{Knuth1997ArtVol1} for graphs constructed from a path with its head connecting to its tail, with at least three vertices. This coincides with our usage for simple directed graphs.

      \item \incite[13]{GondranMinoux1984Graphs} for closed nonempty generalized walks where consecutive arcs are distinct. The condition for consecutive arcs prevents the pathological case \fullref{ex:def:graph_cycle/pathological}, thus their definition generalizes ours.

      \item \incite[def. 1.1.3]{Knauer2019AlgGraphTheory} for closed nonempty directed walks.
    \end{itemize}
  \end{thmenum}
\end{remark}

\begin{example}\label{ex:def:graph_cycle}
  We list some examples of \hyperref[def:graph_cycle]{graph cycles}:
  \begin{thmenum}
    \thmitem{ex:def:graph_cycle/trivial} We require cycles to be nontrivial, hence \hyperref[def:graph_walk/empty]{empty walk} at a vertex is not a cycle. This would prevent any graph from possibly being \hyperref[def:acyclic_graph]{acyclic}.

    Trivial graphs are paths, however. This also turns out useful --- see \fullref{alg:cycle_removal}.

    \thmitem{ex:def:graph_cycle/pathological} The additional requirement in \fullref{def:graph_cycle/simplified} rules out the pathological cycle \( a \reloset e \to b \reloset e \to a \), which would prevent undirected graphs from possibly being \hyperref[def:acyclic_graph]{acyclic}.

    As it turns out, this is the only case preventing a simpler definition of cycles.

    \thmitem{ex:def:graph_cycle/loop} By definition, every loop is a cycle. Trivial paths, however, are not.

    \thmitem{ex:def:graph_cycle/eight} Consider the graph
    \begin{equation}\label{eq:ex:def:graph_cycle/eight}
      \begin{aligned}
        \includegraphics[page=1]{output/ex__def__graph_cycle}
      \end{aligned}
    \end{equation}

    The closed walk
    \begin{equation}\label{eq:ex:def:graph_cycle/walk}
      a \to b \to c \to d \to e \to c \to a
    \end{equation}
    is not a cycle because \( c \) occurs twice. However,
    \begin{equation*}
      c \to d \to e \to c
    \end{equation*}
    is a cycle, and contracting it to \( c \) in \eqref{eq:ex:def:graph_cycle/walk} results in another cycle:
    \begin{equation*}
      a \to b \to c \to a
    \end{equation*}
  \end{thmenum}
\end{example}

\begin{algorithm}[Cycle removal]\label{alg:cycle_removal}
  Fix a \hyperref[def:hypergraph/multigraph]{directed multigraph} and consider the following walk:
  \begin{equation}\label{eq:alg:cycle_removal/src}
    v_0 \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots \reloset {e_{n-1}} \to v_{n-1} \reloset {e_n} \to v_n.
  \end{equation}

  We will build a \hyperref[def:subsequence]{subsequence} \( i_1, \ldots, i_m \) of \( 1, \ldots, n \) such that \( v_{i_m} = v_n \) and
  \begin{equation}\label{eq:alg:cycle_removal/dest}
    v_0 \reloset {e_{i_1}} \to v_{i_1} \reloset {e_{i_2}} \to \cdots \reloset {e_{i_{m-1}}} \to v_{i_{m-1}} \reloset {e_{i_m}} \to v_{i_m}
  \end{equation}
  is a \hyperref[def:graph_walk/path]{path}.

  \begin{thmenum}
    \thmitem{alg:cycle_removal/start} We start with \( k = 0 \) and the empty walk at \( v_0 \).

    \thmitem{alg:cycle_removal/step} At step \( k \), we have the path
    \begin{equation}\label{eq:alg:cycle_removal/step}
      v_0 \reloset {e_{i_1}} \to v_{i_1} \reloset {e_{i_2}} \to \cdots \reloset {e_{i_{k-1}}} \to v_{i_{k-1}} \reloset {e_{i_k}} \to v_{i_k}.
    \end{equation}

    \begin{thmenum}
      \thmitem{alg:cycle_removal/step/yield} If \( v_{i_k} = v_n \), yield \eqref{eq:alg:cycle_removal/step}.

      \thmitem{alg:cycle_removal/step/repeat} Otherwise, let \( i_{k+1} \) be the index of the last occurrence of \( v_{i_k + 1} \).
    \end{thmenum}
  \end{thmenum}
\end{algorithm}
\begin{comments}
  \item This algorithm can be found as \identifier{graphs.cycle.remove_cycles} in \cite{notebook:code}.
\end{comments}

\begin{proposition}\label{thm:path_iff_walk}
  In any \hyperref[def:hypergraph/multigraph]{directed multigraph}, there exists a \hyperref[def:graph_walk/directed]{directed walk} between two vertices if and only if there exists a \hyperref[def:graph_walk/path]{path} between them.
\end{proposition}
\begin{proof}
  \SufficiencySubProof Given any walk, \fullref{alg:cycle_removal} allows us to extract from it a path between the same vertices.
  \NecessitySubProof Special case.
\end{proof}

\begin{algorithm}[Closed walk to cycle]\label{alg:closed_walk_to_cycle}
  Fix a \hyperref[def:hypergraph/multigraph]{directed multigraph} and consider the \hi{nontrivial} \hyperref[def:graph_walk/closed]{closed} walk
  \begin{equation}\label{eq:alg:closed_walk_to_cycle/src}
    v_0 \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots \reloset {e_{n-1}} \to v_{n-1} \reloset {e_n} \to v_n.
  \end{equation}

  We can use \fullref{alg:cycle_removal} on the subwalk
  \begin{equation*}
    v_1 \reloset {e_2} \to \cdots \reloset {e_{n-1}} \to v_{n-1} \reloset {e_n} \to v_n
  \end{equation*}
  to obtain a \hyperref[def:graph_walk/path]{path}
  \begin{equation*}
    v_1 \reloset {e_{i_1}} \to v_{i_1} \reloset {e_{i_2}} \to \cdots \reloset {e_{i_{m-1}}} \to v_{i_{m-1}} \reloset {e_{i_m}} \to v_{i_m}.
  \end{equation*}

  Then
  \begin{equation}\label{eq:alg:closed_walk_to_cycle/dest}
    v_0 \reloset {e_1} \to v_1 \reloset {e_{i_1}} \to v_{i_1} \reloset {e_{i_2}} \to \cdots \reloset {e_{i_{m-1}}} \to v_{i_{m-1}} \reloset {e_{i_m}} \to v_{i_m}
  \end{equation}
  is a \hyperref[def:graph_cycle]{cycle}.
\end{algorithm}

\paragraph{Acyclic graphs}

\begin{definition}\label{def:acyclic_graph}
  We say that an \hyperref[rem:arbitrary_kind_graph]{arbitrary-kind graph} is \term[bg=ацикличен (ориентиран граф) (\cite[14]{Мирчев2001Графи}), ru=ацикличный (неориентированный граф); безконтурный (ориентированный граф) (\cite[280]{БелоусовТкачёв2004ДискретнаяМатематика})]{acyclic} if it satisfies any of the following equivalent properties:
  \begin{thmenum}
    \thmitem{def:acyclic_graph/cycles}\mcite[32]{Harary1969Graphs} It has no \hyperref[def:graph_cycle]{cycles}.
    \thmitem{def:acyclic_graph/closed_walks} It has no nontrivial closed walks.
    \thmitem{def:acyclic_graph/walks} Every walk is a path.
  \end{thmenum}
\end{definition}
\begin{comments}
  \item Every acyclic graph is a union of \hyperref[def:tree]{trees}, for which reason acyclic graphs are also called \enquote{forests}. This usage is mentioned by \incite[13]{Diestel2017Graphs}, \incite[32]{Harary1969Graphs}, \incite[21]{Bollobas1998Graphs}, \incite[def. 1.3.5.]{Knauer2019AlgGraphTheory}, \incite[782]{Rosen2019DiscreteMathematics}, \incite[191]{Erickson2019Algorithms}, \incite[53]{ЕмеличевИПр1990Графы} (as \enquote{лес}), \incite[\S 9.1.1]{Новиков2013ДискретнаяМатематика} (as \enquote{лес}) and \incite[21]{Мирчев2001Графи} (as \enquote{гора}).

  \item Another characterization in the case of finite graphs is given in \fullref{thm:acyclic_graph_walk_length}.
\end{comments}
\begin{defproof}
  \ImplicationSubProof{def:acyclic_graph/cycles}{def:acyclic_graph/closed_walks} Suppose that \( G \) has no cycles. If \( G \) has a nontrivial closed walk, we obtain a cycle via \fullref{alg:closed_walk_to_cycle}, which is a contradiction. Hence, \( G \) has no nontrivial closed walks.

  \ImplicationSubProof{def:acyclic_graph/closed_walks}{def:acyclic_graph/walks} Suppose that \( G \) has no nontrivial closed walks.

  Consider an arbitrary walk
  \begin{equation}\label{eq:def:acyclic_graph/closed_walks/proof}
    v_0 \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots
  \end{equation}

  If it is not a path, there exist indices \( i < j \) such that \( v_i = v_j \). But then
  \begin{equation*}
    v_i \reloset {e_{i+1}} \to v_{i+1} \reloset {e_{i+2}} \to \cdots \reloset {e_{j-1}} \to v_{j-1} \reloset {e_j} \to v_j
  \end{equation*}
  is a nontrivial closed walk, which cannot exist by our initial assumption.

  Therefore, \eqref{eq:def:acyclic_graph/closed_walks/proof} is a path.

  \ImplicationSubProof{def:acyclic_graph/walks}{def:acyclic_graph/cycles} Suppose that every walk in \( G \) is a path. Then no cycle can exist in \( G \) because its endpoints would coincide, making it a non-path walk.
\end{defproof}

\begin{example}\label{ex:def:acyclic_graph}
  We list some examples of \hyperref[def:acyclic_graph]{acyclic graphs}:
  \begin{thmenum}
    \thmitem{ex:def:acyclic_graph/edgeless} A graph without arcs/edges is vacuously acyclic.

    \thmitem{ex:def:acyclic_graph/tree} Trees, discussed in \fullref{subsec:trees}, are by definition acyclic.

    \thmitem{ex:def:acyclic_graph/cycle_graph} \hyperref[def:cycle_graph]{Cycle graphs}, discussed in \fullref{subsec:simple_undirected_graphs}, are not acyclic, as their name suggests.

    \thmitem{ex:def:acyclic_graph/forgetful} Consider the directed graph
    \begin{equation}\label{eq:ex:def:acyclic_graph/forgetful}
      \begin{aligned}
        \includegraphics[page=1]{output/ex__def__acyclic_graph}
      \end{aligned}
    \end{equation}

    It is clearly acyclic, however its \hyperref[def:graph_functors/simple_forgetful]{underlying undirected graph} is not acyclic --- in fact, it is isomorphic to the cycle graph \( C_3 \).
  \end{thmenum}
\end{example}

\begin{proposition}\label{thm:acyclic_graph_walk_length}
  If the \hyperref[def:graph_walk]{walk} \hyperref[def:graph_walk/length]{lengths} of a graph are bounded, the graph is acyclic.

  Conversely, if a graph of \hi{finite} order \( n \) is \hyperref[def:acyclic_graph]{acyclic}, it has no \hyperref[def:graph_walk]{walk} of length \( n \) or more.
\end{proposition}
\begin{proof}
  \SufficiencySubProof Fix a graph \( G \) and an upper bound \( m \) on the walk lengths of \( G \).

  Given any cycle of length \( l \), we can concatenate it with itself \( \quot(m, l) + 1 \) times to obtain a path of length
  \begin{equation*}
    l \cdot \quot(m, l) + l > l \cdot \quot(m, l) + \rem(m, l) = m.
  \end{equation*}

  Then \( G \) cannot have cycles.

  \NecessitySubProof Conversely, suppose that the acyclic graph \( G \) has order \( n \). In a walk of length \( m \geq n \), there are \( m + 1 \) vertices, hence, by \fullref{thm:pigeonhole_principle/simple}, at least one vertex must repeat. As per \fullref{def:acyclic_graph/walks}, every walk in \( G \) is a path, hence no walk can have repeated vertices.

  Therefore, no walk of length \( m \geq n \) exists in \( G \).
\end{proof}

\begin{proposition}\label{thm:acyclic_undirected_graph_orientation}
  Any \hyperref[def:multigraph_orientation]{orientation} of an \hyperref[def:acyclic_graph]{acyclic} \hyperref[def:hypergraph/multigraph]{undirected multigraph} is also \hyperref[def:acyclic_graph]{acyclic}.
\end{proposition}
\begin{comments}
  \item The converse is not true --- consider see \fullref{ex:def:acyclic_graph/forgetful}
\end{comments}
\begin{proof}
  Let \( G \) be an acyclic undirected (multi)graph and let \( D \) be an orientation of \( G \). Every generalized walk in \( D \) is an undirected walk in \( G \), in particular every cycle in \( D \) is a cycle in \( G \). Therefore, \( D \) cannot have cycles because \( G \) does not.
\end{proof}

\begin{proposition}\label{thm:acyclic_directed_multigraph}
  An \hyperref[def:acyclic_graph]{acyclic} \hyperref[def:directed_multigraph]{directed multigraph} has no \hyperref[def:directed_multigraph/loop]{loops} or \hyperref[def:directed_multigraph/parallel]{oppositely directed arcs} (but may have \hyperref[def:directed_multigraph/parallel]{parallel arcs}).
\end{proposition}
\begin{proof}
  A loops is by itself a cycle. Traversing two oppositely directed arcs also creates a cycle.
\end{proof}

\begin{proposition}\label{thm:acyclic_undirected_multigraph}
  An \hyperref[def:acyclic_graph]{acyclic} \hyperref[def:hypergraph/multigraph]{undirected multigraph} is \hyperref[def:undirected_graph]{simple}, that is, has no \hyperref[def:hypergraph/loop]{loops} or \hyperref[def:hypergraph/parallel]{parallel edges}.
\end{proposition}
\begin{proof}
  Follows from \fullref{thm:acyclic_undirected_multigraph}.
\end{proof}

\begin{proposition}\label{thm:acyclic_graph_paths}
  In an \hyperref[def:acyclic_graph]{acyclic} \hyperref[def:hypergraph/multigraph]{undirected multigraph}, there exists at most one \hyperref[def:graph_walk/path]{path} between any two vertices.
\end{proposition}
\begin{proof}
  Fix two distinct vertices \( u \) and \( v \) in an undirected acyclic (multi)graph.

  If there are two paths from \( u \) to \( v \), we can concatenate the first with the reverse of the second to obtain a closed walk at \( u \). This contradicts our assumption that the graph is acyclic.

  Therefore, there is at most one path between \( u \) and \( v \).
\end{proof}

\paragraph{Well-founded graphs}

\begin{definition}\label{def:well_founded_graph}\mimprovised
  We say that a \hyperref[def:directed_multigraph]{directed multigraph} is \term{well-founded} if there exists no (generalized) walk of the form
  \begin{equation}
    \cdots \reloset {e_{n+1}} \to v_n \reloset {e_n} \to \cdots \reloset {e_1} \to v_1 \reloset {e_0} \to v_0,
  \end{equation}
  where \( e_k \) connects \( v_{k+1} \) to \( v_k \) for every \( k = 0, 1, 2, \ldots \).
\end{definition}

\begin{proposition}\label{thm:def:well_founded_graph}
  \hyperref[def:well_founded_graph]{Well-founded graphs} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:well_founded_graph/simple} A simple directed graph is well-founded in the sense of \fullref{def:well_founded_graph} if and only if it is well-founded as a \hyperref[def:binary_relation]{binary relation} in the sense of \fullref{def:well_founded_relation}.

    It is important here that simple graphs have no loops --- otherwise the two definitions would not coincide.

    \thmitem{thm:def:well_founded_graph/set} For every set \( A \) in the sense of \hyperref[def:zfc]{\logic{ZFC}}, the graph \( (A, {\in}) \) is well-founded.

    \thmitem{thm:def:well_founded_graph/acyclic} Every well-founded graph is acyclic.

    The graph \eqref{eq:ex:infinite_integer_graphs/negative} is acyclic but not well-founded.

    \thmitem{thm:def:well_founded_graph/finite_acyclic} Every finite acyclic simple directed graph is well-founded.
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:well_founded_graph/simple} Trivial.

  \SubProofOf{thm:def:well_founded_graph/set} The \hyperref[def:zfc/foundation]{axiom of foundation} via \fullref{thm:set_membership_is_well_founded} implies that the relation \( {\in} \) is \hyperref[def:well_founded_relation]{well-founded}; hence, for any set \( A \), the graph \( (A, {\in}) \) is well-founded

  \SubProofOf{thm:def:well_founded_graph/acyclic} Let \( G = (V, A) \) be a well-founded graph.

  From any cycle
  \begin{equation*}
    v_0 \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots \reloset {e_{n-1}} \to v_{n-1} \reloset {e_n} \to v_n
  \end{equation*}
  we can easily construct the (generalized) walk
  \begin{equation*}
    \cdots \reloset {e_n} \to v_n \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots \reloset {e_{n-1}} \to v_{n-1} \reloset {e_n} \to v_n \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots \reloset {e_{n-1}} \to v_{n-1} \reloset {e_n} \to v_n,
  \end{equation*}
  whose existence contradicts the assumption that \( G \) is well-founded.

  Therefore, \( G \) is acyclic.

  \SubProofOf{thm:def:well_founded_graph/finite_acyclic} Let \( G = (V, A) \) be a finite acyclic simple directed graph. Suppose that it is not well-founded.

  Then there exists an infinite generalized walk
  \begin{equation*}
    \cdots \reloset {e_2} \to v_2 \reloset {e_1} \to v_1 \reloset {e_0} \to v_0.
  \end{equation*}

  By \fullref{thm:pigeonhole_principle/simple}, since \( G \) is finite, there exists an index \( n \) such that \( v_0 = v_n \). Thus, the following walk is closed:
  \begin{equation*}
    v_0 \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots \reloset {e_{n-1}} \to v_{n-1} \reloset {e_n} \to v_n.
  \end{equation*}

  This contradicts our assumption that \( G \) is acyclic. Therefore, \( G \) must be well-founded.
\end{proof}

\paragraph{Graph connectedness}

\begin{definition}\label{def:graph_connectedness}\mcite[def. 1.2.1]{Knauer2019AlgGraphTheory}
  \hyperref[rem:arbitrary_kind_graph]{Graphs} have the following notions of connectedness:
  \begin{thmenum}
    \thmitem{def:graph_connectedness/strong} We say that a \hyperref[def:directed_multigraph]{directed multigraph} is \term[ru=сильно связаный (граф) (\cite[def. 5.2]{БелоусовТкачёв2004ДискретнаяМатематика})]{strongly connected} if there exists a \hyperref[def:graph_walk/directed]{directed walk} between every pair of distinct vertices.

    Due to \fullref{thm:path_iff_walk}, it is immaterial whether we consider walks or paths.

    \thmitem{def:graph_connectedness/weak} If there exists a \hyperref[def:graph_walk/generalized]{generalized walk} between every pair of distinct vertices, we say that the graph is \term[ru=слабо связный (граф) (\cite[def. 5.4]{БелоусовТкачёв2004ДискретнаяМатематика})]{weakly connected}.

    \thmitem{def:graph_connectedness/undirected} We say that an \hyperref[def:hypergraph/multigraph]{undirected multigraph} (or, more generally, a \hyperref[def:hypergraph]{hypergraph}) is \term[bg=свързан (граф) (\cite[13]{Мирчев2001Графи}), ru=свързный (граф) (\cite[285]{БелоусовТкачёв2004ДискретнаяМатематика})]{connected} if there exists a \hyperref[def:graph_walk/undirected]{walk} between every pair of distinct vertices.

    We say that an undirected multigraph is \term{disconnected} if it is not connected. We avoid similar concepts for directed graph because of possible ambiguity.
  \end{thmenum}
\end{definition}
\begin{comments}
  \item A strongly connected graph is necessarily weakly connected, hence it makes sense to skip the adjective \enquote{weakly} in this context.
\end{comments}

\begin{definition}\label{def:graph_connected_component}\mcite[def. 1.4.11]{Knauer2019AlgGraphTheory}
  A (weakly/strongly) \term[bg=компонента (\cite[15]{Мирчев2001Графи}), ru=компонента связности (\cite[286]{БелоусовТкачёв2004ДискретнаяМатематика})]{connected component} is a maximal subgraph that is (weakly/strongly) \hyperref[def:graph_connectedness]{connected}.
\end{definition}
\begin{comments}
  \item \incite[425]{БелоусовТкачёв2004ДискретнаяМатематика} use the term \enquote{bicomponent} (\enquote{бикомпонента}) for strongly connected components. This is unrelated to \hyperref[def:multipartite_graph]{bipartite graphs}, which \incite[\S 7.3.3]{Новиков2013ДискретнаяМатематика} calls \enquote{bigraph} (\enquote{биграф}). \incite[\S 8.5.2]{Новиков2013ДискретнаяМатематика} prefers the term \enquote{strongly connected component} (\enquote{компоненты сильной связи}) to \enquote{bicomponent}.

  \incite[27]{Harary1969Graphs} also uses the term \enquote{bigraph} for bipartite graphs, but avoids using \enquote{bicomponent}.
\end{comments}

\begin{proposition}\label{thm:connected_components_partition_graph}
  The (weak/strong) \hyperref[def:graph_connected_component]{connected components} of a \hyperref[rem:arbitrary_kind_graph]{graph} \hyperref[def:set_partition]{partition} its vertices.
\end{proposition}
\begin{proof}
  Trivial.
\end{proof}

\begin{proposition}\label{thm:connected_graph_cycle_removal}
  Fix a \hyperref[def:graph_connectedness/undirected]{connected} undirected multigraph \( G = (V, E, \mscrE) \). Suppose that \( G \) has a cycle
  \begin{equation*}
    v_0 \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots \reloset {e_{n-1}} \to v_{n-1} \reloset {e_n} \to v_n.
  \end{equation*}

  Then the subgraphs \( G_k' \coloneqq (V, E \setminus \set{ e_k }, \mscrE) \), where \( k = 1, \ldots, n \), are again connected.
\end{proposition}
\begin{proof}
  Fix two arbitrary vertices \( u \) and \( w \) in \( G \). Since \( G \) is connected, there exists some walk
  \begin{equation}\label{eq:thm:connected_graph_cycle_removal/proof/src}
    u = u_0 \reloset {f_1} \to u_1 \reloset {f_2} \to \cdots \reloset {f_{m-1}} \to u_{m-1} \reloset {f_m} \to u_m = w
  \end{equation}
  connecting them.

  Fix any \( k = 1, \ldots, n \). We will use induction on \( m \) to show that a walk from \( u \) to \( w \) exists in \( G_k' \).

  The case \( m = 0 \) is vacuous. Suppose that, whenever two vertices are connected in \( G \) by a walk of length less than \( m \), they are also connected in \( G_k' \). Consider the walk \eqref{eq:thm:connected_graph_cycle_removal/proof/src}, whose length is exactly \( m \).

  If \( f_m \neq e_k \), then \eqref{eq:thm:connected_graph_cycle_removal/proof/src} is itself a walk from \( u \) to \( w \) in \( G_k' \).

  Suppose that \( f_m = e_k \). By the inductive hypothesis, there is a walk from \( u = u_0 \) to \( u_{m-1} \) in \( G_k' \). It remains to append to it a walk from \( u_{m-1} \) to \( u_m = w \). We have the following possibilities:
  \begin{itemize}
    \item If \( u_{m-1} = v_{k-1} \), then \( w = v_k \) and we can append the walk
    \begin{equation*}
      u_{m-1} = v_{k-1} \reloset {e_{k-1}} \to v_{k-2} \reloset {e_{k-2}} \to \cdots \reloset {e_2} v_1 \reloset {e_1} \to v_0 \reloset {e_n} \to v_{n-1} \reloset {e_{n-1}} \to v_{n-2} \reloset {e_{n-2}} \to \cdots \reloset {e_{k+1}} \to v_k = u_m = w.
    \end{equation*}

    \begin{figure}[!ht]
      \begin{equation}\label{eq:fig:thm:connected_graph_cycle_removal}
        \begin{aligned}
          \includegraphics[page=1]{output/thm__connected_graph_cycle_removal}
        \end{aligned}
      \end{equation}
      \caption{A detour around the highlighted edge \( e_2 \) as in the proof of \fullref{thm:connected_graph_cycle_removal}}\label{fig:thm:connected_graph_cycle_removal}
    \end{figure}

    \item If \( u_{m-1} = v_k \), then \( w = v_{k-1} \) and we can append the walk
    \begin{equation*}
      u_{m-1} = v_k \reloset {e_{k+1}} \to v_{k+1} \reloset {e_{k+2}} \to \cdots \reloset {e_n} \to v_n \reloset {e_1} \to v_1 \reloset {e_2} \to v_2 \reloset {e_3} \to \cdots \reloset {e_{k-1}} \to v_{k-1} = u_m = w.
    \end{equation*}
  \end{itemize}
\end{proof}

\begin{definition}\label{def:graph_bridge}
  We say that an edge in an \hyperref[def:hypergraph/multigraph]{undirected multigraph} is a \term[bg=мост (\cite[134]{Мирчев2001Графи}, ru=мост \cite[\S 8.1.2]{Новиков2013ДискретнаяМатематика}]{bridge} if it satisfies any of the following equivalent definitions:
  \begin{thmenum}
    \thmitem{def:graph_bridge/components}\mcite[26]{Harary1969Graphs} After removing it from its \hyperref[def:graph_connected_component]{connected component}, it is no longer connected.

    \thmitem{def:graph_bridge/cycle} No \hyperref[def:graph_cycle]{cycle} contains it.
  \end{thmenum}
\end{definition}
\begin{comments}
  \item This concept is unrelated to the K\"onigsberg bridges problem discussed in \fullref{ex:konigsberg_bridges}.
\end{comments}
\begin{defproof}
  Fix an undirected multigraph \( G = (V, E, \mscrE) \) and an edge \( e \) of \( G \). Without loss of generality, suppose that \( G \) is connected --- otherwise we could consider the connected component of \( e \).

  Define \( G' \coloneqq (V, E \setminus \set{ e }, \mscrE) \).

  \ImplicationSubProof{def:graph_bridge/components}{def:graph_bridge/cycle} Suppose that \( G' \) is not connected. If \( e \) is contained in some cycle, by \fullref{thm:connected_graph_cycle_removal}, \( G' \) should be connected, hence \( e \) is not contained in a cycle.

  \ImplicationSubProof{def:graph_bridge/cycle}{def:graph_bridge/components} Suppose that no cycle contains \( e \). Let \( u \) and \( v \) be the endpoints of \( e \). If \( G' \) is connected, any path from \( u \) to \( v \) in \( G' \) can be extended into a cycle in \( G \) by adding \( e \). Therefore, \( G' \) cannot be connected.
\end{defproof}

\begin{proposition}\label{thm:acyclic_bridges}
  In an \hyperref[def:acyclic_graph]{acyclic} undirected multigraph, every edge is a \hyperref[def:graph_bridge]{bridge}.
\end{proposition}
\begin{proof}
  Trivial.
\end{proof}

\paragraph{Graph condensation}

\begin{remark}\label{rem:graph_condensation}
  In the weak partition of a graph discussed in \fullref{thm:connected_components_partition_graph}, there is no arc or edge between vertices in different connected components. The same holds for partitioning an undirected graph into components.

  The partition into strong components, however, can result in a graph that captures relationships between the different components. This leads to \fullref{def:directed_graph_condensation}.
\end{remark}

\begin{definition}\label{def:directed_graph_condensation}\mcite[example 1.6.6]{Knauer2019AlgGraphTheory}
  Let \( G = (V, A, h, t) \) be a \hyperref[def:directed_multigraph]{directed multigraph}.

  Define the equivalence relation
  \begin{equation*}
    v \sim w \T{if} v \T{is \hyperref[def:graph_walk/reachable]{reachable} from} w \T{and} w \T{is reachable from} v.
  \end{equation*}

  Consider the \hyperref[def:equivalence_relation/quotient]{quotient set} \( \widetilde{V} \coloneqq V / {\sim} \) of \hyperref[def:graph_connected_component]{strongly connected components}. Define the \hyperref[def:binary_relation]{binary relation} \( \widetilde{A} \) on \( \widetilde{V} \) as
  \begin{equation*}
    ([u], [v]) \in \widetilde{A} \T{if} v \T{is reachable from} w \T{but not vice versa.}
  \end{equation*}

  Irreflexive relations over sets can be regarded as \hyperref[def:directed_graph]{simple directed graphs}. Therefore, the pair \( \widetilde{G} \coloneqq (\widetilde{V}, \widetilde{A}) \) is a directed graph. We call it the \term[bg=кондензация (\cite[61]{Мирчев2001Графи}), ru=конденсация (\cite[\S 8.5.2]{Новиков2013ДискретнаяМатематика})]{condensation} of the directed multigraph \( G \).
\end{definition}
\begin{comments}
  \item Another term for condensations from Russian origin is \enquote{Herz's graph} (\enquote{граф Герца}). It is used by \incite[\S 8.5.2]{Новиков2013ДискретнаяМатематика}.
\end{comments}
\begin{defproof}
  The relationship is well-defined because if \( ([v_1], [w_1]) \in \widetilde{A} \), \( v_2 \in [v_1] \) and \( w_2 \in [w_1] \), then by the transitivity of reachability we have that \( w_2 \) is reachable from \( v_2 \) and thus \( ([v_2], [w_2]) \in \widetilde{A} \).
\end{defproof}

\begin{example}\label{ex:def:directed_graph_condensation}
  The \hyperref[def:directed_graph_condensation]{condensation} of the directed multigraph \eqref{eq:fig:def:directed_multigraph} is (isomorphic to) the graph itself. If we add the arc \( f \to a \) to \eqref{eq:fig:def:directed_multigraph}, the condensation would be an edgeless directed multigraph with a single vertex.

  We can instead add new arcs \( e_8 \) and \( e_9 \) to \eqref{eq:fig:def:directed_multigraph} to make the example more interesting:
  \begin{equation}\label{eq:ex:def:directed_graph_condensation/uncondensed}
    \begin{aligned}
      \includegraphics{output/ex__def__directed_graph_condensation__uncondensed}
    \end{aligned}
  \end{equation}

  Its condensation is
  \begin{equation}\label{eq:ex:def:directed_graph_condensation/condensed}
    \begin{aligned}
      \includegraphics{output/ex__def__directed_graph_condensation__condensed}
    \end{aligned}
  \end{equation}

  These are the \hyperref[def:graph_connectedness/strong]{strongly connected components} of \eqref{eq:ex:def:directed_graph_condensation/uncondensed}.
\end{example}

\begin{proposition}\label{thm:graph_condensation_is_acyclic_dag}
  The \hyperref[def:directed_graph_condensation]{condensation} of a \hyperref[def:directed_multigraph]{directed multigraph} is a \hyperref[def:directed_graph]{simple directed} \hyperref[def:acyclic_graph]{acyclic graph}.
\end{proposition}
\begin{proof}
  Let \( \widetilde{G} = (\widetilde{V}, \widetilde{E}) \) be the condensation of the directed multigraph \( G = (V, A, h, t) \). It is, by definition, a simple directed graph. It remains to show that it is acyclic.

  Aiming at a contradiction, suppose that there exists a cycle
  \begin{equation}\label{eq:thm:graph_condensation_is_acyclic_dag/cycle}
    [v_0] \to [v_1] \to \cdots \to [v_{n-1}] \to [v_n].
  \end{equation}

  Thus, there exists a path from \( v_0 \) to \( v_1 \), another path from \( v_1 \) to \( v_2 \), etc. We can \hyperref[def:graph_walk/concatenation]{concatenate} them to obtain a path from \( v_0 \) to \( v_n \).

  But since \eqref{eq:thm:graph_condensation_is_acyclic_dag/cycle} is a cycle, there also exists a path from \( v_n \) to \( v_0 \).

  Thus, the vertices \( v_0 \) and \( v_n \) are reachable from each other, implying that they should belong to the same strongly connected component. The obtained contradiction shows that \( \widetilde{G} \) should be acyclic.
\end{proof}

\paragraph{Eulerian walks}

\begin{definition}\label{def:eulerian_walk}\mcite[65]{Harary1969Graphs}
  We say that a \hyperref[def:graph_walk]{graph walk} is \term[bg=Ойлеров (цикъл) (\cite[110]{Мирчев2001Графи}), ru=Эйлеровый (маршрут) (\cite[192]{ЕмеличевИПр1990Графы})]{Eulerian} if each arc/edge in the graph occurs exactly once.
\end{definition}
\begin{comments}
  \item See \fullref{ex:konigsberg_bridges} for a broad discussion of the origin of this concept.
\end{comments}

\begin{theorem}[Euler's theorem for graphs]\label{thm:eulers_theorem_for_graphs}\mcite[\S 20]{Euler1741Bridges}
  Fix a nonempty \hyperref[def:graph_connectedness/undirected]{connected} \hyperref[def:hypergraph/multigraph]{undirected multigraph} \( G = (V, E, \mscrE) \) with finitely many edges.

  There exists an \hyperref[def:eulerian_walk]{Eulerian walk} from \( s \) to \( f \) if and only if all other vertices have even degree.

  Furthermore, either \( s = f \) coincide and they have an even common degree, or \( s \neq f \) and they both have odd degrees.
\end{theorem}
\begin{proof}
  \SufficiencySubProof We will prove by induction on the number of edges that if an Eulerian walk exists, then all vertices have even degree, except for the endpoints in case they are distinct.

  The base case with one edge is trivial. Suppose that the statement holds for all graphs with \( n \geq 1 \) edges. Let \( G \) be a graph with exactly \( n + 1 \) edges and consider the Eulerian walk
  \begin{equation}\label{eq:thm:eulers_theorem_for_graphs/proof/sufficiency/walk}
    v_0 \reloset {e_1} \to v_1 \reloset {e_2} \to \cdots \reloset {e_n} \to v_n \reloset {e_{n+1}} \to v_{n+1}.
  \end{equation}

  Consider the graph \( G' \coloneqq (V', E', \mscrE) \), where
  \begin{equation*}
    V' \coloneqq \begin{cases}
      V,                           &v_{n+1} \T{occurs among} v_0, \ldots, v_n, \\
      V \setminus \set{ v_{n+1} }, &\T{otherwise}
    \end{cases}
  \end{equation*}
  and
  \begin{equation*}
    E' \coloneqq E \setminus \set{ e_{n+1} }.
  \end{equation*}

  The graph \( G' \) is connected because \( v_0, \ldots, v_n \) can be reached from each other via segments of the walk \eqref{eq:thm:eulers_theorem_for_graphs/proof/sufficiency/walk}.

  Hence, the inductive hypothesis holds and \( \deg'(v_k) \) is even for \( k = 1, \ldots, n - 1 \), where \( \deg'(v_k) \) the degree of \( v_k \) in \( G' \).

  Note that, by construction,
  \begin{equation}\label{eq:thm:eulers_theorem_for_graphs/proof/sufficiency/deg}
    \deg(v_k) = \begin{cases}
      \deg'(v_k) + 2, &n \leq k \leq n + 1 \T{and} e_{n+1} \T{is a loop}, \\
      \deg'(v_k) + 1, &n \leq k \leq n + 1 \T{and} e_{n+1} \T{is not a loop}, \\
      \deg'(v_k),     &\T{otherwise.}
    \end{cases}
  \end{equation}

  Therefore, \( \deg(v_k) \) is even for \( k = 1, \ldots, n - 1 \).

  We have the following possibilities:
  \begin{itemize}
    \item If \( v_0 = v_n \), then \( \deg'(v_n) \) is even by the inductive hypothesis.
    \begin{itemize}
      \item If \( e_{n+1} \) is a loop, then \( v_0 = v_n = v_{n+1} \), and, by \eqref{eq:thm:eulers_theorem_for_graphs/proof/sufficiency/deg}, their common degree is even.

      \item Otherwise, \( \deg(v_0) = \deg(v_n) \) is odd. Since the degree of all other vertices are even, \fullref{thm:odd_degree_vertices} implies that \( \deg(v_{n+1}) \) must also be odd.
    \end{itemize}

    \item If \( v_0 \neq v_n \), then \( \deg(v_0) = \deg'(v_0) \) and \( \deg'(v_n) \) are odd by the inductive hypothesis.
    \begin{itemize}
      \item If \( e_{n+1} \) is a loop, then \( v_n = v_{n+1} \), and, by \eqref{eq:thm:eulers_theorem_for_graphs/proof/sufficiency/deg}, their common degree is odd.

      \item Otherwise, \( \deg(v_n) \) is even. Since \( \deg(v_0) \) is odd while \( \deg(v_k) \) is even for \( 1 \leq k \leq n \), \fullref{thm:odd_degree_vertices} implies that \( \deg(v_{n+1}) \) must also be odd.
    \end{itemize}
  \end{itemize}

  In all cases, we have obtained that \( \deg(v_k) \) is even when \( 1 \leq k \leq n \) and that either \( v_0 = v_{n+1} \), from which it follows that their common degree is even, or \( v_0 \neq v_{n+1} \), from which it follows that both \( \deg(v_0) \) and \( \deg(v_{n+1}) \) are odd.

  \NecessitySubProof We will prove by induction on the number of edges that if all vertices in a graph except possibly \( s \) and \( f \) have even degree, then there exists an Eulerian walk from \( s \) to \( f \), and that \( s = f \) if and only if \( s \) and \( f \) have even degrees.

  \SubProof*{Proof for one-edge graphs} If \( G \) has only one edge, it is by itself an Eulerian walk.

  If the edge is a loop, then \( G \) has only one vertex, and it has degree \( 2 \). Otherwise, its endpoints are distinct, and both vertices have degree \( 1 \).

  \SubProof*{Proof of inductive step without bridges} Suppose that the statement holds for all graphs with \( n \) edges, and let \( G \) be a graph with exactly \( n + 1 \) edges. Fix two vertices \( s \) and \( f \) and suppose that all others have even degree.

  For this sub-case, suppose that every edge incident to \( f \) is a \hyperref[def:graph_bridge]{bridge}.

  Let \( w \) be an arbitrary vertex adjacent to \( f \) and let \( e \) be an edge between them. We will first show that this choice is unique, that is, that \( f \) is incident to only one edge.

  After removing \( e \), \( G \) splits into two connected components. Let \( G' \) be the component containing \( w \) and \( G^\dprime \) --- the component containing \( f \). We will show that \( G^\dprime \) has no edges and no vertices except for \( f \).

  Denote by \( \deg'(v) \) the degree function in \( G' \) and by \( \deg^\dprime(v) \) --- in \( G^\dprime \). Since \( \deg(w) \) is even, necessarily \( \deg'(w) \) is odd. Since \( \deg(v) = \deg'(v) \) for all vertices in \( G' \) except \( w \), we conclude that \( \deg'(v) \) even except possibly for \( s \), in case \( s \) is in \( G' \) and is distinct from \( v_k \). \Fullref{thm:odd_degree_vertices} implies that \( G' \) must have at least two vertices of odd degree, hence \( s \) must belong to \( G' \), be distinct from \( v_k \) and have odd degree.

  Then \( s \) also has odd degree in \( G \), and so does \( f \).

  Therefore, every vertex in \( G^\dprime \) has even degree, and we can apply the inductive hypothesis to \( G^\dprime \) and obtain a closed Eulerian walk starting and ending at \( f \). This is also a closed walk in \( G \).

  Aiming at a contradiction, suppose that this walk is nontrivial. Then \fullref{alg:closed_walk_to_cycle} allows us to obtain a cycle at \( f \), which contains at least two non-bridge edges incident to \( f \). This contradicts our assumption that all edges incident to \( f \) are bridges.

  The obtained contradiction demonstrates that we have a trivial Eulerian walk in \( G^\dprime \), implying that \( G^\dprime \) has no edges.

  Therefore, \( e \) is the unique edge incident to \( f \), and thus \( G' \) is the graph
  \begin{equation*}
    (V \setminus \set{ f }, E \setminus \set{ e }, \mscrE).
  \end{equation*}

  We have already shown that \( s \) and \( w \) must have odd degrees in \( G' \), while all other vertices must have even degrees. Therefore, we can also apply the inductive hypothesis to \( G' \) to obtain an Eulerian walk from \( s \) to \( w \), and append \( e \) to obtain an Eulerian walk in \( G \).

  Furthermore, we have also shown that \( s \) and \( f \) and distinct and have odd degrees in \( G \).

  \SubProof*{Proof of inductive step with bridges} Again, suppose that the statement holds for all graphs with \( n \) edges, and let \( G \) be a graph with exactly \( n + 1 \) edges. Fix two vertices \( s \) and \( f \) and suppose that all others have even degree.

  It remains to consider the sub-case where there exists a vertex \( w \) and an edge \( e \) between \( w \) and \( f \) that is not a bridge. Define the graph
  \begin{equation*}
    G' \coloneqq (V, E \setminus \set{ e }, \mscrE).
  \end{equation*}

  It is clearly connected.

  Denote the degree of a vertex \( v \) in \( G' \) by \( \deg'(v) \). We have
  \begin{equation}\label{eq:thm:eulers_theorem_for_graphs/proof/necessity/deg}
    \deg'(v) = \begin{cases}
      \deg(v) - 2, &(v = w \T{or} v = f) \T{and} e \T{is a loop}, \\
      \deg(v) - 1, &(v = w \T{or} v = f) \T{and} e \T{is not a loop}, \\
      \deg(v),     &\T{otherwise.}
    \end{cases}
  \end{equation}

  Then \( \deg'(v) \) is necessarily even unless \( v \) is \( s \), \( v_k \), or \( v_{k+1} = f \). \Fullref{thm:odd_degree_vertices} implies that all three cannot simultaneously have odd degrees in \( G' \) --- either all vertices in \( G' \) can have even degrees, or all except for two.

  We can now apply the inductive hypothesis to \( G' \) to obtain an Eulerian walk in \( G' \) from \( s \) to \( w \) and append \( e \) to obtain an Eulerian walk in \( G \) from \( s \) to \( f \).

  It remains to show that \( s = f \) if and only if \( \deg(s) \) and \( \deg(f) \) are even.

  If \( s = f \), by \fullref{thm:odd_degree_vertices}, \( \deg(s) = \deg(f) \) must be even. Conversely, suppose that \( \deg(s) \) and \( \deg(f) \) are even.
  \begin{itemize}
    \item If \( e \) is a loop, then, by \eqref{eq:thm:eulers_theorem_for_graphs/proof/necessity/deg}, \( \deg'(f) = \deg(f) - 2 \) is even. The degree \( \deg'(s) \) is also even --- either because \( s = f \), or otherwise because \( \deg'(s) = \deg(s) \).

    Then, since both \( \deg'(w) \) and \( \deg'(s) \) are even, the inductive hypothesis implies that \( s = w \), hence also \( s = f \).

    \item If \( e \) is not a loop, \( w \) and \( f \) are distinct, and, by \eqref{eq:thm:eulers_theorem_for_graphs/proof/necessity/deg}, both \( \deg'(w) \) and \( \deg'(f) \) are odd.

    If \( s \neq f \), then a vertex other than \( s \) or \( w \) has odd degree in \( G' \), which contradicts the inductive hypothesis. Therefore, \( s = f \).
  \end{itemize}
\end{proof}
