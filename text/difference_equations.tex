\section{Difference equations}\label{sec:difference_equations}

\paragraph{Difference operators}

\begin{remark}\label{rem:finite_difference_literature}
  Difference operators are studied as approximations of univariate real functions. Given such a function \( f: \BbbR \to \BbbR \), we can form the finite difference \( \Delta = f(x + h) - f(x) \) with step \( h \), and the second difference becomes \( \Delta^2 = f(x + 2h) - 2f(x + h) + f(x) \). This is done in books dedicated to finite differences like \incite[3]{Jordan1950FiniteDifferences} and \incite[12]{Гельфонд1959ИсчислениеКонечныхРазностей}.

  Numeric method literature focuses on finding \( f \) based on a given sequence of values, thus on the case \( M = \BbbN \) and \( R = \BbbR \) by \incite[5]{LevyLessman1961FiniteDifferenceEquations}, \incite[65]{БахваловЖидковКобельков2015ЧисленныеМетоды} and \incite[21]{Боянов2008ЧислениМетоди}.

  When defining finite difference operators in \fullref{def:finite_difference_operator}, we follow and slightly generalize the definition of \incite[77]{Stanley2012EnumerativeCombinatoricsVol1}, treating \( \Delta \) as an abstract operator on \( \fun(\BbbZ, \BbbK) \), where \( \BbbK \) is a field of characteristic zero.
\end{remark}

\begin{definition}\label{def:finite_difference_operator}\mimprovised
  Let \( I \) be either the \hyperref[def:natural_numbers]{semiring \( \BbbN \) of natural numbers} or the \hyperref[def:integers]{ring \( \BbbZ \) of integers}, and let \( G \) be any \hyperref[def:abelian_group]{abelian group}. Consider the set \( \fun(I, G) \) of all functions between them --- its elements are either \hyperref[def:sequence]{infinite sequences} or \hyperref[def:doubly_infinite_sequence]{doubly infinite sequences}.

  We define the \term[bg=крайна разлика от ред \( k \) (\cite[21]{Боянов2008ЧислениМетоди}), ru=конечная разность (\cite[11]{Гельфонд1959ИсчислениеКонечныхРазностей}), en=finite difference (\cite[77]{Stanley2012EnumerativeCombinatoricsVol1})]{finite difference} operator \( \Delta \) on \( \fun(I, G) \) as
  \begin{equation}\label{eq:def:finite_difference_operator}
    \Delta f(n) \coloneqq f(n + 1) - f(n).
  \end{equation}

  It is then straightforward to define the \( k \)-th order difference operator \( \Delta^k \) by iterated composition.
\end{definition}
\begin{comments}
  \item We slightly generalize the definition by \incite[77]{Stanley2012EnumerativeCombinatoricsVol1} in order to reinterpret some \hyperref[def:recurrence_relation]{recurrence relations}. See \fullref{rem:finite_difference_literature} for more general remarks on the definition.
\end{comments}

\begin{definition}\label{def:shift_operator}\mimprovised
  Fix an \hyperref[con:additive_semigroup]{additive (semi)group} \( G \) and a set \( A \). For every element \( h \) of \( G \), we define the \term[ru=оператор сдвига (\cite[9]{Левитан1973ТеорияОператоровОбобщенногоСдвига}), en=shift operator (\cite{Stanley2012EnumerativeCombinatoricsVol1})]{shift} by \( h \) on functions from \( G \) to \( A \) as
  \begin{equation}\label{eq:def:shift_operator}
    S^h(f(x)) \coloneqq f(x + h).
  \end{equation}
\end{definition}
\begin{comments}
  \item If \( G \) is a \hyperref[def:semigroup]{monoid} (resp. \hyperref[def:group]{group}), then \( G \) is a \hyperref[def:monoid_action]{monoid action} (\hyperref[def:group_action]{group action}) of \( G \) on \( \fun(G, A) \).

  \item Boris Levitan has a monograph on shift operators, \cite{Левитан1973ТеорияОператоровОбобщенногоСдвига}, based on previous work by Jean Dieudonné. Although only shift operators on univariate real functions are considered in the book, it is suggested that a lot of the theory works for greater generality when \( G \) is a group. We simply generalize this further.

  \incite[12]{LevyLessman1961FiniteDifferenceEquations} provide a similar definition for functions on real numbers.
\end{comments}

\begin{definition}\label{def:sequence_shift_operator}
  Consider the \hyperref[def:shift_operator]{shift operator} \( S^n \) on \hyperref[def:doubly_infinite_sequence]{doubly infinite sequences} over some set \( A \). It is given by translating indices via \( i \mapsto i + n \), which is the \( n \)-th iterate of \( S^1 \).

  We denote \( S^1 \) by \( R \) and call it the \term[en=right shift operator (\cite[exerc. 7.26]{FabianEtAl2001FunctionalAnalysis}), ru=правый оператор сдвига (\cite[example 1.3.3]{Хелемский2014ФункциональныйАнализ})]{right shift operator}. We denote its inverse, \( S^{-1} \), by \( L \), and call it the \term[en=left shift operator (\cite[exerc. 7.26]{FabianEtAl2001FunctionalAnalysis}), ru=левый оператор сдвига (\cite[example 1.3.3]{Хелемский2014ФункциональныйАнализ})]{left shift operator}.

  It is straightforward to generalize left shift operators to \hyperref[def:sequence]{infinite sequences}, but right shifting is not obvious because it requires a choice for the prepended element. In case \( A \) is a ring, we define right shifts on infinite sequences by prepending a zero.
\end{definition}
\begin{comments}
  \item For doubly infinite sequences, \incite[77]{Stanley2012EnumerativeCombinatoricsVol1} uses a right shift operator in order to use \fullref{thm:binomial_theorem} on \hyperref[def:finite_difference_operator]{difference operators}. He denotes it by \( E \) and calls it simply a \enquote{shift operators} --- both conventions are unfortunately ambiguous for us.

  The usage for sequences is popular, but inconsistent across the literature, and serves mostly for illustrative examples.

  This is how \incite[exerc. 7.26]{FabianEtAl2001FunctionalAnalysis} define the \enquote{left shift operator} \( L \) and \enquote{right shift operator} in the \hyperref[def:lebesgue_space]{Lebesgue (sequence) space} \( l_2 \). \incite[example 1.3.3]{Хелемский2014ФункциональныйАнализ} uses the same terminology (\enquote{оператор сдвига} in Russian) in the case of \( l_p \), and denotes the operators by \( T_l \) and \( T_r \). \incite[exerc. 2.1.21]{FriedbergInselSpence2018LinearAlgebra} use the same terminology for general sequences over a field, but denotes them by \( T \) and \( U \).

  \incite[84]{Lang2002Algebra} denotes the right shift operator on integers by \( T \) and calls it \enquote{the} shift operator. \incite[347]{Rudin1987RealAndComplexAnalysis} denotes the right shift operator on complex numbers by \( S \) and also calls it \enquote{the} shift operator.

  \item Left and right shift operators are closely related to shifts of \hyperref[def:positional_number_system]{digit string}, defined in \fullref{def:digit_shift}.
\end{comments}

\begin{proposition}\label{thm:difference_operator_factorization}\mcite[77]{Stanley2012EnumerativeCombinatoricsVol1}
  For the \( k \)-th \hyperref[def:finite_difference_operator]{difference operator}, we have the following factorization:
  \begin{equation}\label{eq:thm:difference_operator_factorization}
    \Delta^k f(n) = \sum_{i=0}^k (-1)^{k-i} \cdot \binom k i \cdot f(n + i).
  \end{equation}
\end{proposition}
\begin{proof}
  In the \hyperref[def:endomorphism_semiring]{endomorphism ring} of \( \fun(\BbbZ, A) \), the operator \( (-\id) \) on \( \fun(\BbbZ, A) \) commutes with the \hyperref[def:sequence_shift_operator]{right shift operator} \( R \). Indeed,
  \begin{equation*}
    [R \bincirc (-\id)](f(n))
    =
    R(-f(n))
    =
    -f(n + 1)
    =
    [-\id](f(n + 1))
    =
    [(-\id) \bincirc R](f(n)).
  \end{equation*}

  Furthermore, we can express \( \Delta \) as \( R - \id \). Thus, \fullref{thm:binomial_theorem} gives us
  \begin{equation*}
    \Delta^k
    =
    (R - \id)^k
    =
    \sum_{i=0}^k \binom k i R^i (-\id)^{k-i}
    =
    \sum_{i=0}^k (-1)^{k-i} \binom k i R^i \id^{k-i}.
  \end{equation*}

  Then \eqref{eq:thm:difference_operator_factorization} follows directly.
\end{proof}

\begin{corollary}\label{thm:difference_operator_linearity}
  \hyperref[def:finite_difference_operator]{Difference operators} are \hyperref[def:linear_function]{linear}.
\end{corollary}
\begin{proof}
  Follows from \fullref{thm:difference_operator_factorization} since both shift operators and the identity are linear.
\end{proof}

\begin{proposition}\label{thm:successive_value_via_difference_operator}
  The \hyperref[def:sequence_shift_operator]{right shift operator} can be expressed via \hyperref[def:finite_difference_operator]{difference operators} as follows:
  \begin{equation}\label{eq:thm:successive_value_via_difference_operator}
    R^k f(n)
    =
    f(n + k)
    =
    \sum_{i=0}^k \binom k i \cdot \Delta^i f(n).
  \end{equation}
\end{proposition}
\begin{proof}
  Similarly to \fullref{thm:difference_operator_factorization}, we use \fullref{thm:binomial_theorem}:
  \begin{equation*}
    R^k
    =
    (\Delta + \id)^k
    =
    \sum_{i=0}^k \binom k i \Delta^i \id^{k-i}.
  \end{equation*}
\end{proof}

\paragraph{Difference equations}

\begin{definition}\label{def:difference_equation}\mimprovised
  A \term[ru=разностное уравнение (\cite[307]{Гельфонд1959ИсчислениеКонечныхРазностей})]{difference equation} of \term[ru=порядок (разностного уравнения) (\cite[307]{Гельфонд1959ИсчислениеКонечныхРазностей})]{order} \( k \) is an \hyperref[def:equation]{equation} whose \hyperref[con:indeterminate]{indeterminate} is an \hyperref[def:sequence]{infinite} or \hyperref[def:doubly_infinite_sequence]{doubly infinite sequence} and its first \( k \) \hyperref[def:finite_difference_operator]{finite differences}.

  More precisely, let \( I \) be either the \hyperref[def:natural_numbers]{semiring \( \BbbN \) of natural numbers} or the \hyperref[def:integers]{ring \( \BbbZ \) of integers}, and let \( G \) be an \hyperref[con:additive_semigroup]{additive (semi)groups}. As in \hyperref[def:dynamical_system]{dynamical systems}, we interpret the set \( I \) as time.

  This allows us to characterize a difference equation as
  \begin{equation}\label{eq:def:difference_equation}
    F(T, X_T, \Delta X_T, \ldots, \Delta^k X_T) = 0
  \end{equation}
  for some function \( F: I \times G^{k+1} \to G \). We can regard \( F \) as a \hyperref[con:expression]{metalinguistic expression} and \( I \) and \( X \) are indeterminates; we use the capital letter convention from \fullref{rem:conventions_for_indeterminates} to make the exposition more precise.

  \begin{thmenum}
    \thmitem{def:difference_equation/solution} We say that the sequence \( x: I \to G \) is a \term{solution} to the equation \eqref{eq:def:difference_equation} if, for any moment \( t \), we have
    \begin{equation*}
      F(t, x_t, \Delta x_t, \ldots, \Delta^k x_t) = 0.
    \end{equation*}

    \thmitem{def:difference_equation/initial} Since \eqref{eq:def:difference_equation} in general has multiple solutions, we may introduce supplementary constraints specifying the value of some of the indeterminate sequences at a fixed moment \( t_0 \). These constraints are themselves equations like
    \begin{equation*}
      \Delta^i X_{t_0} = \alpha_i.
    \end{equation*}

    We call \( t_0 \) an \term{initial moment} and \( \alpha_i \) --- an \term{initial value} for \( \Delta^i X_T \).

    If we are given at least one initial value for the same moment, we refer to \hyperref[def:equation/system]{system of equations} combined with \eqref{eq:def:difference_equation} as an \term{initial value problem}.

    \thmitem{def:difference_equation/autonomous} We say that the equation is \term{autonomous} if the function \( F \) does not depend on \( T \).
  \end{thmenum}
\end{definition}
\begin{comments}
  \item Our definition is a formalization of \cite[307]{Гельфонд1959ИсчислениеКонечныхРазностей}. A brief literature overview is given in \fullref{rem:recurrence_relations_and_difference_equations_literature_overview_literature_overview}.

  \item In practice, we try to rewrite the expression \( F \) so that \( \Delta^K X_T \) is on the left of the equation and everything else is on the right. See \fullref{ex:def:difference_equation} for examples.
\end{comments}

\begin{remark}\label{rem:recurrence_relations_and_difference_equations_literature_overview_literature_overview}
  Recurrence relations, which we define in \fullref{def:recurrence_relation}, and difference equations, which we define in \fullref{def:difference_equation} are often conflated in the literature. As \incite{Strogatz1994NonlinearDynamics} remarks,
  \begin{displayquote}
    These systems are known variously as difference equations, recursion relations, iterated maps, or simply maps.
  \end{displayquote}

  We show their equivalence in \fullref{thm:recurrence_relations_and_difference_equations}, but nonetheless treat them differently.

  Out of the authors we cite, what we call a different equation is only discussed by \incite[307]{Гельфонд1959ИсчислениеКонечныхРазностей}, who considers the equation
  \begin{equation*}
    F(x, f(x), \Delta f(x), \ldots, \Delta^n f(x)) = 0.
  \end{equation*}

  On the other hand,
  \begin{itemize}
    \item \incite[3]{LevyLessman1961FiniteDifferenceEquations} defines an \enquote{ordinary difference equation of the \( r \)-th order} as a \enquote{relation of the form}
    \begin{equation*}
      y_{n+r} = F(n, y_n, y_{n+1}, \ldots, y_{n+r-1}).
    \end{equation*}

    Later, in \cite[75]{LevyLessman1961FiniteDifferenceEquations}, after discussing \hyperref[def:finite_difference_operator]{finite differences}, they redefine a difference equation as \enquote{a relation between the differences of a function at one or more general values of the independent variable.}

    Our definition of recurrence relations closely resembles theirs.

    \item \incite[40]{EdelsteinKeshet2005MathematicalModelsInBiology} define a \enquote{nonlinear difference equation} as \enquote{any function of the form}
    \begin{equation*}
      x_{n+1} = f(x_n, x_{n-1}, \cdots).
    \end{equation*}

    \item \incite[395]{LidlNiederreiter1997FiniteFields} define a \enquote{linear recurrent sequence} in the \hyperref[def:finite_field]{finite field} \( \BbbF_q \) as a sequence satisfying
    \begin{equation*}
      x_{n+k} = a_{k-1} s_{n+k-1} + a_{k-2} s_{n+k-2} + \cdots + a_0 s_n + a \quad\T{for} n = 0, 1, 2, \ldots
    \end{equation*}

    We base our exposition of recurrences in finite fields in \fullref{sec:recurrence_relations} on their book, but also consider more general recurrent sequences, and emphasize the difference between recurrence relations and sequences satisfying them.

    \item \incite[21]{Юмагулов2015ДинамическиеСистемы} uses \enquote{рекуррентное уравнение} (\enquote{recurrent equation}) for the \hyperref[def:equation]{equation}
    \begin{equation*}
      x_{n+1} = f(x_n, x_{-1}, \ldots, x_{n-k}), \quad n = 0, 1, 2, \ldots
    \end{equation*}

    We also allow non-autonomous recurrences where \( f \) depends on \( n \).

    \item \incite[def. 2.4.4]{Rosen2019DiscreteMathematics} provides the following informal definition:
    \begin{displayquote}
      A recurrence relation for the sequence \( \seq{ x_n } \) is an equation that expresses \( a_n \) in terms of one or more of the previous terms of the sequence, namely, \( a_0, a_1, \ldots, a_{n-1} \), for all integers \( n \) with \( n \geq n_0 \), where \( n_0 \) is a nonnegative integer.
    \end{displayquote}
  \end{itemize}
\end{remark}

\begin{proposition}\label{thm:recurrence_relations_and_difference_equations}
  Using \fullref{thm:successive_value_via_difference_operator}, we can express every indeterminate in a \hyperref[def:recurrence_relation]{recurrence relation} via \hyperref[def:finite_difference_operator]{difference operators}, thus turning it into an \hyperref[def:equation/equivalent]{equivalent} \hyperref[def:difference_equation]{difference equation}.

  Conversely, using \fullref{thm:difference_operator_factorization}, we can express every finite difference in an difference equation via consecutive elements of the sequence. If the equation allows expressing the highest order difference \( \Delta^k x_t \) as a function of the lower-order differences, we obtain a recurrence relation.
\end{proposition}
\begin{comments}
  \item Initial value problems in the sense of \fullref{def:recurrence_relation/initial} correspond to initial value problems in the sense of \fullref{def:difference_equation/initial}.

  \item \Fullref{ex:def:difference_equation/fibonacci} demonstrates how a recurrence relation transforms into a difference equation. \Fullref{ex:def:difference_equation/no_solutions} shows how the converse may fail.
\end{comments}

\begin{example}\label{ex:def:difference_equation}
  We list examples of \hyperref[def:difference_equation]{difference equations}:
  \begin{thmenum}
    \thmitem{ex:def:difference_equation/system} \hyperref[rem:system_of_first_order_difference_equations]{Systems of first-order difference equations} are of particular interest.

    \thmitem{ex:def:difference_equation/arithmetic} The \hyperref[def:arithmetic_progression]{arithmetic progression}
    \begin{equation*}
      X_{T+1} = X_T + d
    \end{equation*}
    can be turned into a constant difference equation by subtracting \( X_T \):
    \begin{equation*}
      \Delta X_T = d.
    \end{equation*}

    \thmitem{ex:def:difference_equation/geometric} Similarly, the \hyperref[def:geometric_progression]{geometric progression}
    \begin{equation*}
      X_{T+1} = X_T q
    \end{equation*}
    can be turned into the difference equation
    \begin{equation*}
      \Delta X_T = (q - 1) X_T.
    \end{equation*}

    This equation is discussed in greater detail in \fullref{def:discrete_malthusian_model}.

    Multiples of \( 2^n \) are thus solutions to \( \Delta X_n = X_n \). This is the discrete analogue of the exponential function \( e^x \) solving the differential equation \( D f(x) = f(x) \).

    \thmitem{ex:def:difference_equation/fibonacci} A slightly more substantial example is the \hyperref[def:fibonacci_numbers]{Fibonacci sequence} initial value problem
    \begin{empheq}[left=\empheqlbrace]{align*}
      &X_{T+2} = X_{T+1} + X_T, \\
      &X_0 = 0, \\
      &X_1 = 1.
    \end{empheq}

    \Fullref{thm:successive_value_via_difference_operator} implies that
    \begin{equation*}
      X_{T+1} = X_T + \Delta X_T
    \end{equation*}
    and
    \begin{equation*}
      X_{T+2} = \sum_{i=0}^2 \binom 2 i \cdot \Delta^i X_T = X_T + 2 \Delta X_T + \Delta^2 X_T.
    \end{equation*}

    Thus, the Fibonacci recurrence becomes
    \begin{equation*}
      \Delta^2 X_T + 2 \Delta X_T + X_T = \Delta X_T + X_T
    \end{equation*}
    which simplifies to
    \begin{equation}\label{eq:ex:def:difference_equation/fibonacci}
      \Delta^2 X_T = -\Delta X_T + X_T.
    \end{equation}

    This is easily verified by noting that, by \fullref{thm:difference_operator_factorization},
    \begin{equation*}
      \Delta^2 X_T = X_{T+2} - 2X_{T+1} + X_T
    \end{equation*}
    and
    \begin{equation*}
      -\Delta X_T + X_T = -(X_{T+1} - X_T) + X_T = -X_{T+1} + 2X_T,
    \end{equation*}
    hence
    \begin{equation*}
      X_{T+2} - 2X_{T+1} + X_T = -X_{T+1} + 2X_T,
    \end{equation*}
    which simplifies to the initial recurrence
    \begin{equation*}
      X_{T+2} = X_{T+1} + X_T.
    \end{equation*}

    We can also verify the transformation via any triple from the Fibonacci sequence. For example, taking \( F_4 = 3, F_5 = 5 \) and \( F_6 = 8 \), we have
    \begin{equation*}
      \Delta^2 F_4 = F_6 - 2F_5 + F_4 = 8 - 10 + 3 = 1
    \end{equation*}
    and
    \begin{equation*}
      -\Delta F_4 + F_4 = -(F_5 - F_4) + F_4 = 2F_4 - F_5 = 1.
    \end{equation*}

    For the \hyperref[def:lucas_numbers]{Lucas numbers} \( L_4 = 7 \), \( L_5 = 11 \) and \( L_6 = 18 \), we have
    \begin{equation*}
      \Delta^2 L_4 = 3 = -\Delta L_4 + L_4.
    \end{equation*}

    \thmitem{ex:def:difference_equation/non_autonomous} Consider the non-autonomous difference equation
    \begin{equation*}
      \Delta X_T = T.
    \end{equation*}

    It corresponds to the non-autonomous recurrence relation
    \begin{equation*}
      X_{T+1} = X_T + T.
    \end{equation*}

    As shown in \fullref{ex:def:recurrence_relation/triangular_numbers}, the \hyperref[def:triangular_number/arithmetic]{triangular numbers} are a solution with initial value \( x_0 = 0 \).

    \thmitem{ex:def:difference_equation/no_solutions} Over the real numbers, consider the difference equation
    \begin{equation*}
      \Delta X_T \cdot X_T = 1.
    \end{equation*}

    Assuming that \( x_0 \) is nonzero, we have
    \begin{equation*}
      x_1 = x_0 + \frac 1 {x_0},
    \end{equation*}
    and \( x_1 \) is thus also nonzero. This generalizes to any moment \( t \): we have
    \begin{equation*}
      x_{t+1} = x_t + \frac 1 {x_t}.
    \end{equation*}

    Thus, the equation has a solution if and only if \( x_0 \) is nonzero. In this case it is expressible as a recurrence relation.

    Since every recurrence relation initial value problem has a solution, we conclude that no recurrence corresponds to this difference equation when \( x_0 = 0 \). This provides a counterexample for \fullref{thm:recurrence_relations_and_difference_equations}.
  \end{thmenum}
\end{example}

\paragraph{Systems of difference equations}

\begin{remark}\label{rem:system_of_first_order_difference_equations}
  There are two conversion procedures that justify studying only \hyperref[def:difference_equation/autonomous]{autonomous} \hyperref[def:difference_equation]{first-order difference equations}.

  First note that difference equations over the \hyperref[def:first_order_direct_product]{direct product} \( G = H^n \) are equivalent to \hyperref[def:equation/system]{systems} of \( n \) difference equations over \( H \).

  Indeed, given the function \( F: G \to G \), consider the difference equation
  \begin{equation}\label{eq:rem:system_of_first_order_difference_equations/single}
    \Delta X_T = F(X_T).
  \end{equation}

  In this case we can regard the \hyperref[con:indeterminate]{indeterminate} \( X \) as a tuple of \( n \) \hyperref[con:indeterminate]{indeterminates} \( X_1, \ldots, X_n \) representing sequences over \( H \).

  In this case, the single equation \eqref{eq:rem:system_of_first_order_difference_equations/single} can be rewritten as the system
  \begin{empheq}[left=\empheqlbrace]{equation}\label{eq:rem:system_of_first_order_difference_equations}
    \begin{aligned}
      \Delta X_{1,T} &= F_1(X_{1,T}, \ldots, X_{n,T}), \\
                     &\vdots \\
      \Delta X_{n,T} &= F_n(X_{1,T}, \ldots, X_{n,T}), \\
    \end{aligned}
  \end{empheq}
  where \( F_i: H^n \to H \) is the \( i \)-th \hyperref[def:projection_of_function]{projection} of \( F: H^n \to H^n \).

  \begin{itemize}
    \item \Fullref{thm:general_difference_equation_to_autonomous_system} demonstrates how, if \( H \) is a ring, a non-autonomous equation can be converted to an initial value problem of autonomous equations.

    \item \fullref{thm:conversion_to_first_order_difference_equation_system} shows how certain difference equation can be converted to a system of first-order equations.
  \end{itemize}
\end{remark}
\begin{comments}
  \item Systems of ordinary first-order \hi{differential} equations are often considered across the literature, for example in \cite[6]{Strogatz1994NonlinearDynamics} or \cite[ch. 3]{Юмагулов2015ДинамическиеСистемы}. We simply adapt the general form here.
\end{comments}

\begin{proposition}\label{thm:general_difference_equation_to_autonomous_system}
  The \hyperref[def:difference_equation/autonomous]{non-autonomous} \hyperref[def:difference_equation]{difference equation}
  \begin{equation}\label{eq:thm:general_difference_equation_to_autonomous/general}
    F(T, X_T, \Delta X_T, \ldots, \Delta^k X_T) = 0_R
  \end{equation}
  over the \hyperref[def:free_semimodule]{free module} \( R^n \) can be converted to an autonomous \hyperref[def:equation/system]{system} by introducing a new indeterminate, \( Y \), that ranges over sequences over the base ring \( R \):
  \begin{empheq}[left=\empheqlbrace]{equation}\label{eq:thm:general_difference_equation_to_autonomous/autonomous}
    \begin{aligned}
      F(Y_T, X_T, \Delta X_T, \ldots, \Delta^k X_T) &= 0_R, \\
                                         \Delta Y_T &= 1_R, \\
                                                Y_0 &= 0_R.
    \end{aligned}
  \end{empheq}

  Then the sequence \( \seq{ x_t }_{t \in I} \) over \( R^n \) solves the general equation \eqref{eq:thm:general_difference_equation_to_autonomous/general} if and only if the corresponding sequence \( \seq{ (x_t, t) }_{t \in I} \) solves the autonomous system \eqref{eq:thm:general_difference_equation_to_autonomous/autonomous}.
\end{proposition}
\begin{comments}
  \item We have restricted \( Y_T \) so that it coincides with (the embedding into \( R \)) of \( T \). This is simply a trick to ensure that the expression for \( F \) does not depend on the expression for \( T \).

  The conversion is useful for justifying studying only autonomous systems, but for computations like those in \fullref{ex:def:difference_equation}, it is useless.
\end{comments}
\begin{proof}
  It is sufficient to note that \( \Delta_t = 1 \) if and only if \( y_{t+1} = y_t + 1 \). We can use induction to show that \( y_t = y_0 + t \) for every moment \( t \).
\end{proof}

\begin{proposition}\label{thm:conversion_to_first_order_difference_equation_system}
  The \hyperref[def:difference_equation]{difference equation}
  \begin{equation}\label{eq:thm:conversion_to_first_order_difference_equation_system/single}
    \Delta^k X_T = F(X_T, \Delta X_T, \ldots, \Delta^{k-1} X_T) = 0
  \end{equation}
  can be converted into the \hyperref[rem:system_of_first_order_difference_equations]{system of first-order equations}
  \begin{empheq}[left=\empheqlbrace]{equation}\label{eq:thm:conversion_to_first_order_difference_equation_system/system}
    \begin{aligned}
      \Delta Y_{k,T}   &= F(Y_{1,T}, \ldots, Y_{k,T}), \\
      \Delta Y_{k-1,T} &= Y_{k,T}, \\
                       &\vdots \\
      \Delta Y_{2,T}   &= Y_{1,T}. \\
    \end{aligned}
  \end{empheq}

  Then the sequence \( x = \seq{ x_t }_{t \in I} \) solves the single equation \eqref{eq:thm:conversion_to_first_order_difference_equation_system/single} if and only if the sequences \( y_1, y_2, \ldots, y_k \), where \( y_{i,t} = \Delta^i x_t \), solve the system \eqref{eq:thm:conversion_to_first_order_difference_equation_system/system}.
\end{proposition}
\begin{proof}
  Trivial.
\end{proof}

\begin{proposition}\label{thm:autonomous_difference_equation_as_dynamical_system}
  Over the \hyperref[con:additive_semigroup]{additive (semi)group} \( G \), consider the \hyperref[def:difference_equation/autonomous]{autonomous} first-order \hyperref[def:difference_equation]{difference equation}
  \begin{equation*}
    \Delta X_T = F(X_T).
  \end{equation*}

  Let \( I \) be the \hyperref[def:integers]{ring \( \BbbZ \) of integers} if \( F \) is invertible, and the \hyperref[def:natural_numbers]{semiring \( \BbbN \) of natural numbers} otherwise.

  Define the function
  \begin{equation*}
    \begin{aligned}
      &\varphi: G \to G, \\
      &\varphi(x) \coloneqq x + F(x).
    \end{aligned}
  \end{equation*}

  Then \( \varphi \) is the \hyperref[def:one_step_evolution_function]{one-step evolution function} of a \hyperref[def:discrete_dynamical_system]{discrete-time} \hyperref[def:dynamical_system]{dynamical system} over \( G \) with time set \( I \).

  The \hyperref[def:dynamical_system_trajectory]{trajectories} of this system are precisely the solutions to the equation.
\end{proposition}
\begin{proof}
  Following \fullref{thm:recurrence_relations_and_difference_equations}, we can convert the initial value problem
  \begin{equation*}
    \Delta X_T = F(X_T)
  \end{equation*}
  to the \hyperref[def:equation/equivalent]{equivalent} \hyperref[def:recurrence_relation]{recurrence relation} initial value problem
  \begin{equation*}
    X_{T+1} = X_T + F(X_T).
  \end{equation*}

  \Fullref{thm:autonomous_recurrence_as_dynamical_system} implies that \( \varphi \) is the one-step evolution function a dynamical system over infinite sequences. The trajectories of the dynamical system obviously correspond to the solutions of the equation.

  For doubly infinite sequences, \( F \) must be invertible.
\end{proof}

\paragraph{Discrete Malthusian model}

\begin{remark}\label{rem:malthusian_growth}
  \enquote{Malthusian growth} refers to a family of related differential equations and \hyperref[def:recurrence_relation]{recurrence relations}, all based on the following statement by Thomas Malthus from his essays on population dynamics, \bycite[4]{Malthus1998PrinciplesOfPopulation}:
  \begin{displayquote}
    Population, when unchecked, increases in a geometrical ratio. Subsistence increases only in an arithmetical ratio. A slight acquaintance with numbers will shew the immensity of the first power in comparison of the second.
  \end{displayquote}

  We present in \fullref{def:discrete_malthusian_model} a \hyperref[def:difference_equation]{difference equation} and its equivalent recurrence relation, based on the formulation from \incite[15]{Юмагулов2015ДинамическиеСистемы}.

  \incite[117]{EdelsteinKeshet2005MathematicalModelsInBiology} present a related differential equation, which they call the \enquote{Malthus law}, with an approximation in terms of difference equations. \incite[19]{СамарскийМихайлов2005МатематическоеМоделирование} present a slightly more complicated differential equation, which they call a \enquote{Malthusian model}, in which the reproduction rate is the difference of a population growth and population decay time-dependent function.
\end{remark}

\begin{definition}\label{def:discrete_malthusian_model}\mcite[15]{Юмагулов2015ДинамическиеСистемы}
  Fix real numbers \( n_0 \geq 0 \) and \( \alpha \geq -1 \) and consider the following simple \hyperref[def:difference_equation]{difference equation} initial value problem:
  \begin{empheq}[left=\empheqlbrace]{equation}\label{eq:def:discrete_malthusian_model}
    \begin{aligned}
      \Delta N_T &= \alpha N_T, \\
             N_0 &= n_0.
    \end{aligned}
  \end{empheq}

  As discussed in \fullref{ex:def:difference_equation/geometric}, it corresponds to the \hyperref[def:geometric_progression]{geometric progression} \hyperref[def:recurrence_relation]{recurrence}
  \begin{empheq}[left=\empheqlbrace]{equation}\label{eq:def:discrete_malthusian_model/recurrence}
    \begin{aligned}
      N_{T+1} &= (\alpha + 1) N_T, \\
          N_0 &= n_0
    \end{aligned}
  \end{empheq}
  with explicit solution
  \begin{equation}\label{eq:def:discrete_malthusian_model/solution}
    n_t = n_0 \cdot (\alpha + 1)^t.
  \end{equation}

  We refer to either one as the \term[ru=дискретная модель Мальтуса (\cite[15]{Юмагулов2015ДинамическиеСистемы})]{discrete Malthusian model} with \term{initial population} \( n_0 \) and \term[en=rate of reproduction (\cite[117]{EdelsteinKeshet2005MathematicalModelsInBiology})]{reproduction rate} \( \alpha \).

  \begin{figure}[!ht]
    \begin{subcaptionblock}{\textwidth}
      \centering
      \includegraphics[page=1]{output/def__discrete_malthusian_model__rates}
      \caption{The initial population \( n_0 = 100 \) with several reproduction rates.}\label{fig:def:discrete_malthusian_model/rates}
    \end{subcaptionblock}
    \\[\baselineskip]
    \begin{subcaptionblock}{\textwidth}
      \centering
      \includegraphics[page=1]{output/def__discrete_malthusian_model__populations}
      \caption{The reproduction rate \( \alpha = 0.2 \) with several initial populations.}\label{fig:def:discrete_malthusian_model/population}
    \end{subcaptionblock}
    \caption{The evolution of the \hyperref[def:discrete_malthusian_model]{discrete Malthusian model} for different parameters.}\label{fig:def:discrete_malthusian_model}
  \end{figure}
\end{definition}
\begin{comments}
  \item The restrictions \( n_0 \geq 0 \) and \( \alpha \geq -1 \) ensure that the solution is a sequence of nonnegative real numbers. From a biological perspective, the population cannot be negative, and a negative reproduction rate cannot exceed the entire population.

  See \fullref{rem:malthusian_growth} for the general concept of Malthusian growth.

  \item Fix a fixed reproduction rate \( \alpha \), we regard the Malthusian model as an \hyperref[def:reversible_dynamical_system]{irreversible} \hyperref[def:discrete_dynamical_system]{discrete-time} \hyperref[def:dynamical_system]{dynamical system} that depends on the initial population \( n_0 \).
\end{comments}

\begin{proposition}\label{thm:discrete_malthusian_model_dynamics}
  As a \hyperref[def:dynamical_system]{dynamical system}, the \hyperref[def:discrete_malthusian_model]{discrete Malthusian model}
  \begin{equation*}
    n_t = n_0 \cdot (\alpha + 1)^t
  \end{equation*}
  with \( \alpha \geq -1 \) and \( n_0 \geq 0 \), has the following basic properties:
  \begin{thmenum}
    \thmitem{thm:discrete_malthusian_model_dynamics/zero_population} Every trajectory starting at \( n_0 = 0 \) is constant.

    \thmitem{thm:discrete_malthusian_model_dynamics/minus_one} When \( \alpha = -1 \), every nontrivial trajectory eventually reaches the \hyperref[def:dynamical_system_fixed_point]{fixed point} \( n_t = 0 \) at moment \( t = 1 \).

    \thmitem{thm:discrete_malthusian_model_dynamics/negative} When \( -1 < \alpha < 0 \), every nontrivial trajectory is strictly decreasing.

    \thmitem{thm:discrete_malthusian_model_dynamics/zero} When \( \alpha = 0 \), every trajectory is constant.

    \thmitem{thm:discrete_malthusian_model_dynamics/positive} When \( \alpha > 0 \), every nontrivial trajectory is strictly increasing.
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:discrete_malthusian_model_dynamics/minus_one} When \( \alpha = -1 \), we have \( (\alpha + 1)^t = 0 \) for \( t > 0 \), so \( n_t = 0 \) when \( t > 0 \).

  \SubProofOf{thm:discrete_malthusian_model_dynamics/negative} When \( -1 < \alpha < 0 \), then \( 0 < \alpha + 1 < 1 \), and \fullref{thm:def:power_function/monotone} implies that \( n_t \) is a strictly decreasing function of \( t \).

  \SubProofOf{thm:discrete_malthusian_model_dynamics/zero} When \( \alpha = 0 \), we have \( n_t = n_0 \cdot 1^t = n_0 \).

  \SubProofOf{thm:discrete_malthusian_model_dynamics/positive} When \( \alpha > 0 \), then \( \alpha + 1 > 1 \), and \fullref{thm:def:power_function/monotone} implies that \( n_t \) is a strictly increasing function of \( t \).
\end{proof}

\paragraph{Discrete logistic model}

\begin{definition}\label{def:logistic_map}\mimprovised
  For a fixed real number \( a \), we refer to the following function on real numbers as the \term[en=logistic map (\cite[22]{Müller2022HandbookOfDynamicsAndProbability})]{logistic map}:
  \begin{equation}\label{eq:def:logistic_map}
    f_a(x) \coloneqq a x (1 - x).
  \end{equation}
\end{definition}
\begin{comments}
  \item The logistic map should not be confused with the logistic function defined in \fullref{def:logistic_function}.

  \item \incite[22]{Müller2022HandbookOfDynamicsAndProbability} and \incite[43]{Elaydi2007DiscreteChaos} restrict the function to \( 0 \leq a \leq 4 \) and \( 0 \leq x \leq 1 \), so that, as shown in \fullref{thm:def:logistic_map/unit}, the unit interval is invariant.

  The \hyperref[def:discrete_dynamical_system]{discrete-time} \hyperref[def:dynamical_system]{dynamical system} whose \hyperref[def:one_step_evolution_function]{one-step evolution function} is \( f \) is studied by \incite{May1976DiscreteLogisticMap}.

  The term \enquote{logistic map} may refer to the dynamical system. Such usage can be found in \cite[353]{Strogatz1994NonlinearDynamics}.

  We discuss this dynamical system in \fullref{ex:def:logistic_map}.

  \item See \fullref{rem:logistic_model_etymology} for a discussion of the term \enquote{logistic}.
\end{comments}

\begin{remark}\label{rem:logistic_model_etymology}
  Jan Cramer describes the history of logistic regression and of the \hyperref[def:logistic_function]{logistic function} in his article \cite{Cramer2003OriginsOfLogisticRegression}. He attributes the adjective \enquote{logistic} to Pierre Fran\c{c}ois Verhulst:
  \begin{displayquote}
    Verhulst names it the logistic, without further explanation: in a neat diagram, the \textit{courbe logistique} is drawn alongside the \textit{courbe logarithmique}, which we would nowadays call the exponential.
  \end{displayquote}

  The discussion in \cite{HSMSE:logistic_growth_etymology} confirms that \enquote{logistic} with respect to population dynamics possibly refers to logarithmic growth, analogously to how Malthus discusses arithmetic and geometric growth (see \fullref{rem:malthusian_growth}), and that the word \enquote{logistics} has an unrelated origin.
\end{remark}

\begin{proposition}\label{thm:def:logistic_map}
  The \hyperref[def:logistic_map]{logistic map} \( f_a(x) = a x (1 - x) \) has the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:logistic_map/unit} If \( 0 \leq a \leq 4 \) and \( 0 \leq x \leq 1 \), then \( 0 \leq f_a(x) \leq 1 \).

    \begin{figure}[!ht]
      \centering
      \includegraphics[page=1]{output/thm__def__logistic_map__unit}
      \caption{Plot of the \hyperref[def:logistic_map]{logistic map} from \( x = 0 \) to \( x = 1 \) with \( a = 4 \).}\label{fig:thm:def:logistic_map/unit}
    \end{figure}
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:logistic_map/unit} The function \( f_a(x) = -ax^2 + ax \) has derivative
  \begin{equation*}
    f_a'(x) = -2ax + a,
  \end{equation*}
  which is zero when \( x = 1 / 2 \), positive for smaller values and negative for larger values.

  Thus, \( f(x) \) increases until \( x = 1 / 2 \), where it has value \( a / 4 \), and then decreases. We are interested when \( f(x) = 0 \), which happens at \( x = 0 \) and \( x = 1 \).

  Thus, when \( 0 \leq x \leq 1 \) and \( 0 \leq a \leq 4 \), \( f(x) \) is bounded between \( 0 \) and \( 1 \).
\end{proof}

\begin{definition}\label{def:orbit_diagram}\mimprovised
  Let \( \Phi_a: I \times U \to U \) be a \hyperref[def:dynamical_system]{dynamical system} depending on a real parameter \( a \) ranging over the interval \( A \). Suppose that \( I \) and \( U \) are also intervals of real numbers.

  We define the \term{orbit diagram} of \( \Phi \) at \( x_0 \) as the family of orbits of \( x_0 \) under different values of \( a \):
  \begin{equation}\label{eq:def:orbit_diagram}
    \set{ (a, \Phi_{a,t}(x_0)) \given a \in A \T{and} t \in I }.
  \end{equation}
\end{definition}
\begin{comments}
  \item We illustrate an orbit diagram in \fullref{ex:def:logistic_map/orbits}.

  \item Orbit diagrams are related to bifurcation diagrams. \incite[361]{Strogatz1994NonlinearDynamics} remarks
  \begin{displayquote}
    Bifurcation diagrams are different from orbit diagrams in that unstable objects are shown as well; orbit diagrams show only the attractors.
  \end{displayquote}

  Chip Ross has an article, \cite{Ross2004BifurcationAndOrbitDiagrams}, dedicated to disambiguation between orbit and bifurcation diagrams.

  Our definition is based on the two aforementioned sources.
\end{comments}

\begin{example}\label{ex:def:logistic_map}
  We list examples related to the \hyperref[def:logistic_map]{logistic map}:
  \begin{thmenum}
    \thmitem{ex:def:logistic_map/orbits} Consider the family of \hyperref[def:discrete_dynamical_system]{discrete-time} \hyperref[def:dynamical_system]{dynamical systems} with \hyperref[def:one_step_evolution_function]{one-step evolution functions}
    \begin{equation*}
      f_a(x) = a x (1 - x).
    \end{equation*}

    An \hyperref[def:orbit_diagram]{orbit diagram} of this family is illustrated in \cref{fig:ex:def:logistic_map/orbits}.

    \begin{figure}[!ht]
      \centering
      \includegraphics[page=1]{output/ex__def__logistic_map__orbits}
      \caption{An \hyperref[def:orbit_diagram]{orbit diagram} of the \hyperref[def:logistic_map]{logistic map} at \( x_0 = 0.5 \) between \( t = 100 \) and \( t = 600 \).}\label{fig:ex:def:logistic_map/orbits}
    \end{figure}
  \end{thmenum}
\end{example}

\begin{definition}\label{def:discrete_logistic_model}\mimprovised
  Fix real numbers \( -1 \leq \alpha \leq 3 \) and \( \beta > 0 \), as well as
  \begin{equation*}
    0 \leq n_0 \leq \frac {1 + \alpha} \beta.
  \end{equation*}

   Consider the following \hyperref[def:difference_equation]{difference equation} initial value problem:
  \begin{empheq}[left=\empheqlbrace]{equation}\label{eq:def:discrete_logistic_model}
    \begin{aligned}
      \Delta N_T &= (\alpha - \beta N_T) N_T, \\
             N_0 &= n_0.
    \end{aligned}
  \end{empheq}

  It corresponds to the \hyperref[def:recurrence_relation]{recurrence}
  \begin{empheq}[left=\empheqlbrace]{equation}\label{eq:def:discrete_logistic_model/recurrence}
    \begin{aligned}
      N_{T+1} &= (1 + \alpha - \beta N_T) N_T, \\
          N_0 &= n_0
    \end{aligned}
  \end{empheq}

  We refer to either as the \term[ru=дискретная логистическая модель (\cite[18]{Юмагулов2015ДинамическиеСистемы}), en=discrete logistic equation (\cite[45]{EdelsteinKeshet2005MathematicalModelsInBiology})]{discrete logistic model}.

  \begin{figure}[!ht]
    \centering
    \includegraphics[page=1]{output/def__discrete_logistic_model__populations}
    \caption{The evolution of the \hyperref[def:discrete_logistic_model]{discrete logistic model} for \( \alpha = 0.2 \), \( \beta = 0.002 \) and different initial populations.}\label{fig:def:discrete_logistic_model}
  \end{figure}
\end{definition}
\begin{comments}
  \item If \( X_T \coloneqq \beta / (1 + \alpha) N_T \), we have
  \begin{equation*}
    X_{T+1}
    =
    \frac \beta {1 + \alpha} N_{T+1}
    =
    \cancel{\frac \beta {1 + \alpha}} (1 + \alpha) (1 - X_T) \cancel{\frac {1 + \alpha} \beta} X_T
    =
    f_{1 + \alpha}(X_T),
  \end{equation*}
  where \( f_{1 + \alpha} \) is the corresponding \hyperref[def:logistic_map]{logistic map}.

  It follows from \fullref{thm:def:logistic_map/unit} that the entire trajectory is bounded between \( 0 \) and \( (1 + \alpha) / \beta \).

  \item As in the discrete Malthusian model defined in \fullref{def:discrete_malthusian_model}, the conditions imposed on the parameters ensure that the solution is a sequence of nonnegative real numbers. If we allow \( \beta = 0 \), we obtain the Malthusian model.

  \item We base our exposition on \cite[18]{Юмагулов2015ДинамическиеСистемы} and \cite[45]{EdelsteinKeshet2005MathematicalModelsInBiology}, both of which only discuss the recurrence relation.

  The difference equation and its comparison differential equation are discussed in \cite{MathSE:discrete_vs_continuous_logistic_model}.

  \item See \fullref{rem:logistic_model_etymology} for a discussion of the term \enquote{logistic}.
\end{comments}

\begin{definition}\label{def:difference_equation_equilibrium_point}\mimprovised
  We say that a point is an \term[en=equilibrium points (\cite[15]{Elaydi2007DiscreteChaos})]{equilibrium point} of the autonomous first-order \hyperref[def:difference_equation]{difference equation}
  \begin{equation*}
    \Delta X_T = F(X_T)
  \end{equation*}
  if it is a \hyperref[def:zero_of_function]{zero} of \( F \).
\end{definition}
\begin{comments}
  \item As discussed in \fullref{rem:system_of_first_order_difference_equations}, the restriction to first-order equations is acceptable since we have procedures for converting more general systems of difference equations to a single vector-valued first-order equation.

  \item Our definition is a formalization of that given by \incite[15]{Elaydi2007DiscreteChaos}.
\end{comments}

\begin{proposition}\label{thm:difference_equation_fixed_points}
  The \hyperref[def:difference_equation_equilibrium_point]{equilibrium points} of an autonomous a first-order \hyperref[def:difference_equation]{difference equation} are precisely the \hyperref[def:dynamical_system_fixed_point]{fixed points} of the corresponding \hyperref[def:dynamical_system]{dynamical system} obtained via \fullref{thm:autonomous_difference_equation_as_dynamical_system}.
\end{proposition}
\begin{proof}
  Trivial.
\end{proof}

\begin{proposition}\label{thm:discrete_logistic_model_dynamics}
  As a \hyperref[def:dynamical_system]{dynamical system}, the \hyperref[def:discrete_logistic_model]{discrete logistic model}
  \begin{equation*}
    N_{T+1} = (1 + \alpha - \beta N_T) N_T
  \end{equation*}
  with \( -1 \leq \alpha \leq 3 \), \( \beta > 0 \) and phase space \( [0, (1 + \alpha) / \beta] \), has the following basic properties:
  \begin{thmenum}
    \thmitem{thm:discrete_logistic_model_dynamics/fixed} The \hyperref[def:dynamical_system_fixed_point]{fixed points} of the system are \( 0 \) and \( \alpha / \beta \).
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:discrete_logistic_model_dynamics/fixed} Follows from \fullref{thm:difference_equation_fixed_points}.
\end{proof}
