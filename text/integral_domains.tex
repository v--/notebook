\subsection{Integral domains}\label{subsec:integral_domains}

\paragraph{Integral domains}

\begin{definition}\label{def:integral_domain}\mcite[def. III.1.10]{Aluffi2009Algebra}
  An \term[bg=област на цялостност (\cite[def. V.4]{ГеновМиховскиМоллов1991Алгебра}), ru=область целостности (\cite[def. 3.5.1]{Винберг2014Алгебра})]{integral domain} is an \hyperref[def:ring/trivial]{nontrivial} \hyperref[def:entire_semiring]{entire} \hyperref[def:ring/commutative]{commutative (unital) ring}.
\end{definition}

\begin{proposition}\label{thm:def:integral_domain}
  \hyperref[def:integral_domain]{Integral domains} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:integral_domain/subring} Any nontrivial \hyperref[def:ring/submodel]{subring} of an integral domain is also an integral domain.

    \thmitem{thm:def:integral_domain/polynomial_ring} A commutative ring \( R \) is an integral domain if and only if its \hyperref[def:polynomial_algebra]{polynomial ring} \( R[X] \) is.

    \thmitem{thm:def:integral_domain/root_limit} In an integral domain, the \hyperref[def:polynomial_root]{multiset of roots} of a univariate nonzero polynomial of \hyperref[def:polynomial_degree]{degree} \( n \) has \hyperref[def:multiset]{multiset cardinality} at most \( n \).

    In other words, a polynomial of degree cannot have more that \( n \) roots, counting multiple roots.

    \thmitem{thm:def:integral_domain/polynomial_divides} The polynomial \( p(X) \) divides \( X^n \) if and only if \( p(X) = aX^m \), where \( a \) is invertible and \( m \leq n \).
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:integral_domain/subring} Trivial.

  \SubProofOf{thm:def:integral_domain/polynomial_ring}

  \NecessitySubProof* If \( R[X] \) is an integral domain, by \fullref{thm:def:integral_domain/subring}, so is \( R \).

  \SufficiencySubProof* It is sufficient to prove the statement for one indeterminate. If \( p(X) \) and \( q(X) \) are nonzero polynomials, then so is \( p(X) q(X) \) by \fullref{thm:def:polynomial_degree/product}.

  \SubProofOf{thm:def:integral_domain/root_limit} We will use induction on the degree. Zero-degree polynomials clearly have zero roots. Suppose that the statement holds for polynomials of degree \( n - 1 \), and let \( p(X) \) have degree \( n \).

  If \( p(X) \) has a root \( u \), by the equivalence in \fullref{def:polynomial_root}, \( (X - u) \) divides \( p(X) \). Then \( p(X) / (X - u) \) has degree \( n - 1 \) by \fullref{thm:def:polynomial_degree/product}. Let \( M \) be the multiset of roots of \( p(X) / (X - u) \). After adding \( u \) to \( M \), we have incremented its total cardinality by \( 1 \), thus making it at most \( n \).

  \SubProofOf{thm:def:integral_domain/polynomial_divides} Suppose that \( X^n = p(X) \cdot q(X) \).

  We have
  \begin{equation*}
    X^n
    =
    p(X) \cdot q(X)
    =
    \sum_{k=0}^\infty (\sum_{m+l=k} a_m b_l) X^k.
  \end{equation*}

  Then
  \begin{equation*}
    a_m b_l = \begin{cases}
      1, &m + l = n, \\
      0, &\T{otherwise}
    \end{cases}
  \end{equation*}

  Since we are working over a domain and there are no zero divisors, there exists only one pair of nonnegative integers \( m \) and \( l \) such that \( a_m b_l = 1 \). It follows that \( p(X) = a_m X^m \) and \( q(X) = a_l X^l \).
\end{proof}

\begin{proposition}\label{thm:quotient_by_prime_ideal}
  The ideal \( P \) of the \hyperref[def:ring/commutative]{commutative ring} \( R \) is \hyperref[def:semiring_ideal/prime]{prime} if and only if the \hyperref[def:ring/quotient]{quotient ring} \( R / P \) is an \hyperref[def:integral_domain]{integral domain}.
\end{proposition}
\begin{comments}
  \item See \fullref{thm:quotient_by_maximal_ideal} for the corresponding statement for \hyperref[def:semiring_ideal/maximal]{maximal ideals} in possibly noncommutative rings.
\end{comments}
\begin{proof}
  \SufficiencySubProof Suppose that \( P \) is a prime ideal. Clearly \( R / P \) is a commutative ring. Since \( P \) is a proper ideal, \( R / P \) must be nontrivial. We will show that it is an \hyperref[def:entire_semiring]{entire ring}.

  Let \( [x] [y] = [0] = P \) (where \( [x] = x + P \) is the coset of \( x \) in \( R / P \)). By definition,
  \begin{equation*}
    [x] [y] = (x + P) (y + P) = (xy + P),
  \end{equation*}
  which implies \( xy + P = P \) and hence \( xy \in P \). Since \( P \) is prime, by \fullref{thm:def:semiring_ideal/prime_pointwise}, we have \( x \in P \) or \( y \in P \).

  Therefore, \( [x] = [0] \) or \( [y] = [0] \). Generalizing on \( x \) and \( y \), we can conclude that \( R / P \) is entire, and thus an integral domain.

  \NecessitySubProof Suppose that \( R / P \) is an integral domain. Since \( R / P \) is nontrivial, \( P \) must be a proper ideal. We will show that it satisfies \fullref{thm:def:semiring_ideal/prime_pointwise}.

  Let \( xy \in P \). We have
  \begin{equation*}
    P = [0] = [xy] = [x] [y],
  \end{equation*}
  hence \( [x] \) and \( [y] \) are zero divisors in \( R / P \). But \( R / P \) is entire, hence either \( [x] \) or \( [y] \) must be zero. That is, either \( x \in P \) or \( y \in P \).

  Generalizing on \( x \) and \( y \), we can conclude that \( P \) is a prime ideal.
\end{proof}

\paragraph{Divisibility in domains}

\begin{proposition}\label{thm:ring_entire_iff_unique_quotient}
  A \hyperref[def:ring/commutative]{commutative ring} is \hyperref[def:entire_semiring]{entire} if and only if, whenever \( y \) \hyperref[def:divisibility]{divides} \( x \), there exists a \hi{unique} element \( z \) such that \( x = yz \).
\end{proposition}
\begin{proof}
  \SufficiencySubProof Suppose that \( R \) is entire. Let \( x = yz = yz' \). \Fullref{thm:def:ring/cancellable_iff_not_zero_divisor} implies that we can cancel \( y \) to obtain \( z = z' \). This demonstrates uniqueness.

  \NecessitySubProof Suppose instead that uniqueness holds and let \( 0 = yz \). By absorption, we have \( 0 = y0 \), and thus \( z = 0 \), showing that \( y \) has no nontrivial zero divisors.

  Since \( y \) was arbitrary, we conclude that the ring is entire.
\end{proof}

\begin{example}\label{ex:nonunique_divisor}
  The requirement in \fullref{thm:ring_entire_iff_unique_quotient} for the ring to be entire is essential --- \fullref{thm:idempotent_division} implies that (nontrivial) multiplicatively idempotent elements are nontrivial zero divisor.

  For example, if \( R \) is nontrivial, consider the \hyperref[thm:matrix_algebra]{matrix algebra} \( R^{2 \times 2} \) and the idempotent matrix
  \begin{equation*}
    \begin{pNiceMatrix}
      1 & 0 \\
      0 & 0
    \end{pNiceMatrix}
  \end{equation*}

  Because it is idempotent, it divides itself:
  \begin{equation*}
    \begin{pNiceMatrix}
      1 & 0 \\
      0 & 0
    \end{pNiceMatrix}^2
    =
    \begin{pNiceMatrix}
      1 & 0 \\
      0 & 0
    \end{pNiceMatrix}.
  \end{equation*}

  But another possible quotient is the identity:
  \begin{equation*}
    \begin{pNiceMatrix}
      1 & 0 \\
      0 & 0
    \end{pNiceMatrix}
    \begin{pNiceMatrix}
      1 & 0 \\
      0 & 1
    \end{pNiceMatrix}
    =
    \begin{pNiceMatrix}
      1 & 0 \\
      0 & 1
    \end{pNiceMatrix}
    \begin{pNiceMatrix}
      1 & 0 \\
      0 & 0
    \end{pNiceMatrix}
    =
    \begin{pNiceMatrix}
      1 & 0 \\
      0 & 0
    \end{pNiceMatrix}.
  \end{equation*}
\end{example}

\begin{definition}\label{def:domain_quotient}\mimprovised
  By \fullref{thm:ring_entire_iff_unique_quotient}, in an \hyperref[def:integral_domain]{integral domain}, if \( y \) divides \( x \), then there exists a unique element \( z \) such that \( x = yz \). \Fullref{thm:def:ring_localization/divisibility} motivates the notation \( x / y \).

  We call \( x / y \) the \term[ru=частное/отношение (\cite[16]{Винберг2014Алгебра})]{quotient} of \( x \) by \( y \).
\end{definition}

\begin{proposition}\label{thm:domain_quotient_inverse}
  If the \hyperref[def:domain_quotient]{quotient} \( x / y \) is invertible, then \( y \) divides \( x \).
\end{proposition}
\begin{comments}
  \item Using the terminology from \fullref{def:domain_divisibility/associates/direct}, \( x \) and \( y \) are thus associates.
\end{comments}
\begin{proof}
  If \( x = yz \) and \( z \) is invertible, then \( x z^{-1} = y \) and thus \( y \) is invertible.
\end{proof}

\begin{definition}\label{def:domain_divisibility}
  We will introduce several notions related to \hyperref[def:divisibility]{divisibility} in \hyperref[def:integral_domain]{integral domains}.

  \begin{thmenum}
    \thmitem{def:domain_divisibility/associates} We say that \( x \) and \( y \) are \term[bg=асоциирани (\cite[142]{ГеновМиховскиМоллов1991Алгебра}), ru=ассоциированные (\cite[118]{Винберг2014Алгебра})]{associated} if any of the following conditions hold:
    \begin{thmenum}
      \thmitem{def:domain_divisibility/associates/direct}\mcite[246]{Aluffi2009Algebra} Both \( x \mid y \) and \( y \mid x \).

      \thmitem{def:domain_divisibility/associates/invertible}\mcite[393]{Knapp2016BasicAlgebra} There exists an \hyperref[def:divisibility/invertible]{invertible element} \( u \) such that \( x = uy \).

      \thmitem{def:domain_divisibility/associates/ideals}\mcite[246]{Aluffi2009Algebra} The \hyperref[def:semiring_ideal/principal]{principal ideals} \( \braket{ x } \) and \( \braket{ y } \) are equal.
    \end{thmenum}

    \thmitem{def:domain_divisibility/irreducible} We say that the nonzero non-invertible element \( x \) is \term[bg=неразложим (\ref{rem:prime_and_irreducible_terminology}), ru=неприводимый (\ref{rem:prime_and_irreducible_terminology})]{irreducible} if any of the following conditions hold:
    \begin{thmenum}
      \thmitem{def:domain_divisibility/irreducible/direct}\mcite[388]{Knapp2016BasicAlgebra} Whenever \( x = yz \), at least one of \( y \) or \( z \) is invertible.
      \thmitem{def:domain_divisibility/irreducible/ideals} \( \braket{ x } \) is maximal among all proper principal ideals. Maximality means that, if \( \braket{ x } \subseteq \braket{ y } \) for some nonzero non-invertible \( y \), then \( \braket{ x } = \braket{ y } \).
    \end{thmenum}

    \thmitem{def:domain_divisibility/prime} We say that the nonzero element \( x \) is \term[bg=прост (\cref{rem:prime_and_irreducible_terminology}), ru=простой (\cref{rem:prime_and_irreducible_terminology})]{prime} if any of the following equivalent conditions hold:
    \begin{thmenum}
      \thmitem{def:domain_divisibility/prime/direct}\mcite[388]{Knapp2016BasicAlgebra} If \( x \mid yz \), then \( x \mid y \) or \( x \mid z \) (or both).
      \thmitem{def:domain_divisibility/prime/ideals}\incite[113]{Lang2002Algebra} The ideal \( \braket{ x } \) is \hyperref[def:semiring_ideal/prime]{prime}.
    \end{thmenum}

    This definition is motivated by \fullref{thm:euclids_lemma}. It also applies more generally for \hyperref[def:entire_semiring]{entire semirings}.
  \end{thmenum}
\end{definition}
\begin{defproof}
  \SubProofOf{def:domain_divisibility/associates}
  \ImplicationSubProof*{def:domain_divisibility/associates/direct}{def:domain_divisibility/associates/invertible} If \( x \mid y \) and \( y \mid x \), then there exist \( a \) and \( b \) such that \( x = ay \) and \( y = bx \). Hence, \( x = abx \). Since we are working in an integral domain, we can cancel \( x \) to obtain \( ab = 1 \). Therefore, both \( a \) and \( b \) are \hyperref[def:divisibility/invertible]{units}.

  \ImplicationSubProof*{def:domain_divisibility/associates/invertible}{def:domain_divisibility/associates/ideals} Suppose that \( x = uy \) for some invertible element \( u \). If \( z \) is in \( \braket{ x } \), then \( x = uy \) divides \( z \) and hence \( y \) also divides \( z \), implying that \( \braket{ x } \subseteq \braket{ y } \). We obtain the converse inclusion by noting that \( y = u^{-1} x \).

  \ImplicationSubProof*{def:domain_divisibility/associates/ideals}{def:domain_divisibility/associates/direct} If \( \braket{ x } = \braket{ y } \), then, by \fullref{thm:def:semiring_ideal/division}, \( x \mid y \) and \( y \mid x \).

  \SubProofOf{def:domain_divisibility/irreducible}
  \ImplicationSubProof*{def:domain_divisibility/irreducible/direct}{def:domain_divisibility/irreducible/ideals} Suppose that \( x \) is not invertible and that \( x = yz \) implies that \( y \) or \( z \) is invertible. Since we are working in an integral domain, \( x \) is necessarily nonzero.

  Let \( \braket{ x } \subseteq \braket{ w } \) for some non-invertible \( w \). By \fullref{thm:def:semiring_ideal/division}, \( w \mid x \). Then there exists some element \( a \) such that \( x = aw \). Since \( w \) is not invertible by assumption, \( a \) must be invertible. By the equivalent definitions of associates in a domain, \( \braket{ x } = \braket{ w } \).

  \ImplicationSubProof*{def:domain_divisibility/irreducible/ideals}{def:domain_divisibility/irreducible/direct} Suppose that \( \braket{ x } \) is maximal among nonzero proper principal ideals.

  Let \( x = yz \). If, without loss of generality, \( \braket{ x } \subseteq \braket{ y } \), then \( \braket{ x } = \braket{ y } \) and, again by the equivalent conditions for associates, there exists some invertible element \( u \) such that \( x = uy \). Cancelling \( y \) in \( yu = yz \), we obtain \( u = z \). Hence, \( z \) is invertible.

  \SubProofOf{def:domain_divisibility/prime} Trivial.
\end{defproof}

\begin{remark}\label{rem:prime_and_irreducible_terminology}
  There is a certain discrepancy in the literature regarding prime and irreducible elements. It does not matter much because, in \hyperref[def:factorial_domain]{factorial domains}, an element is prime if and only if it is irreducible.

  \begin{itemize}
    \item \incite[111]{Lang2002Algebra} uses the term \enquote{irreducible} for what we call \enquote{prime}, and later notes that, in factorial domains, the principal ideal of an irreducible element is prime, and thus it makes sense to call irreducible elements prime in this context. In the Russian translation of the book, in \cite[89]{Ленг1968Алгебра}, irreducible elements are called \enquote{неприводимые элементы}, and prime elements are called \enquote{простые елементы}.

    Later Russian authors, for example \incite[def. 3.5]{Винберг2014Алгебра} and \incite[30]{Шафаревич1999Алгебра}, call irreducible elements \enquote{простые} (which is used as a translation for \enquote{prime} elsewhere in the book, e.g. for prime ideals). This also transfers to Bulgarian books --- for example, \enquote{прост елемент} is used by \incite[def. VI.5]{ГеновМиховскиМоллов1991Алгебра}.

    In the context of polynomials over fields, however, \incite[121]{Винберг2014Алгебра} and \incite[19]{Шафаревич1999Алгебра} use \enquote{неприводимый многочлен} and \incite[def. VI.3]{ГеновМиховскиМоллов1991Алгебра} use \enquote{неразложим полином} for what we call an irreducible polynomial, and avoid mentioning prime polynomials.

    \item On the other hand, a distinction between \enquote{prime} and \enquote{irreducible} elements in general integral domains is made in modern anglophone literature --- for example by \incite[343]{Jacobson1985AlgebraPart1}, \incite[388;389]{Knapp2016BasicAlgebra} and \incite[def. V.1.6]{Aluffi2009Algebra}.

    \incite[67]{Rotman2015AlgebraVol1} only defines irreducible elements, mentioning \enquote{prime elements} in \cite[105]{Rotman2015AlgebraVol1} as a remark.
  \end{itemize}
\end{remark}

\begin{proposition}\label{thm:def:domain_divisibility}
  The divisibility notions from \fullref{def:domain_divisibility} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:domain_divisibility/prime_is_irreducible} Every \hyperref[def:domain_divisibility/prime]{prime element} is \hyperref[def:domain_divisibility/irreducible]{irreducible}.

    The converse is true in \hyperref[def:factorial_domain]{factorial domains}.

    \thmitem{thm:def:domain_divisibility/irreducible_in_polynomial_ring} An element of the domain \( D \) is \hyperref[def:domain_divisibility/irreducible]{irreducible} in \( D \) if and only if it is irreducible in \( D[X] \).

    \thmitem{thm:def:domain_divisibility/irreducible_polynomial_coefficients} If a polynomial is irreducible in \( D[X] \), its nonzero non-invertible coefficients are irreducible in \( D \).

    \thmitem{thm:def:domain_divisibility/associates_and_isomorphisms} If \( \varphi: D \to E \) is an isomorphism, then \( x \) and \( y \) are \hyperref[def:domain_divisibility/associates]{associates} in \( D \) if and only if \( \varphi(x) \) and \( \varphi(y) \) are associates in \( E \).

    \thmitem{thm:def:domain_divisibility/primes_and_isomorphisms} If \( \varphi: D \to E \) is an isomorphism, then \( x \) is \hyperref[def:domain_divisibility/prime]{prime} (resp. \hyperref[def:domain_divisibility/irreducible]{irreducible}) in \( D \) if and only if \( \varphi(x) \) is prime (resp. irreducible) in \( E \).
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:domain_divisibility/prime_is_irreducible} Let \( x \) be a prime element and suppose that \( x = yz \). Then \( x \) divides \( y \) or \( z \). If, without loss of generality, \( x \) divides \( y \), then \( x \) and \( y \) are \hyperref[def:domain_divisibility/associates]{associates}, and, by the equivalence of conditions in \fullref{def:domain_divisibility/associates}, \( z \) must be invertible.

  \SubProofOf{thm:def:domain_divisibility/irreducible_in_polynomial_ring}

  \SufficiencySubProof* Suppose that \( x \) is irreducible in \( D \) and let \( x = y(X) z(X) \). By \fullref{thm:def:polynomial_degree/product}, both \( y(X) \) and \( z(X) \) must be constant polynomials. Therefore, they are scalars, and since \( x \) is irreducible, \( y \) or \( z \) is invertible. By \fullref{thm:def:polynomial_algebra/invertible}, if \( y \) is invertible in \( D \), it is invertible in \( D[X] \).

  Generalizing on \( x \), it follows that every irreducible element in \( D \) is also irreducible in \( D[X] \).

  \NecessitySubProof* Suppose that \( x \) is irreducible in \( D[X] \) and let \( x = yz \). Then \( y \) or \( z \) is invertible in \( D[X] \), and thus again by \fullref{thm:def:polynomial_algebra/invertible}, it is invertible in \( D \).

  Generalizing on \( x \), it follows that every element of \( D \) that is irreducible in \( D[X] \) is also irreducible in \( D \).

  \SubProofOf{thm:def:domain_divisibility/irreducible_polynomial_coefficients} Suppose that the polynomial
  \begin{equation*}
    p(X) = \sum_{k=0}^n a_k x^k
  \end{equation*}
  is irreducible in \( D[X] \).

  Suppose that the non-invertible element \( b \) divides \( a_0, a_1, \ldots, a_n \). Then \( b \) also divides \( p(X) \), and \fullref{thm:def:domain_divisibility/irreducible_in_polynomial_ring} implies that \( b \) is not invertible in \( D[X] \). But this contradicts that \( p(X) \) is irreducible.

  \SubProofOf{thm:def:domain_divisibility/associates_and_isomorphisms} Follows from \fullref{thm:divisibility_and_isomorphisms}.

  \SubProofOf{thm:def:domain_divisibility/primes_and_isomorphisms} Follows from \fullref{thm:divisibility_and_isomorphisms}.
\end{proof}

\begin{example}\label{ex:def:domain_divisibility}
  We list some examples of the divisibility notions from \fullref{def:domain_divisibility}:
  \begin{thmenum}
    \thmitem{ex:def:domain_divisibility/integers} \hyperref[def:prime_number]{Prime numbers} are irreducible integers by definition. By \fullref{thm:euclids_lemma}, they are also prime elements.

    The inverse \( -p \) of the prime number \( p \) is also irreducible and thus a prime element in \( \BbbZ \), but convention requires \enquote{prime numbers} to be positive.

    So, we make a distinction between \enquote{prime numbers} and \enquote{prime elements of \( \BbbZ \)}

    \thmitem{ex:def:domain_divisibility/irreducible_not_prime}\mcite[388]{Knapp2016BasicAlgebra} Consider the ring \( \BbbZ[\sqrt{-5}] \) obtained by \hyperref[def:semiring_adjunction]{adjoining} the complex number \( \sqrt{-5} \) to \( \BbbZ \). We will examine irreducible elements in this ring and show that irreducible elements need not be prime.

    Based on our discussion in \fullref{ex:def:divisibility/i_sqrt5}, we can conclude that \( 1 \) and \( -1 \) are the units of \( \BbbZ \).

    Let \( n \) be a positive integer strictly less than \( 5 \). Suppose that
    \begin{equation}\label{eq:ex:def:domain_divisibility/irreducible_not_prime/decomposition}
      n = \parens[\Big]{ a + b \sqrt{-5} }\parens[\Big]{ c + d \sqrt{-5}}.
    \end{equation}

    Then
    \begin{equation}\label{eq:ex:def:domain_divisibility/irreducible_not_prime/abs}
      \abs{n}^2
      =
      \abs[\Big]{a + b \sqrt{-5}}^2 \cdot \abs[\Big]{c + d \sqrt{-5}}^2
      =
      (a^2 + 5b^2) (c^2 + 5d^2)
      =
      a^2 c^2 + 5a^2 d^2 + 5b^2 c^2 + 25 b^2 d^2.
    \end{equation}

    Since \( n < 5 \), the product \( bd \) must be zero, and since \( \BbbZ \) is entire, it follows that either \( b \) or \( d \) or both must be zero. Furthermore, \( ad \) and \( bc \) must also be zero, hence \( b = d = 0 \). Then \( n = \abs{ac} \). Without loss of generality, suppose that both \( a \) and \( c \) are positive so that \( n = ac \).

    If \( n \) is \( 2 \) or \( 3 \), it is a prime number and is thus irreducible in \( \BbbZ \), hence also in \( \BbbZ[\sqrt{-5}] \).

    Now consider \( 1 \pm \sqrt{-5} \), whose (complex) absolute value is \( \sqrt 6 \). Suppose that it factors as \fullref{eq:ex:def:domain_divisibility/irreducible_not_prime/decomposition}. \Fullref{eq:ex:def:domain_divisibility/irreducible_not_prime/abs} implies that either \( b = 0 \) or \( d = 0 \), but both cannot be zero because the condition \( a^2 c^2 = 6 \) cannot be satisfied.
    \begin{itemize}
      \item If \( b = 0 \), then
      \begin{equation*}
        6 = a^2 (c^2 + 5 d^2).
      \end{equation*}

      We have \( c^2 + 5 d^2 \geq 6 \), so \( a^2 \) must be \( 1 \).

      \item If \( d = 0 \), then similarly
      \begin{equation*}
        6 = c^2 (a^2 + 5b^2),
      \end{equation*}
      from which we conclude that \( c^2 \) must be \( 1 \).
    \end{itemize}

    It follows that \( 1 + \sqrt{5} \) and \( 1 - \sqrt{5} \) are also irreducible.

    Therefore, we have the following ways of representing \( 6 \) as a product of irreducible factors:
    \begin{equation*}
      6 = 2 \cdot 3 = \parens[\Big]{ 1 + \sqrt{-5} } \cdot \parens[\Big]{ 1 - \sqrt{-5}}.
    \end{equation*}

    Furthermore, \( 2 \) and \( 3 \) are irreducible, \( 1 + \sqrt{5} \) doesn't divide neither \( 2 \) nor \( 3 \) but divides their product. Hence, both \( 2 \) and \( 3 \) are irreducible element that are not prime. The same holds for \( 1 + \sqrt{5} \) and \( 1 - \sqrt{5} \).

    \thmitem{ex:def:domain_divisibility/x2_plus_y2} The polynomial \( p(X, Y) \coloneqq a X^2 + b Y^2 \), where \( a \) and \( b \) are positive real numbers, is irreducible in \( \BbbR[X, Y] \).

    Indeed, fix some decomposition \( p(X, Y) = q(X, Y) \cdot r(X, Y) \). From \eqref{eq:thm:def:polynomial_degree/product} it follows that \( \deg q + \deg r = 2 \). If \( \deg q = 2 \), then \( \deg r = 0 \), and hence \( p(X, Y) \) and \( q(X, Y) \) differ by a scalar factor, i.e. it is invertible. Similarly, if \( \deg r = 2 \), then \( q \) is invertible.

    In order for \( p(X, Y) \) to be reducible, both \( q(X, Y) \) and \( r(X, Y) \) must be linear polynomials. Suppose that
    \begin{align*}
      q(X, Y) &= c X + d Y + e, \\
      r(X, Y) &= f X + g Y + h.
    \end{align*}

    Then
    \begin{equation*}
      q(X, Y) \cdot r(X, Y) = c f X^2 + c g X Y + c h X + d f X Y + d g Y^2 + e h Y + e f X + e g Y + e h.
    \end{equation*}

    In order for there to be no mixed monomials, we must have \( c g = - d f \). Furthermore, \( c \), \( d \), \( f \) and \( g \) are nonzero because otherwise either \( a = c f \) or \( b = d g \) would be zero. Thus,
    \begin{equation*}
      a = c f = - \frac {df} g \cdot f = -f^2 \frac d g.
    \end{equation*}

    Since \( a \) and \( f^2 \) are both positive, \( d / g \) must be negative, i.e. \( d \) and \( g \) must have different signs. But then \( b = d g \) would be negative, and this contradicts out initial assumption that \( b \) is positive.

    The obtained contradiction demonstrates that \( p(X, Y) = a X^2 + b Y^2 \) is irreducible over \( \BbbR \).

    \thmitem{ex:def:domain_divisibility/x2_plus_y2_plus_z2} The polynomial \( p(X, Y, Z) \coloneqq a X^2 + b Y^2 + c Z^2 \), where \( a \), \( b \) and \( c \) are nonzero scalars from an arbitrary \hyperref[def:field]{field} \( \BbbK \), is irreducible in \( \BbbK[X, Y, Z] \).

    As in \fullref{ex:def:domain_divisibility/x2_plus_y2}, suppose that \( p(X, Y, Z) \) is a product of the linear polynomials
    \begin{align*}
      q(X, Y, Z) &= d X + e Y + f Z + g, \\
      r(X, Y, Z) &= h X + i Y + j Z + k.
    \end{align*}

    Then \( q(X, Y, Z) \cdot r(X, Y, Z) \) is
    \begin{align*}
      &\phantom{{}+{}}
      d h X^2 + d i X Y + d j X Z + d k X
      + \\ &+
      e h X Y + e i Y^2 + e j Y Z + e k Y
      + \\ &+
      f h X Z + f i Y Z + f j Z^2 + f k Z
      + \\ &+
      g h X + g i Y + g j Z + g k.
    \end{align*}

    Since \( a = dh \), \( b = ei \) and \( c = fj \) are nonzero, it follows that the corresponding scalars are nonzero. Furthermore, we must have
    \begin{align*}
      (d i + e h) X Y &= 0, \\
      (d j + f h) X Z &= 0, \\
      (e j + f i) Y Z &= 0,
    \end{align*}
    that is,
    \begin{align*}
      d i &= - e h, \\
      d j &= - f h, \\
      e j &= - f i.
    \end{align*}

    We can divide the first two equalities to obtain \( i / j = e / f \), i.e. \( ej = fi \). But the third equality states that \( ej = -fi \). Hence, \( ej \) and \( fi \) can both only be zero. But we know that \( e \), \( f \), \( i \) and \( j \) are all nonzero, hence \( ej \) and \( fi \) must also be nonzero.

    The obtained contradiction shows that the polynomial \( p(X, Y, Z) = a X^2 + b Y^2 + c Z^2 \) is irreducible over any field.
  \end{thmenum}
\end{example}

\begin{remark}\label{rem:choice_of_associates}
  If \( x \) and \( y \) are \hyperref[def:domain_divisibility/associates]{associates}, we generally have no reason to prefer \( x \) to \( y \). This leads to a non-uniqueness in certain contexts, e.g. choosing a \hyperref[def:gcd]{greatest common divisor} or, more generally, a generator for a principal ideal. In such cases, we often prefer working with ideals.

  Fortunately, in the majority of cases, we have good candidates for uniqueness:
  \begin{itemize}
    \item In the domain \( \BbbZ \) of integers, there are two units, \( 1 \) and \( -1 \). It is convenient to choose the positive greatest common divisor.

    \item In a polynomial ring over the integers \( \BbbZ \), by \fullref{thm:def:polynomial_algebra/invertible}, the units are again \( 1 \) and \( -1 \), and we can choose the leading coefficient to be positive.

    \item If \( \BbbK \) is any \hyperref[def:field]{field}, any polynomial is associated with a unique \hyperref[def:monic_polynomial]{monic polynomial}.
  \end{itemize}
\end{remark}

\paragraph{Common divisors and multiples}

\begin{example}\label{ex:common_polynomial_divisors}\mcite{MathSE:polynomials_without_gcd}
  Consider two polynomials \( p(X) \) and \( q(X) \) over some domain that we wish to find the common roots of.

  The element \( u \) is a common root if and only if the polynomial \( (X - u) \) divides both \( p(X) \) and \( q(X) \). Thus, if \( r(X) \) is a common divisor of \( p(X) \) and \( q(X) \), every root of \( r(X) \) is a common root for \( p(X) \) and \( q(X) \).

  Let \( C \) be the set of all common divisors of \( p(X) \) and \( q(X) \). Every invertible element of the domain is itself a common divisor, so \( C \) is necessarily nonempty. Consider the \hyperref[thm:semiring_divisibility_order]{divisibility (pre)order} in \( C \). A \hyperref[def:extremal_points/greatest_and_least]{greatest element} with respect to divisibility must contain all common roots of \( p(X) \) and \( q(X) \), and thus it makes sense to search for greatest common divisors.

  \begin{thmenum}
    \thmitem{ex:common_polynomial_divisors/field} If \( p(X) \) and \( q(X) \) are polynomials over a \hyperref[def:field]{field} like \( \BbbR \), \fullref{alg:euclidean_algorithm} explicitly constructs a greatest common divisor.

    \thmitem{ex:common_polynomial_divisors/factorial} More generally, polynomials over \hyperref[def:factorial_domain]{factorial domains} always have a greatest common divisor, but the aforementioned algorithm may fail.

    \thmitem{ex:common_polynomial_divisors/distinct} As a simple concrete example, consider the polynomials \( X^5 \) and \( X^6 \) over any ring. Clearly \( X^5 \) is a common divisor and, furthermore, any polynomial dividing both \( X^5 \) and \( X^6 \) vacuously divides \( X^5 \).

    Thus, \( X^5 \) is a greatest common divisor of \( X^5 \) and \( X^6 \), but it is not unique - for any invertible ring element \( a \), the polynomial \( a X^5 \) is also a greatest common divisor.

    This general problem comes from the lack of antisymmetry in preorders --- see \fullref{ex:preorder_nonuniqueness}.

    \thmitem{ex:common_polynomial_divisors/incomparable} Consider the polynomial algebra \( \BbbZ[X^2, X^3] \) ordered by divisibility. Generally there may be distinct maximal elements on a preordered set. Based on our discussion in \fullref{ex:adjoining_polynomial}, we conclude that these polynomials have the form
    \begin{equation*}
      \sum_{k \neq 1} a_k X^k.
    \end{equation*}

    Because the ring features no monomial \( X \), the monomial \( X^2 \) does not divide \( X^3 \). This has some interesting consequences.

    Consider the polynomials \( X^5 \) and \( X^6 \) in this domain.

    \Fullref{thm:def:integral_domain/polynomial_divides} implies that \( p(X) \) divides \( X^6 \) if and only if \( p(X) = aX^s \) for some invertible \( a \) and \( s \leq 6 \). The quotient of \( X^6 \) by \( p(X) \) is \( a^{-1} X^{6-s} \). Furthermore, neither \( s \) nor \( 6 - s \) must be \( 1 \), thus \( s \) must be among \( 0 \), \( 2 \), \( 3 \), \( 4 \) and \( 6 \).

    Similarly, we can conclude that \( p(X) = aX^s \) divides \( X^5 \) if and only if \( s \) is among \( 0 \), \( 2 \), \( 3 \) and \( 5 \).

    Hence, \( p(X) \) is a common divisor of \( X^5 \) and \( X^6 \) if and only if \( s \) is among \( 0 \), \( 2 \) and \( 3 \).

    \begin{figure}[!ht]
      \centering
      \includegraphics[page=1]{output/ex__common_polynomial_divisors__incomparable}
      \caption{A fragment of the \hyperref[def:hasse_diagram]{Hasse diagram} of the divisibility relation in \( \BbbZ[X^2, X^3] \).}
      \label{fig:ex:common_polynomial_divisors/incomparable}
    \end{figure}

    Thus, up to a choice of invertible element \( a \), the common divisors of \( X^5 \) and \( X^6 \) are \( a \) itself, \( aX^2 \) and \( aX^3 \). But \( aX^2 \) and \( aX^3 \) are not comparable because neither divides the other in \( \BbbZ[X^2, X^3] \).

    Therefore, the monomials \( X^5 \) and \( X^6 \) have two monic maximal divisors but no greatest common divisor in \( \BbbZ[X^2, X^3] \).
  \end{thmenum}
\end{example}

\begin{definition}\label{def:gcd}
  We say that, in a \hyperref[def:integral_domain]{integral domain}, \( g \) is a \term[bg=най-голям общ делител (\cite[def. II.2]{ГеновМиховскиМоллов1991Алгебра}), ru=наибольший общий делитель (\cite[def. 3.5.3]{Винберг2014Алгебра})]{greatest common divisor} of \( x \) and \( y \) if it satisfies the following equivalent conditions:

  \begin{thmenum}
    \thmitem{def:gcd/direct}\mcite[2]{Knapp2016BasicAlgebra} \( g \) divides both \( x \) and \( y \) and, whenever \( d \) is also a common divisor, \( d \) divides \( g \).

    \thmitem{def:gcd/infimum} \( g \) is an \hyperref[def:extremal_points/supremum_and_infimum]{infimum} of \( x \) and \( y \) with respect to the \hyperref[thm:semiring_divisibility_order]{divisibility order}.

    \thmitem{def:gcd/ideals}\mcite[def. V.2.2]{Aluffi2009Algebra} The ideal \( \braket{ g } \) is the smallest principal ideal that contains the join \( \braket{ x } + \braket{ y } = \braket{ x, y } \) of \( \braket{ x } \) and \( \braket{ y } \).
  \end{thmenum}
\end{definition}
\begin{comments}
  \item \Fullref{def:gcd/ideals} can be simplified in \hyperref[def:bezout_domain]{Bezout domains}, where \( \braket{ x, y } \) is principal and must thus coincide with \( \braket{ g } \). Note that the case of least common multiples in \fullref{def:lcm/ideals} always satisfies the corresponding analog to this stronger condition.

  \item There may be distinct greatest common divisors that divide each other --- see \fullref{ex:common_polynomial_divisors/distinct} for a simple example or \fullref{ex:preorder_nonuniqueness} for a discussion of this problem for general preordered sets. For the \hyperref[def:natural_numbers]{natural numbers}, where the GCD of \( x \) and \( y \) is unique, we denote it via \( \gcd(x, y) \).

  \item Some authors like \incite[111]{Lang2002Algebra}, \incite[144]{Jacobson1985AlgebraPart1} and \incite[2]{Knapp2016BasicAlgebra} leave greatest common divisors of \( 0 \) and \( 0 \) undefined, while others like \incite[304]{Rotman2015AlgebraVol1}, \incite[def. V.2.2]{Aluffi2009Algebra} and \incite[119]{Винберг2014Алгебра} and \incite[143]{ГеновМиховскиМоллов1991Алгебра} do not handle them as a special case.
\end{comments}
\begin{defproof}
  \ImplicationSubProof{def:gcd/direct}{def:gcd/infimum} Suppose that \( g \) is a common divisor of \( x \) and \( y \) and any other common divisor divides \( g \).

  Then \( g \) is a lower bound of \( x \) and \( y \) with respect to divisibility. Furthermore, if \( d \) is a common divisor, then \( d \) divides \( g \), and thus is smaller than \( g \) with respect to divisibility.

  Therefore, \( g \) is a greatest lower bound of \( x \) and \( y \).

  \ImplicationSubProof{def:gcd/infimum}{def:gcd/ideals} Suppose that \( g \) is an infimum of \( x \) and \( y \) with respect to divisibility.

  Since \( g \) divides both \( x \) and \( y \), any linear combination \( \alpha x + \beta y \) from \( \braket{ x, y } \) is a multiple of \( g \):
  \begin{equation*}
    \alpha x + \beta y
    =
    g \parens*{ \alpha \frac x g + \beta \frac y g }.
  \end{equation*}

  Hence, \( \braket{ x, y } \subseteq \braket{ g } \).

  Now let \( d \) be such that
  \begin{equation*}
    \braket{ x, y } \subseteq \braket{ d } \subseteq \braket{ g }.
  \end{equation*}

  Since \( g \) a greatest lower bound of \( x \) and \( y \) and since \( d \) divides \( g \), it follows that \( g \) divides \( d \) and thus \( \braket{ d } = \braket{ g } \).

  Therefore, \( \braket{ g } \) is the smallest principal ideal containing \( \braket{ x, y } \).

  \ImplicationSubProof{def:gcd/ideals}{def:gcd/direct} Suppose that \( \braket{ g } \) is the smallest principal ideal containing \( \braket{ x, y } \).

  Then \( \braket{ x } \subseteq \braket{ g } \) and thus \( g \mid x \), and similarly \( g \mid y \). It is thus a common divisor for \( x \) and \( y \).

  Furthermore, if \( d \) is also a common divisor, then, by the proof of the previous implication, \( \braket{ x, y } \subseteq \braket{ d } \). The minimality of \( \braket{ g } \) then ensures that \( \braket{ g } \subseteq \braket{ d } \) and, by \fullref{thm:def:semiring_ideal/division}, \( d \mid g \).
\end{defproof}

\begin{proposition}\label{thm:def:gcd}
  \hyperref[def:gcd]{Greatest common divisors} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:gcd/divides} \( x \) divides \( y \) if and only if \( x \) is a GCD of \( x \) and \( y \).

    \thmitem{thm:def:gcd/associates} Let \( g \) be a \hyperref[def:gcd]{GCD} of \( x \) and \( y \). Then an element \( g' \) is also a greatest common divisor if and only if \( g \) and \( g' \) are \hyperref[def:domain_divisibility/associates]{associates}.

    \thmitem{thm:def:gcd/bezouts_identity_converse} If \( d \) is a common divisor for \( x \) and \( y \), and if there exist elements \( a \) and \( b \) such that \( ax + by = d \), then \( d \) is a \hyperref[def:gcd]{GCD} of \( x \) and \( y \).

    The premise here always holds in \hyperref[def:bezout_domain]{Bezout domains}.
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:gcd/divides} Trivial.

  \SubProofOf{thm:def:gcd/associates} The element \( g' \) satisfies \fullref{def:gcd/ideals} if and only if it has the same principal ideal as \( g \).

  \SubProofOf{thm:def:gcd/bezouts_identity_converse} Let \( e \) be a common divisor of \( x \) and \( y \). Then \( e \) divides both \( ax \) and \( by \), hence also \( ax + by = d \). Therefore, \( e \) divides \( d \), implying that \( d \) is a greatest common divisor of \( x \) and \( y \).
\end{proof}

\begin{definition}\label{def:lcm}
  \hyperref[thm:lattice_duality]{Dually} to \fullref{def:gcd}, we say that, in a \hyperref[def:integral_domain]{integral domain}, \( l \) is a \term[bg=най-малко общо кратно (\cite[381]{ГеновМиховскиМоллов1991Алгебра}), ru=наименьшее общее кратное (\cite[exer. 3.6.3]{Винберг2014Алгебра})]{least common multiple} (LCM) of \( x \) and \( y \) if it satisfies the following equivalent conditions:

  \begin{thmenum}
    \thmitem{def:lcm/direct}\mcite[32]{Knapp2016BasicAlgebra} Both \( x \) and \( y \) divide \( l \) and, whenever \( m \) is also a common multiple, \( l \) divides \( m \).

    \thmitem{def:lcm/supremum} \( l \) is an \hyperref[def:extremal_points/supremum_and_infimum]{supremum} of \( x \) and \( y \) with respect to the \hyperref[thm:semiring_divisibility_order]{divisibility order}.

    \thmitem{def:lcm/ideals} The ideal \( \braket{ l } \) coincides with the meet \( \braket{ x } \cap \braket{ y } \) of \( \braket{ x } \) and \( \braket{ y } \).
  \end{thmenum}
\end{definition}
\begin{comments}
  \item Note how \fullref{def:lcm/ideals} differs from \fullref{def:gcd/ideals} --- the existence of least common multiples in general domains is indeed stronger, as we shall see in \fullref{rem:gcd_but_no_lcm} and \fullref{thm:gcd_and_lcm_existence}.

  \item A result similar to \fullref{thm:def:gcd/associates} holds -- every pair of least common multiples are associates.

  \item As in the case of GCDs, for the \hyperref[def:natural_numbers]{natural numbers}, where the LCM of \( x \) and \( y \) is unique, we denote it via \( \lcm(x, y) \).
\end{comments}
\begin{proof}
  \ImplicationSubProof{def:lcm/direct}{def:lcm/supremum} Same as in the case of GCDs in \fullref{def:gcd}.

  \ImplicationSubProof{def:lcm/supremum}{def:lcm/ideals} We can show that \( \braket{ l } \) is the largest principal ideal contained in \( \braket{ x } \cap \braket{ y } \) similar to the case of GCDs in \fullref{def:gcd}.

  Now let \( z = ax = by \) be a member of the intersection. Then it is a common multiple of \( x \) and \( y \), hence \( l \) must divide \( z \).

  Generalizing on \( z \), we conclude that \( \braket{ x } \cap \braket{ y } \subseteq \braket{ l } \). Since we already have the converse inclusion, it follows that the two ideals are equal.

  \ImplicationSubProof{def:lcm/ideals}{def:lcm/direct} Same as in the case of GCDs in \fullref{def:gcd}.
\end{proof}

\begin{proposition}\label{thm:gcd_and_lcm}
  If \( g \) is a \hyperref[def:gcd]{greatest common divisor} of \( x \) and \( y \) and \( l \) is a \hyperref[def:lcm]{least common multiple}, then \( xy \) and \( gl \) are \hyperref[def:domain_divisibility/associates]{associates}.
\end{proposition}

\begin{remark}\label{rem:gcd_but_no_lcm}
  From \fullref{thm:gcd_and_lcm} it may seem that we are always able to recover a GCD from a LCM, and it is indeed so, but the existence of a LCM does not necessarily follow from the existence of a GCD. The precise existence conditions are described in \fullref{thm:gcd_and_lcm_existence}.

  \incite[thm. 4]{Khurana2003GCD} provides counterexamples --- in \( \BbbZ[\sqrt{-3}] \), the elements \( x = 2 \) and \( y = 1 + \sqrt{-3} \) have a GCD, but not a LCM.

  Fortunately, if \hi{every} pair of elements has a GCD, then every pair also has a LCM.
\end{remark}

\begin{lemma}\label{thm:gcd_of_multiple}\mcite[lemma 1]{Khurana2003GCD}
  Let \( x \), \( y \) and \( r \) be nonzero elements of some integral domain. If \( g \) is a \hyperref[def:gcd]{greatest common divisor} for \( rx \) and \( ry \), then \( r \) divides \( g \) and their \hyperref[def:domain_quotient]{quotient} is a greatest common divisor of \( x \) and \( y \).
\end{lemma}
\begin{proof}
  Since \( r \) is a common divisor of \( rx \) and \( ry \), it follows that \( r \) divides \( g \). Thus, \( g = r \cdot g / r \) divides both \( rx \) and \( ry \). We can cancel \( r \) to obtain that \( g / r \) divides both \( x \) and \( y \).

  Furthermore, if \( d \) is also a common divisor for \( x \) and \( y \), then \( rd \) divides both \( rx \) and \( ry \) and hence also \( g \). Again, cancelling \( r \), we obtain that \( d \) divides \( g / r \).
\end{proof}

\begin{proposition}\label{thm:gcd_and_lcm_existence}\mcite[thm. 2]{Khurana2003GCD}
  For an arbitrary \hyperref[def:integral_domain]{integral domain}, two elements \( x \) and \( y \) have a \hyperref[def:lcm]{least common multiple} if and only if, for every nonzero \( r \), the elements \( rx \) and \( ry \) have a \hyperref[def:gcd]{greatest common divisor}.
\end{proposition}
\begin{proof}
  \SufficiencySubProof

  \SubProof*{Proof that \( x \) and \( y \) have a GCD} Suppose that \( l \) is a LCM of \( x \) and \( y \). Since \( xy \) is also a common multiple, \( l \) divides \( xy \). Let \( g \) be the \hyperref[def:domain_quotient]{quotient} of \( xy \) by \( l \).

  Then
  \begin{equation*}
    xy = gl = g \parens*{ \frac l y \cdot y}
  \end{equation*}
  and we can cancel \( y \) to obtain
  \begin{equation*}
    x = g \frac l y.
  \end{equation*}

  Thus, \( g \) is a divisor of \( x \), and we can similarly conclude that it is a divisor of \( y \). We will show that it is a greatest common divisor.

  For any common divisor \( d \), we have
  \begin{equation*}
    d \cdot \frac x d \cdot y
    =
    xy
    =
    d \cdot \frac {xy} d.
  \end{equation*}

  We can cancel \( d \) to obtain
  \begin{equation*}
    \frac x d \cdot y = \frac {xy} d.
  \end{equation*}

  Thus, \( y \) divides \( xy / d \), and we can similarly conclude that \( x \) divides \( xy / d \). Then it is a common multiple, hence \( l \) must divide it. Thus,
  \begin{equation*}
    gl = xy = \frac {xy} d \cdot d = \frac {xy / d} l \cdot l \cdot d.
  \end{equation*}

  We can cancel \( l \) to obtain
  \begin{equation*}
    g = \frac {xy / d} l \cdot d.
  \end{equation*}

  We have obtained that \( d \) divides \( g \), which makes \( g \) a greatest common divisor of \( x \) and \( y \).

  \SubProof*{Proof that \( rx \) and \( ry \) have a GCD} Since \( l \) is a LCM of \( x \) and \( y \), it is natural to suppose that \( rl \) will be an LCM of \( rx \) and \( ry \).

  It is clearly a common multiple. Furthermore, if \( m \) is also a common multiple, \( m / r \) is a common multiple for \( x \) and \( y \) and thus \( l \) divides \( m / r \). Hence, \( rl \) divides \( m / r \), making \( rl \) a least common multiple of \( rx \) and \( ry \).

  Therefore, by what we have already shown, the following is a GCD for \( rx \) and \( ry \):
  \begin{equation*}
    \frac {r^2 xy} {rl} = \frac {rxy} l.
  \end{equation*}

  \NecessitySubProof Suppose that \( rx \) and \( ry \) have a GCD for every nonzero \( r \) and let \( g \) be a GCD for \( x \) and \( y \) themselves.

  Define
  \begin{equation*}
    l \coloneqq g \cdot \frac x g \cdot \frac y g = x \cdot \frac y g = \frac x g \cdot y.
  \end{equation*}

  Thus, \( l \) is a common multiple for \( x \) and for \( y \). Let \( m \) also be a common multiple of \( x \) and \( y \). We will show that \( l \) divides \( m \).

  Let \( g' \) a greatest common divisor for \( mx \) and \( my \). The product \( xy \) is also a common divisor for \( mx \) and \( my \), hence \( xy \) divides \( g' \).

  \Fullref{thm:gcd_of_multiple} implies that \( g' / m \) is a greatest common divisor for \( x \) and \( y \). \Fullref{thm:def:gcd/associates} implies that \( g \) and \( g' / m \) are associates. Then \( gm \) and \( g' \) are also associates, from which it follows that \( gm \) divides \( xy = gl \). Therefore, \( m \) divides \( l \).

  Generalizing on \( m \), we conclude that \( l \) is a least common multiple.
\end{proof}

\paragraph{Greatest common divisor domains}

\begin{definition}\label{def:gcd_domain}\mcite[32]{Kaplansky1974Rings}
  We say that an \hyperref[def:integral_domain]{integral domain} is a \term{greatest common divisor domain} if any two elements have a \hyperref[def:gcd]{greatest common divisor}.

  \Fullref{thm:gcd_and_lcm_existence} shows that it is equivalent for the \hyperref[def:lcm]{least common multiple} to exist.
\end{definition}

\begin{proposition}\label{thm:def:gcd_domain}
  \hyperref[def:gcd_domain]{Greatest common divisor domains} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:gcd_domain/polynomial_ring} If the \hyperref[def:polynomial_algebra]{polynomial ring} \( R[X] \) over a commutative ring \( R \) is a GCD domain, then \( R \) also is.

    The converse to this is true, but it is more difficult to prove. See \fullref{thm:polynomial_ring_over_gcd_domain}.

    \thmitem{thm:def:gcd_domain/irreducible_is_prime} Every \hyperref[def:domain_divisibility/irreducible]{irreducible element} in a GCD domain is \hyperref[def:domain_divisibility/prime]{prime}.
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:gcd_domain/polynomial_ring} By \fullref{thm:def:integral_domain/subring}, \( R \) is an integral domain.

  Let \( a(X) \) and \( b(X) \) be embeddings in \( R[X] \) of the elements \( a \) and \( b \) from \( R \) and let \( g(X) \) be their greatest common divisor.

  \begin{itemize}
    \item If \( a(X) \) and \( b(X) \) are zero, so is \( g(X) \).
    \item If both are nonzero, \fullref{thm:def:polynomial_degree/product} implies that \( g(X) \) has degree one.
  \end{itemize}

  In both cases, \( g(X) \) corresponds to a constant in \( R \).

  Generalizing, we conclude that \( R \) is a GCD domain.

  \SubProofOf{thm:def:gcd_domain/irreducible_is_prime} Suppose that \( x \) is an irreducible element and that \( x \) divides \( yz \).

  Let \( g \) be a GCD of \( xz \) and \( yz \). Both \( x \) and \( z \) are also common divisors, hence they divide \( g \). Thus,
  \begin{equation*}
    g = z \cdot \frac g z.
  \end{equation*}

  Then
  \begin{equation*}
    xz = g \cdot \frac {xz} g = z \cdot \frac g z \cdot \frac {xz} g.
  \end{equation*}

  We can cancel \( z \) to obtain
  \begin{equation*}
    x = \frac g z \cdot \frac {xz} g.
  \end{equation*}

  Because \( x \) is irreducible, (at least) one of the multiplicands must be invertible.
  \begin{itemize}
    \item If \( g / z \) is invertible, by \fullref{thm:domain_quotient_inverse}, \( g \) and \( z \) are associated. Since \( x \) divides \( g \), it follows that \( x \) divides \( z \).

    \item If \( xz / g \) is invertible, again by \fullref{thm:domain_quotient_inverse}, \( xz \) divides \( g \), which in turn divides \( yz \). Then
    \begin{equation*}
      yz = xz \cdot \frac {yz} {xz}.
    \end{equation*}

    After cancelling \( z \), we obtain that \( x \) divides \( y \).
  \end{itemize}
\end{proof}

\begin{example}\label{ex:def:gcd_domain}
  We list examples of \hyperref[def:gcd_domain]{GCD domains}:
  \begin{thmenum}
    \thmitem{ex:def:gcd_domain/euclidean} \Fullref{alg:euclidean_algorithm} allows computing GCDs in arbitrary \hyperref[def:euclidean_domain]{Euclidean domains}.

    \thmitem{ex:def:gcd_domain/countable_indeterminates} Consider the polynomial algebra \( D[X_1, X_2, \ldots] \) in countably many indeterminates.

    Every polynomial only has finitely many indeterminates, and so two polynomials belong to a subdomain with finitely many indeterminates, along with all their divisors. \Fullref{thm:polynomial_ring_over_gcd_domain} then implies that the polynomials have a greatest common divisor in the subdomain and hence also in \( D[X_1, X_2, \ldots] \).
  \end{thmenum}
\end{example}

\paragraph{Bezout domains}

\begin{definition}\label{def:bezout_domain}
  We say that an \hyperref[def:integral_domain]{integral domain} is a \term{Bezout domain} if any of the following equivalent conditions hold:
  \begin{thmenum}
    \thmitem{def:bezout_domain/identity} For any two elements \( x \) and \( y \), there exists a \hyperref[def:gcd]{greatest common divisor} \( g \) and elements \( a \) and \( b \) such that
    \begin{equation}\label{eq:def:bezout_domain/identity}
      g = ax + by.
    \end{equation}

    We call \eqref{eq:def:bezout_domain/identity} \term[en=Bezout's identity (\cite[3]{Knapp2016BasicAlgebra})]{Bezout's identity}.

    \thmitem{def:bezout_domain/ideals}\mcite[38]{Kaplansky1974Rings} Every finitely-generated ideal is \hyperref[def:semiring_ideal/principal]{principal}.
  \end{thmenum}
\end{definition}
\begin{comments}
  \item Every though the condition is not explicitly requires for \fullref{def:bezout_domain/ideals} to hold, Bezout domains are, by \fullref{def:bezout_domain/identity}, \hyperref[def:gcd_domain]{GCD domains}.
  \item \Fullref{alg:extended_euclidean_algorithm} gives us an explicit construction for \( a \) and \( b \) in the case of \hyperref[def:euclidean_domain]{Euclidean domains}.
\end{comments}
\begin{defproof}
  \ImplicationSubProof{def:bezout_domain/identity}{def:bezout_domain/ideals} Suppose that \eqref{eq:def:bezout_domain/identity} holds.

  Let \( I = \braket{ x_1, \ldots, x_n } \) be a (finitely-generated) ideal. We will use induction on \( n \) to show that \( I \) is principal.

  The base case \( n = 1 \) is trivial. Suppose that \( \braket{ x_1, \ldots, x_{n-1} } \) is principal with generator \( d \). Then \eqref{eq:def:bezout_domain/identity} gives us a GCD \( g \) of \( d \) and \( x_n \), along with coefficients \( a \) and \( b \) such that
  \begin{equation*}
    g = ad + bx_n.
  \end{equation*}

  Clearly \( g \) is a member of \( I \) because
  \begin{equation*}
    I = \braket{ x_1, \ldots, x_{n-1} } + \braket{ x_n }.
  \end{equation*}

  To see that \( I = \braket{ g } \), consider some member \( y \) of \( I \). It is, by definition, a linear combination
  \begin{equation*}
    y = \alpha d + \beta x_n.
  \end{equation*}

  Then it is a common divisor of \( d \) and \( x_n \), hence it also divides \( g \). Hence, every member of \( I \) belongs to \( \braket{ g } \).

  We conclude that \( I = \braket{ g } \).

  \ImplicationSubProof{def:bezout_domain/ideals}{def:bezout_domain/identity} Suppose that all finitely-generated ideals are principal. Then the join \( \braket{ x, y } =\braket{ x } + \braket{ y } \) of the principal ideals of any two elements \( x \) and \( y \) is principal. Let \( g \) be a generator of \( \braket{ x, y } \). Then, by definition of ideal, there exist some coefficients from the domain such that
  \begin{equation*}
    g = ax + by.
  \end{equation*}

  Furthermore, \( g \) is a greatest common divisor of \( x \) and \( y \) because \( \braket{ g } \) is vacuously the smallest principal ideal containing \( \braket{ x, y } \).

  Then \eqref{eq:def:bezout_domain/identity} holds.
\end{defproof}

\begin{proposition}\label{thm:def:bezout_domain}
  \hyperref[def:bezout_domain]{Bezout domains} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:bezout_domain/gcd} Equality holds in \fullref{def:gcd/ideals}: If \( g \) is a \hyperref[def:gcd]{greatest common divisor} of \( x \) and \( y \), then
    \begin{equation*}
      \braket{ g } = \braket{ x } + \braket{ y } = \braket{ x, y }.
    \end{equation*}

    \thmitem{thm:def:bezout_domain/ideal_gcd_closed} Ideals are closed under GCD: If \( g \) is a GCD of some elements in an ideal \( I \), then \( g \) itself belongs to \( I \).
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:bezout_domain/gcd} Follows from \eqref{eq:def:bezout_domain/identity}.
  \SubProofOf{thm:def:bezout_domain/ideal_gcd_closed} Follows from \fullref{thm:def:bezout_domain/gcd}.
\end{proof}

\begin{example}\label{ex:def:bezout_domain}
  We list examples of \hyperref[def:bezout_domain]{Bezout domains}:
  \begin{thmenum}
    \thmitem{ex:def:bezout_domain/integers} By \fullref{thm:bezout_lemma}, the ring \( \BbbZ \) of integers is a Bezout domain.

    \thmitem{ex:def:bezout_domain/noetherian} More generally, every \hyperref[def:noetherian_semiring]{noetherian} domain is a Bezout domain.

    \thmitem{ex:def:bezout_domain/integer_polynomials} The algebra \( \BbbZ[X] \) of univariate integer polynomials is not a Bezout domain --- the ideal \( \braket{ 2, X } \) is finitely generated, but not principal.

    This is a simple example of a GCD domain which is not Bezout.

    \thmitem{ex:def:bezout_domain/multivariate_polynomials} For any Bezout domain \( D \), the algebra \( D[X, Y] \) of bivariate polynomials is not a Bezout domain --- the ideal \( \braket{ X, Y } \) is finitely generated, but not principal.
  \end{thmenum}
\end{example}

\paragraph{Coprime elements}

\begin{definition}\label{def:coprime_elements}\mimprovised
  We say that two nonzero elements of a \hyperref[def:bezout_domain]{Bezout domain} are \term[ru=взаимно простые (идеалы) (\cite[120]{Винберг2014Алгебра}), en=relatively prime (\cite[113]{Lang2002Algebra})]{coprime} if any the following equivalent conditions hold:
  \begin{thmenum}
    \thmitem{def:coprime_elements/divisors} Every common divisor is invertible.
    \thmitem{def:coprime_elements/greatest} Every GCD is invertible.
    \thmitem{def:coprime_elements/ideals} Their principal ideals are \hyperref[def:semiring_ideal/coprime]{coprime}.
  \end{thmenum}
\end{definition}
\begin{defproof}
  \ImplicationSubProof{def:coprime_elements/divisors}{def:coprime_elements/greatest} Special case.

  \ImplicationSubProof{def:coprime_elements/greatest}{def:coprime_elements/ideals} Let \( g \) be a GCD of \( x \) and \( y \) and suppose that it is invertible.

  We have \( \braket{ x } + \braket{ y } = \braket{ x, y } = \braket{ g } \). Since \( g \) is invertible, \( \braket{ g } \) is the entire domain. Hence, the ideals \( \braket{ x } \) and \( \braket{ y } \) are coprime.

  \ImplicationSubProof{def:coprime_elements/ideals}{def:coprime_elements/divisors} Suppose that \( \braket{ x } \) and \( \braket{ y } \) are coprime ideals. Let \( d \) be a common divisor of \( x \) and \( y \). Then
  \begin{equation*}
    \braket{ x, y } \subseteq \braket{ d }.
  \end{equation*}

  But \( \braket{ x, y } \) is the entire domain, hence \( \braket{ d } \) also is. It is thus invertible as a consequence of \fullref{thm:def:semiring_ideal/ideal_containing_unit}.
\end{defproof}

\begin{definition}\label{def:lowest_terms}\mimprovised
  Let \( \BbbK \) be the \hyperref[thm:field_of_fractions]{field of fractions} of the Bezout domain \( D \). We say that the concrete representative \( a / b \) of its class in \( \BbbK \) is \term{in lowest terms} if \( a \) and \( b \) are \hyperref[def:coprime_elements]{coprime} elements of \( D \).
\end{definition}
\begin{comments}
  \item This definition is based on one given by \incite[69]{Rotman2015AlgebraVol1} for rational algebraic functions.
\end{comments}

\begin{proposition}\label{thm:def:coprime_elements}
  \hyperref[def:coprime_elements]{Coprime elements} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:coprime_elements/divisors} If \( x \) and \( y \) are coprime, then \( x \) is coprime to any divisor of \( y \).

    \thmitem{thm:def:coprime_elements/gcd_quotients} If \( g \) is a GCD of \( x \) and \( y \), then \( x / g \) is coprime to \( y / g \).

    \thmitem{thm:def:coprime_elements/irreducible} Two \hyperref[def:domain_divisibility/irreducible]{irreducible} elements in a Bezout domain are either \hyperref[def:domain_divisibility/associates]{associated} or coprime.

    \thmitem{thm:def:coprime_elements/lowest_terms} Let \( \BbbK \) be the \hyperref[thm:field_of_fractions]{field of fractions} of the Bezout domain \( D \). For any element of \( \BbbK \), there exists an equal one \hyperref[def:lowest_terms]{in lowest terms}.
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:coprime_elements/divisors} Suppose that \( x \) and \( y \) are coprime and let \( z \) be a divisor of \( y \).

  If \( d \) is a common divisor of \( x \) and \( z \), then \( d \) is also a common divisor of \( x \) and \( y \), and so it follows that \( d \) is invertible. So, all common divisors of \( x \) and \( z \) are invertible, and hence, they are coprime.

  Generalizing on \( z \), we conclude that \( x \) is coprime to any divisor of \( y \).

  \SubProofOf{thm:def:coprime_elements/gcd_quotients} Let \( g \) be a GCD of \( x \) and \( y \).

  Let \( d \) be a common divisor of \( x / g \) and \( y / g \). Then
  \begin{equation*}
    x = g \cdot \frac x g = g \cdot d \cdot \frac {x / g} d
  \end{equation*}
  and
  \begin{equation*}
    y = g \cdot \frac y g = g \cdot d \cdot \frac {y / g} d.
  \end{equation*}

  Hence, \( gd \) is a common divisor of \( x \) and \( y \), and thus \( gd \) must divide \( g \). We have
  \begin{equation*}
    g = gd \cdot \frac g {gd}.
  \end{equation*}

  By cancelling \( g \), we obtain
  \begin{equation*}
    1 = d \cdot \frac g {gd}.
  \end{equation*}

  Therefore, \( d \) is invertible.

  Generalizing on \( d \), we conclude that \( x / g \) and \( y / g \) are coprime because all their common divisors are invertible.

  \SubProofOf{thm:def:coprime_elements/irreducible} Suppose that \( x \) and \( y \) are irreducible. Let \( g \) be a GCD of \( x \) and \( y \). Then there exist elements \( x' \) and \( y' \) such that \( x = x'g \) and \( y = y'g \).

  \begin{itemize}
    \item If \( g \) is invertible, then \( x \) and \( y \) satisfy the definition of coprimality.
    \item Otherwise, \( x' \) and \( y' \) are both invertible, and thus \( x \), \( g \) and \( y \) are associates.
  \end{itemize}

  \SubProofOf{thm:def:coprime_elements/lowest_terms} Let \( a \) and \( b \) be elements of \( D \). We want to find coprime elements \( c \) and \( d \) such that \( a / b = c / d \). By definition of localization, this holds if, for some \( u \), we have \( adu = bcu \). Since we are working in an integral domain and multiplication is cancellative, the condition reduces to \( ad = bc \).

  Let \( g \) be a GCD of \( a \) and \( b \). \Fullref{thm:def:coprime_elements/gcd_quotients} implies that \( a / g \) and \( b / g \) are coprime. Furthermore,
  \begin{equation*}
    a \cdot \frac b g = b \cdot \frac a g,
  \end{equation*}
  hence \( c = a / g \) and \( d = b / g \) are the desired coprime elements.
\end{proof}

\paragraph{Irreducible factorizations}

\begin{definition}\label{def:irreducible_factorization}\mcite[def. 1.8]{Aluffi2009Algebra}
  An \term{irreducible factorization} or simply \term{factorization} of a nonzero element \( x \) in an arbitrary \hyperref[def:integral_domain]{integral domain} is a finite sequence \( p_1, \ldots, p_n \) of \hyperref[def:domain_divisibility/irreducible]{irreducible elements} such that, for some \hyperref[def:divisibility/invertible]{invertible element} \( u \),
  \begin{equation*}
    x = u p_1 \cdots p_n.
  \end{equation*}

  The invertible element \( u \) is uniquely determined by the irreducible factors\fnote{If \( x \) is itself invertible, then it is its own factorization.}.

  \begin{thmenum}
    \thmitem{def:irreducible_factorization/equivalent} We say that two factorizations
    \begin{equation*}
      x = u p_1 \cdots p_n = v q_1 \cdots q_m
    \end{equation*}
    are equivalent if \( n = m \) and if there exists a \hyperref[def:symmetric_group]{permutation} \( \pi \in S_n \) such that \( p_k \) and \( q_{\pi(k)} \) are \hyperref[def:domain_divisibility/associates]{associated} for every \( k = 1, \ldots, n \).

    \thmitem{def:irreducible_factorization/unique} Finally, if any two factorizations of \( x \) are equivalent, we say that \( x \) \term{factors uniquely} into a product of irreducible factors.
  \end{thmenum}
\end{definition}

\begin{example}\label{ex:def:irreducible_factorization}
  We list some examples of \hyperref[def:irreducible_factorization]{irreducible factorization}:
  \begin{thmenum}
    \thmitem{ex:def:irreducible_factorization/integers} By \fullref{thm:fundamental_theorem_of_arithmetic}, every integer has a unique factorization.

    \thmitem{ex:def:irreducible_factorization/nonunique} Consider the ring \( \BbbZ[\sqrt{-5}] \) from \fullref{ex:def:domain_divisibility/irreducible_not_prime}. We have obtained there two distinct irreducible factorizations:
    \begin{equation*}
      6 = 2 \cdot 3 = \parens[\Big]{ 1 + \sqrt{-5} } \cdot \parens[\Big]{ 1 - \sqrt{-5}}
    \end{equation*}
  \end{thmenum}
\end{example}

\begin{proposition}\label{thm:def:irreducible_factorization}
  \hyperref[def:irreducible_factorization]{Irreducible factorizations} in integral domains have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:irreducible_factorization/existence} If every ascending sequence of \hi{principal} ideals \hyperref[def:stabilizing_sequence]{stabilizes}, then every element has at least one irreducible \hi{factorization}.

    \thmitem{thm:def:irreducible_factorization/uniqueness} If every \hyperref[def:domain_divisibility/irreducible]{irreducible element} is \hyperref[def:domain_divisibility/prime]{prime}, then all factorizations of an element are \hyperref[def:irreducible_factorization/equivalent]{equivalent}\fnote{But there may be elements with no factorization.}.

    \thmitem{thm:def:irreducible_factorization/polynomial_ring} For any domain \( D \), \( x = u p_1 \cdots p_n \) is an irreducible factorization in \( D \) if and only if it is an irreducible factorization of \( x \) in \( D[X] \).
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:irreducible_factorization/existence} Suppose that every ascending sequence of principal ideals stabilizes. We will show that every element has an irreducible factorization, but first we will need an auxiliary result.

  \SubProof*{Every non-invertible element has at least one irreducible \hi{factor}} Fix some element \( x \). Let \( x_1 \coloneqq x \). Via recursion on \( k = 1, 2, \ldots \), define a sequence as follows:
  \begin{itemize}
    \item If all divisors of \( x_k \) are invertible, then \( x_k \) is irreducible. Let \( x_{k+1} \coloneqq x_k \).
    \item Otherwise, let \( d \) be a non-invertible divisor of \( x_k \), define \( x_{k+1} \) to be the \hyperref[def:domain_quotient]{quotient} \( x_k / d \).
  \end{itemize}

  The corresponding ascending sequence of principal ideals
  \begin{equation*}
    \braket{ x_1 } \subseteq \braket{ x_2 } \subseteq \braket{ x_3 } \subseteq \cdots
  \end{equation*}
  must stabilize at some index \( n \). Then, by construction, \( x_n \) must be irreducible.

  \SubProof*{Every element has at least one irreducible \hi{factorization}} Fix again some element \( x \) and define \( x_1 \coloneqq x \). Via recursion on \( k = 1, 2, \ldots \), define the following sequence:
  \begin{itemize}
    \item If \( x_k \) is either invertible or irreducible, let \( x_{k+1} \coloneqq x_k \).
    \item Otherwise, let \( p \) be an irreducible divisor of \( x_k \) and define \( x_{k+1} \) to be \( x_k / p \).
  \end{itemize}

  Similarly, the corresponding sequence of principal ideals must stabilize at some index \( n \).

  Define \( p_k \coloneqq x_{k+1} / x_k \) for every \( k \). If \( n > 1 \), then the elements \( p_1, \ldots, p_{n-1} \) must be irreducible. By construction, \( x_n \) is either invertible or is itself irreducible.
  \begin{itemize}
    \item If \( x_n \) is invertible, let \( u \coloneqq x_n \). Then \( x = u p_1 \cdots p_{n-1} \) is an irreducible factorization of \( x \).
    \item If \( x_n = p_n \) is irreducible, then \( x = p_1 \cdots p_n \) is an irreducible factorization of \( x \).
  \end{itemize}

  \SubProofOf{thm:def:irreducible_factorization/uniqueness} Suppose that every irreducible element is prime.

  Fix an element \( x \). If it has no irreducible factorization, then all its irreducible factorizations are vacuously equivalent. Otherwise, suppose that \( x \) has a factorization of length \( n \). We will prove by induction on \( n \) that any other factorization is equivalent.

  If \( n = 0 \), then \( x = u \) is invertible, and hence it has no irreducible divisors, that is, all factorizations have length \( 0 \).

  Otherwise, suppose that factorizations of length \( n - 1 \) are unique and that we are given the factorizations
  \begin{equation}\label{eq:def:irreducible_factorization/uniqueness/proof/assumption}
    x = u p_1 \cdots p_n = v q_1 \cdots q_m.
  \end{equation}

  Since \( p_n \) is prime, there exists an index \( k_0 \) among \( 1, \ldots, m \) such that \( p_n \) divides \( q_{k_0} \). Both are irreducible, thus, \( p_n = w q_k \) for some invertible element \( w \). We can cancel \( p_1 \) to obtain
  \begin{equation*}
    u p_1 \cdots p_{n-1} = (vw) q_1 \cdots q_{k_0-1} q_{k_0+1} \cdots q_m.
  \end{equation*}

  By the inductive hypothesis, this factorization is unique. Hence, \( n = m \), and there exists a permutation \( \pi \in S_{n-1} \) such that \( p_k = q_{\pi(k)} \) for \( k = 1, \ldots, n - 1 \). Then
  \begin{equation*}
    \widehat{\pi}(k) \coloneqq \begin{cases}
      k_0,    & k = n \\
      \pi(i), & \T{otherwise.}
    \end{cases}
  \end{equation*}
  is a permutation witnessing the equivalence of the factorizations in \eqref{eq:def:irreducible_factorization/uniqueness/proof/assumption}.

  \SubProofOf{thm:def:irreducible_factorization/polynomial_ring}

  \SufficiencySubProof* Suppose that
  \begin{equation}\label{eq:thm:def:irreducible_factorization/polynomial_ring/sufficiency_assumption}
    x = u(X) p_1(X) \cdots p_n(X)
  \end{equation}
  be an irreducible factorization of \( x \in D \) in \( D[X] \). By \fullref{thm:def:polynomial_degree/product}, all polynomials in this factorization are constants. By \fullref{thm:def:domain_divisibility/irreducible_in_polynomial_ring}, since they are irreducible in \( D[X] \), they are also irreducible in \( D \).

  Therefore, \eqref{eq:thm:def:irreducible_factorization/polynomial_ring/sufficiency_assumption} is an irreducible factorization of \( x \) in \( D \).

  \NecessitySubProof* Due to \fullref{thm:def:polynomial_algebra/invertible} and \fullref{thm:def:domain_divisibility/irreducible_in_polynomial_ring}, irreducible elements and units in \( D \) are also irreducibles and units in \( D[X] \). Hence, every irreducible factorization in \( D \) is also an irreducible factorization in \( D[X] \).
\end{proof}

\paragraph{Factorial domains}

\begin{definition}\label{def:factorial_domain}
  We say that an \hyperref[def:integral_domain]{integral domain} is a \term[ru=факториальное кольцо (\cite[def. 9.7.1]{Винберг2014Алгебра})]{factorial domain} or \term{unique factorization domain} (UFD) if any of the following equivalent conditions hold:
  \begin{thmenum}
    \thmitem{def:factorial_domain/factorization}\mcite[def. V.1.10]{Aluffi2009Algebra} Every element \hyperref[def:irreducible_factorization/unique]{factors uniquely} into a product of \hyperref[def:domain_divisibility/irreducible]{irreducible} elements.

    \thmitem{def:factorial_domain/gcd} It is a \hyperref[def:gcd_domain]{GCD domain} and every ascending sequence of principal ideals \hyperref[def:stabilizing_sequence]{stabilizes}.
  \end{thmenum}
\end{definition}
\begin{defproof}
  \ImplicationSubProof{def:factorial_domain/factorization}{def:factorial_domain/gcd} Suppose that every element has a unique factorization.

  \SubProof*{Proof that it is a GCD domain} Fix arbitrary elements \( x \) and \( y \). We will show that they have a GCD.

  Let \( x = u p_1 \cdots p_n \) be a decomposition of \( x \). Define \( y_0, y_1, \ldots, y_n \) as follows:
  \begin{equation*}
    y_k \coloneqq \begin{cases}
      y,             &k = 0, \\
      y_{k-1} / p_k, &k > 0 \T{and} p_k \mid y_{k-1}, \\
      y_{k-1},       &k > 0 \T{and} p_k \not\mid y_{k-1}.
    \end{cases}
  \end{equation*}

  Finally, let \( q_k \coloneqq y_k / y_{k-1} \) for \( k = 1, \ldots, n \) so that \( q_k \) is either \( p_k \) if \( p_k \) divides both \( x \) and \( y \) the same amount of times and \( 1 \) otherwise. Then \( q_1 \cdots q_n \) is a greatest common divisor of \( x \) and \( y \).

  \SubProof*{Proof of ascending chain condition} Fix an ascending sequence of principal ideals
  \begin{equation*}
    \braket{ x_1 } \subseteq \braket{ x_2 } \subseteq \braket{ x_3 } \cdots.
  \end{equation*}

  \Fullref{thm:def:semiring_ideal/division} implies that \( x_{k+1} \) divides \( x_k \) for \( k = 1, 2, \ldots \).

  Let \( x_1 = y x_2 \) and fix \hyperref[def:irreducible_factorization]{irreducible factorizations}
  \begin{align*}
    x_1 &= u p_1 \cdots p_n \\
    x_2 &= v q_1 \cdots q_m \\
    y   &= w r_1 \cdots r_k.
  \end{align*}

  Since the factorizations are unique, we have \( n = m + k \). If \( k = 0 \), then \( x_1 \) and \( x_2 \) are associated and \( \braket{ x_1 } = \braket{ x_2 } \). If \( k > 0 \), then \( \braket{ x_1 } \subsetneq \braket{ x_2 } \), and \( x_2 \) has a strictly shorter irreducible factorization.

  Proceeding by induction on the length of the factorization, we conclude that there are at most \( n \) strict inclusions in the sequence of ideals.

  \ImplicationSubProof{def:factorial_domain/gcd}{def:factorial_domain/factorization} Let \( D \) be a GCD domain in which every ascending sequence of principal ideals stabilizes.

  The latter condition via \fullref{thm:def:irreducible_factorization/existence} ensures that every element of \( D \) has at least one irreducible factorization.

  Furthermore, since \( D \) is a GCD domain, \fullref{thm:def:gcd_domain/irreducible_is_prime} implies that every irreducible element is prime, so the assumptions of \fullref{thm:def:irreducible_factorization/uniqueness} are satisfied and irreducible factorization are unique.
\end{defproof}

\begin{example}\label{ex:def:factorial_domain}
  We list examples of \hyperref[def:factorial_domain]{factorial domains}:
  \begin{thmenum}
    \thmitem{ex:def:factorial_domain/integers} By \fullref{thm:fundamental_theorem_of_arithmetic}, the natural numbers are a factorial domain.

    \thmitem{ex:def:factorial_domain/pid} More generally, by \fullref{thm:def:principal_ideal_domain/factorial}, every principal ideal domain is factorial.

    \thmitem{ex:def:factorial_domain/infinitely_descending_divisor_chain} Consider the subring \( D \) of the polynomial ring \( \BbbR[X] \) with an integer free term. The following are elements of \( D \):
    \begin{equation*}
      \frac X {2^1}, \frac X {2^2}, \frac X {2^3}, \cdots, \frac X {2^n}, \cdots
    \end{equation*}The Contortionist - Language
    but their denominators are not.

    Hence, we have the following strictly descending sequence of proper divisors:
    \begin{equation*}
      \cdots \mid \frac X {2^n} \mid \frac X {2^{n-1}} \mid \cdots \frac X {2^2} \mid \frac X {2^1} \mid X,
    \end{equation*}
    which in turn corresponds to an strictly ascending sequence of principal ideals.

    Therefore, \( D \) is not a factorial domain.
  \end{thmenum}
\end{example}

\begin{proposition}\label{thm:def:factorial_domain}
  \hyperref[def:factorial_domain]{Factorial domains} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:factorial_domain/polynomial_ring} If the \hyperref[def:polynomial_algebra]{polynomial ring} \( R[X] \) over a commutative ring \( R \) is a factorial domain, then \( R \) also is.

    The converse to this is true, but it is more difficult to prove. See \fullref{thm:polynomial_ring_over_factorial}.
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:factorial_domain/polynomial_ring} Suppose that \( D[X] \) is a factorial domain. \Fullref{thm:def:irreducible_factorization/polynomial_ring} implies that every irreducible factorization of \( x \in D \) in \( D[X] \) is also an irreducible factorization in \( D[X] \). This in turn implies both existence and uniqueness.
\end{proof}

\paragraph{Principal ideal domains}

\begin{definition}\label{def:principal_ideal_domain}\mcite[def. III.4.2]{Aluffi2009Algebra}
  We say that an \hyperref[def:integral_domain]{integral domain} is a \term[bg=област на главни идеали (\cite[def. VI.3]{ГеновМиховскиМоллов1991Алгебра}), ru=\cite[def. 9.3]{Винберг2014Алгебра}]{principal ideal domain} if any of the following equivalent conditions hold:
  \begin{thmenum}
    \thmitem{def:principal_ideal_domain/direct} Every \hyperref[def:semiring_ideal]{ideal} is \hyperref[def:semiring_ideal/principal]{principal}, i.e. has a single generator.

    \thmitem{def:principal_ideal_domain/bezout} It is a \hyperref[def:bezout_domain]{Bezout domain} and every ascending sequence of principal ideals \hyperref[def:stabilizing_sequence]{stabilizes}.
  \end{thmenum}
\end{definition}
\begin{proof}
  \ImplicationSubProof{def:principal_ideal_domain/direct}{def:principal_ideal_domain/bezout} It is immediate that, if all ideals are principal, the domain is both noetherian and is a Bezout domain.

  \ImplicationSubProof{def:principal_ideal_domain/bezout}{def:principal_ideal_domain/direct} Let \( D \) be a Bezout domain and suppose that every ascending sequence of principal ideals stabilizes.

  Fix an arbitrary ideal \( I \) and an arbitrary member \( x_1 \) of \( I \). Define the following sequence via recursion on \( k \):
  \begin{displayquote}
    If there exists members of \( I \) not in \( \braket{ x_k } \), let \( a \) be such a member, and define \( x_{k+1} \) to be a GCD of \( x_k \) and \( a \).

    Otherwise, define \( x_{k+1} \) to be \( x_k \).
  \end{displayquote}

  Since \( D \) is a Bezout domain, \( x_{k+1} \) is a linear combination of \( x_1, \ldots, x_k \), and thus \( \braket{ x_{k+1} } = \braket{ x_1, \ldots, x_k } \). Furthermore, \fullref{thm:def:bezout_domain/ideal_gcd_closed} implies that \( x_k \) belongs to \( I \) for every index \( k \).

  By construction, for each index \( k \), \( x_{k+1} \) divides \( x_k \). The corresponding sequence of principal ideals stabilizes at some index \( n \). By construction, \( \braket{ x_n } \) must be \( I \) because otherwise we would have found some member \( a \) from \( I \setminus \braket{ x_n } \).

  Therefore, \( I = \braket{ x_n } \).
\end{proof}

\begin{example}\label{ex:def:principal_ideal_domain}
  We list examples of \hyperref[def:principal_ideal_domain]{principal ideal domains}:
  \begin{thmenum}
    \thmitem{ex:def:principal_ideal_domain/integers} Every \hyperref[def:euclidean_domain]{Euclidean domain} is a principal ideal domain as a consequence of \fullref{thm:def:euclidean_domain/pid}.

    \thmitem{ex:def:principal_ideal_domain/integer_polynomials} The algebra \( \BbbZ[X] \) of univariate integer polynomials is not a principal ideal domain because it is not a Bezout domain --- as discussed in \fullref{ex:def:bezout_domain/integer_polynomials}, the ideal \( \braket{ 2, X } \) is not principal.

    \thmitem{ex:def:principal_ideal_domain/multivariate_polynomials} Again, as discussed in, \fullref{ex:def:bezout_domain/multivariate_polynomials}, multivariate polynomial rings are not Bezout domains, and hence not principal ideal domains.

    A necessary condition for a polynomial ring to be a PID is given in \fullref{thm:def:principal_ideal_domain/field_polynomials} --- its underlying ring must be an Euclidean domain.
  \end{thmenum}
\end{example}

\begin{proposition}\label{thm:def:principal_ideal_domain}
  \hyperref[def:principal_ideal_domain]{Principal ideal domains} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:principal_ideal_domain/noetherian} Every principal ideal domain is \hyperref[def:noetherian_semiring]{noetherian}.

    \thmitem{thm:def:principal_ideal_domain/factorial} Every principal ideal domain is \hyperref[def:factorial_domain]{factorial}.

    \thmitem{thm:def:principal_ideal_domain/prime_ideal_is_maximal} \hyperref[def:semiring_ideal/prime]{Prime ideals} in a principal ideal domains are \hyperref[def:semiring_ideal/maximal]{maximal}.

    \thmitem{thm:def:principal_ideal_domain/field_polynomials} A commutative ring \( R \) is a \hyperref[def:field]{field} if and only if its \hyperref[def:polynomial_algebra]{polynomial algebra} \( R[X] \) is a principal ideal domain.
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:principal_ideal_domain/noetherian} Every principal ideal is finitely-generated.

  \SubProofOf{thm:def:principal_ideal_domain/factorial} \Fullref{def:factorial_domain/gcd} follows directly from \fullref{def:principal_ideal_domain/bezout}.

  \SubProofOf{thm:def:principal_ideal_domain/prime_ideal_is_maximal} Let \( P \) be a prime ideal in a principal ideal domain. Then \( P = \braket{ p } \) for some prime element \( p \). By \fullref{thm:def:domain_divisibility/prime_is_irreducible}, \( p \) is irreducible, and hence \( \braket{ p } \) is a maximal ideal.

  \SubProofOf{thm:def:principal_ideal_domain/field_polynomials} Let \( R \) be a commutative ring.

  \SufficiencySubProof* Suppose that \( R \) is a field. \Fullref{thm:def:integral_domain/polynomial_ring} implies that \( R[X] \) is a domain. Let \( I \) be an ideal in \( R[X] \).

  \Fullref{alg:euclidean_division_of_polynomials} allows us to divide any polynomial \( f(X) \) by a monic polynomial \( g(X) \), such that \( f(X) = g(X) q(X) + r(X) \) and \( r(X) \) is either zero or \( \deg r < \deg g \).

  More generally, if \( b_m \) is the leading coefficient of \( g(X) \), then \( g(X) / b_m \) is a monic polynomial and
  \begin{equation*}
    f(X) = \frac {g(X)} {b_m} q(X) + r(X).
  \end{equation*}

  If both \( f(X) \) and \( g(X) \) are in \( R[X] \), then so it \( r(X) = f(X) - \frac {g(X)} {b_m} q(X) \).

  Now let \( g(X) \) be a polynomial from \( I \) of minimal degree. Then \( r(X) \) cannot have a degree less than \( g(X) \), and thus the remaining option for \( r(X) \) in this case is to be zero. But then
  \begin{equation*}
    f(X) = \frac {q(X)} {b_m} g(X).
  \end{equation*}

  Since \( f(X) \) was arbitrary, we conclude that \( g(X) \) generates \( I \). Generalizing on \( I \), we conclude that \( R[X] \) is a principal ideal domain.

  \NecessitySubProof* Suppose that \( R[X] \) is a principal ideal domain.
  \begin{itemize}
    \item \Fullref{thm:def:integral_domain/subring} implies that \( R \) is an integral domain.
    \item \Fullref{thm:quotient_by_prime_ideal} implies that \( \braket{ X } \) is a prime ideal in \( R[X] \).
    \item Since \( R \) is a PID, \Fullref{thm:def:principal_ideal_domain/prime_ideal_is_maximal} then implies that \( \braket{ X } \) is a maximal ideal.
    \item \Fullref{thm:quotient_structure_universal_property} implies that \( R \) is isomorphic to \( R[X] / \braket{ X } \).
    \item \Fullref{thm:quotient_by_maximal_ideal} then implies \( R[X] / \braket{ X } \cong R \) is a field.
  \end{itemize}
\end{proof}

\begin{proposition}\label{thm:multiplicative_group_of_integers_modulo}
  The \hyperref[def:semiring]{multiplicative group} \( \BbbZ_n^\times \) of the ring \hyperref[def:ring_of_integers_modulo]{\( \BbbZ_n \)} of integers modulo \( n > 1 \) is the set of all positive integers \hyperref[def:coprime_elements]{coprime} to \( n \).
\end{proposition}
\begin{proof}
  Note that \( x < n \) is invertible modulo \( n \) if and only if there exists an integer \( a \) such that \( ax = 1 \pmod n \). That is, if there exist integers \( a \) and \( b \) such that \( ax + bn = 1 \).

  The rest of the theorem follows from \eqref{eq:def:bezout_domain/identity} in one direction and \fullref{thm:def:gcd/bezouts_identity_converse} in the other direction.
\end{proof}

\begin{corollary}\label{thm:zp_is_field}
  The ring \( \BbbZ_p \) is a \hyperref[def:field]{field} if and only if \( p \) is a \hyperref[def:prime_number]{prime number}.
\end{corollary}
\begin{proof}
  Follows from \fullref{thm:multiplicative_group_of_integers_modulo}.
\end{proof}

\paragraph{Euclidean domains}

\begin{definition}\label{def:euclidean_domain}\mcite[98]{Rotman2015AlgebraVol1}
  An \term[bg=евклидов (пръстен) (\cite[def. VI.2]{ГеновМиховскиМоллов1991Алгебра}), ru=евклидово (кольцо) (\cite[def. 3.5.2]{Винберг2014Алгебра})]{Euclidean domain} is an \hyperref[def:integral_domain]{integral domain} \( D \) endowed with a function
  \begin{equation*}
    \delta: D \setminus \set{ 0 } \to \BbbZ_{\geq 0},
  \end{equation*}
  which we call the \term{Euclidean degree}, such that the following conditions hold:
  \begin{thmenum}
    \thmitem{def:euclidean_domain/multiplication}  For every nonzero pair \( x \) and \( y \) we have
    \begin{equation}\label{eq:def:euclidean_domain/multiplication}
      \deg(x) \leq \deg(xy).
    \end{equation}

    \thmitem{def:euclidean_domain/division} For every pair \( x \) and \( y \) of elements of \( D \) in which \( y \) is nonzero, there exists a pair \( q \) and \( r \), where \( r \) is either zero or \( \delta(r) < \delta(y) \), such that
    \begin{equation}\label{eq:def:euclidean_domain/division}
      x = yq + r
    \end{equation}
  \end{thmenum}

  We say that \( y \) \term{divides} \( x \) with \term{quotient} \( q \) and \term{remainder} \( r \). If the quotient and remainder are unique, as they usually are, we use the special notation
  \begin{align*}
    &\quot(x, y) \coloneqq q, \\
    &\rem(x, y) \coloneqq r = x - y \cdot \quot(x, y).
  \end{align*}
\end{definition}
\begin{comments}
  \item The concept is inconsistent across authors.
  \begin{itemize}
    \item \incite[98]{Rotman2015AlgebraVol1} and \incite[def. 3.5.2]{Винберг2014Алгебра} both use the term \enquote{Euclidean ring} for our definition.

    \item \incite[36]{Шафаревич1999Алгебра} and \incite[def. VI.2]{ГеновМиховскиМоллов1991Алгебра} also use \enquote{Euclidean ring}, however neither state \fullref{def:euclidean_domain/multiplication}, and the latter even requires degrees to be defined for zero elements.

    \item \incite[392]{Knapp2016BasicAlgebra} and \incite[def 2.5]{Jacobson1985AlgebraPart1} use the term \enquote{Euclidean domain}, however they both require \( \delta \) to be defined for zero elements and neither states \fullref{def:euclidean_domain/multiplication}.
  \end{itemize}
\end{comments}

\begin{example}\label{ex:def:euclidean_domain}
  We list examples of \hyperref[def:euclidean_domain]{Euclidean domains}:
  \begin{thmenum}
    \thmitem{ex:def:euclidean_domain/integers} \Fullref{thm:integers_are_euclidean_domain} states that the ring of integers is an Euclidean domain.

    \thmitem{ex:def:euclidean_domain/polynomials} \Fullref{thm:def:principal_ideal_domain/field_polynomials} characterizes Euclidean polynomial rings as univariate polynomial rings over fields.

    \thmitem{ex:def:euclidean_domain/not_euclidean} Principal ideal domain that are not euclidean are discussed in \cite{Anderson1988NonEuclideanPID}.
  \end{thmenum}
\end{example}

\begin{proposition}\label{thm:def:euclidean_domain}
  \hyperref[def:euclidean_domain]{Euclidean domains} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:euclidean_domain/pid} Every Euclidean domain is a \hyperref[def:principal_ideal_domain]{principal ideal domain}.

    \thmitem{thm:def:euclidean_domain/field} Every field is an \hyperref[def:euclidean_domain]{Euclidean domain}.

    \thmitem{thm:def:euclidean_domain/polynomials} For any given field \( \BbbK \), the \hyperref[def:polynomial_algebra]{polynomial algebra} \( \BbbK[X] \) via \fullref{alg:euclidean_division_of_polynomials} becomes an Euclidean domain when using the\hyperref[def:polynomial_degree]{polynomial degree} as a degree function.

    \thmitem{thm:def:euclidean_domain/nested_quot} We have
    \begin{equation}\label{eq:thm:def:euclidean_domain/nested_quot}
      \quot(\quot(a, b), c) = \quot(a, bc).
    \end{equation}
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:euclidean_domain/pid} This proof generalizes one direction of \fullref{thm:def:principal_ideal_domain/field_polynomials} by considering an element of minimal Euclidean degree rather than a polynomial of minimal degree.

  \SubProofOf{thm:def:euclidean_domain/field} By \fullref{thm:division_ring_is_entire}, a field is an integral domain. Since every pair from \( \BbbK \) is divisible without remainder as long as the denominator is nonzero, the Euclidean function can be arbitrary; for definiteness, we take it to be canonically zero.

  \SubProofOf{thm:def:euclidean_domain/polynomials} Trivial.
\end{proof}

\begin{algorithm}[Euclidean algorithm]\label{alg:euclidean_algorithm}
  In an \hyperref[def:euclidean_domain]{Euclidean domain}, we can explicitly construct a \hyperref[def:gcd]{greatest common divisor} \( g \) of arbitrary elements \( x \) and \( y \) as follows:
  \begin{thmenum}
    \thmitem{alg:euclidean_algorithm/base} Define \( r_0 \coloneqq x \) and \( r_1 \coloneqq y \).
    \thmitem{alg:euclidean_algorithm/step} Starting with \( k = 2 \), if \( r_{k-1} \) is zero, halt the algorithm with \( g \coloneqq r_{k-1} \).

    Otherwise, obtain a quotient \( q_k \) and remainder \( r_k \) so that
    \begin{equation*}
      r_{k-2} = r_{k-1} q_k + r_k.
    \end{equation*}

    Repeat \fullref{alg:euclidean_algorithm/step} with \( k + 1 \) instead of \( k \).
  \end{thmenum}
\end{algorithm}
\begin{comments}
  \item This algorithm can be found as \identifier{arithmetic.primes.gcd} in \cite{notebook:code}.
\end{comments}
\begin{defproof}
  Euclidean division ensures that, at the \( k \)-th step, either \( r_{k-1} \) is zero or \( r_k \) is zero or \( \delta(r_k) < \delta(r_{k-1}) \). Thus, there can only be finitely many steps where \( r_{k-1} \) is nonzero. So the algorithm halts.

  Let \( n \) be the index of the last nonzero remainder or \( 0 \) if \( x = 0 \). We show by induction on \( 0 \leq k < n \) that \( r_n \) divides \( r_{n-k} \).

  \begin{itemize}
    \item The base case \( k = 0 \) is obvious since \( r_n \) divides itself.
    \item If \( r_n \) divides \( r_{n-i} \) for \( 0 \leq i < k \), since
    \begin{equation*}
      r_{n-k} = r_{n-(k-1)} q_{n-(k-2)} + r_{n-(k-2)}
    \end{equation*}
    and both of the terms on the right-hand side are multiples of \( r_n \), the left-hand side \( r_{n-k} \) is also a multiple.
  \end{itemize}

  So, we conclude that \( r_n \) divides both \( r_{n-(n-1)} = r_1 = y \) and \( r_{n-n} = r_0 = x \).

  Finally, we must show that \( r_n \) is greatest among all common divisors of \( x \) and \( y \). Let \( d \) be a common divisor.

  We will use induction on \( k < n \) to show that \( d \mid r_k \).
  \begin{itemize}
    \item We have \( d \mid r_0 \) and \( d \mid r_1 \) by assumption.
    \item Fix \( 2 \leq k \leq n \) and suppose that, for every \( i < k \), \( d \mid r_i \). Then
    \begin{equation*}
      r_{k-1} = r_k q_{k+1} + r_{k+1},
    \end{equation*}
    and since \( i \) divides both \( r_{k-2} \) and \( r_{k-1} \), \( d \) also their linear combination \( r_{k+1} \).
  \end{itemize}

  Hence, \( d \mid r_n \). Since our choice of common divisor \( d \) was arbitrary, we conclude that \( r_n \) is a greatest common divisor.
\end{defproof}

\begin{algorithm}[Extended Euclidean algorithm]\label{alg:extended_euclidean_algorithm}
  In an \hyperref[def:euclidean_domain]{Euclidean domain}, given a pair \( x \) and \( y \), \fullref{alg:euclidean_algorithm} allows us to construct a greatest common divisor \( g \). We can also explicitly construct elements \( a \) and \( b \) so that Bezout's identity \eqref{eq:def:bezout_domain/identity} holds, i.e.
  \begin{equation*}
    g = ax + by.
  \end{equation*}

  The algorithm is as simple as defining the following in the inductive step \fullref{alg:euclidean_algorithm/step}:
  \begin{equation*}
    a_k \coloneqq \begin{cases}
      1,                     &k = 0, \\
      0,                     &k = 1, \\
      a_{k-2} - q_k a_{k-1}, &k > 1,
    \end{cases}
  \end{equation*}
  and
  \begin{equation*}
    b_k \coloneqq \begin{cases}
      0,                     &k = 0, \\
      1,                     &k = 1, \\
      b_{k-2} - q_k b_{k-1}, &k > 1.
    \end{cases}
  \end{equation*}

  If \( r_n \) is the latest nonzero remainder, halt the algorithm with \( a \coloneqq a_n \) and \( b \coloneqq b_n \).
\end{algorithm}
\begin{comments}
  \item This algorithm can be found as \identifier{arithmetic.primes.extended_gcd} in \cite{notebook:code}.
\end{comments}
\begin{defproof}
  We will prove with induction on \( k \leq n \) that
  \begin{equation*}
    r_k = a_k x + b_k y.
  \end{equation*}

  \begin{itemize}
    \item We have
    \begin{equation*}
      r_0 = x = 1 \cdot x + 0 \cdot y = a_0 x + b_0 y
    \end{equation*}
    and
    \begin{equation*}
      r_1 = y = 0 \cdot x + 1 \cdot y = a_1 x + b_1 y.
    \end{equation*}

    \item Fix \( 2 \leq k \leq n \) and suppose that \( r_i = a_i x + b_i y \) whenever \( i < n \). Then
    \begin{equation*}
      r_{k-2} = r_{k-1} q_k + r_k
    \end{equation*}
    becomes
    \begin{equation*}
      a_{k-2} x + b_{k-2} y = (a_{k-1} x + b_{k-1} y) q_k + r_k.
    \end{equation*}

    Therefore,
    \begin{equation*}
      r_k = (\underbrace{a_{k-2} - q_k a_{k-1}}_{a_k}) x + (\underbrace{b_{k-2} - q_k b_{k-1}}_{b_k}) y
    \end{equation*}
  \end{itemize}
\end{defproof}

\paragraph{Fields of fractions}

\begin{proposition}\label{thm:field_of_fractions}\mcite[110]{Lang2002Algebra}
  Let \( D \) be an \hyperref[def:integral_domain]{integral domain}. The \hyperref[def:ring_localization]{localization} of \( D \) at the zero ideal \( \set{ 0 } \) is a \hyperref[def:field]{field}, which we call the \term[bg=поле от частни (\cite[def. V.16]{ГеновМиховскиМоллов1991Алгебра}), ru=поле частных (\cite[26]{Шафаревич1999Алгебра})]{field of fractions} of \( D \).
\end{proposition}
\begin{defproof}
  Denote \( D \setminus \set{ 0 } \) by \( S \). We will show that \( S^{-1} D \) is indeed a field.

  By \fullref{thm:def:ring_localization/prime_ideals}, the localization by the prime ideal \( \set{ 0 } \) has only one maximal ideal --- \( S^{-1} \set{ 0 } \). Since \( 0 \) is absorbing, \( S^{-1} \set{ 0 } \) is again the zero ideal. Therefore, it is the only proper ideal of the localization \( S^{-1} D \), and hence the localization is a \hyperref[def:simple_object]{simple ring}.

  Since \( D \) is an integral domain, by \fullref{thm:def:ring_localization/injective_inclusion}, \( S^{-1} D \) is a superring of \( D \). It is therefore a nontrivial commutative simple ring, and thus it satisfies \fullref{def:field/simple}.
\end{defproof}

\begin{theorem}[Field of fractions universal property]\label{thm:field_of_fractions_universal_property}
  The \hyperref[thm:field_of_fractions]{field of fractions} \( \BbbK \) of the integral domain \( D \) satisfies the following \hyperref[rem:universal_mapping_property]{universal mapping property}:
  \begin{displayquote}
    For every field \( \BbbL \) and every ring homomorphism \( \varphi: D \to \BbbL \), \( \varphi \) \hyperref[def:factors_through]{uniquely factors through} \( \BbbK \). More precisely, there exists a unique field homomorphism \( \widetilde{\varphi}: \BbbK \to \BbbL \) such that the following diagram commutes:
    \begin{equation}\label{eq:thm:field_of_fractions_universal_property/diagram}
      \begin{aligned}
        \includegraphics[page=1]{output/thm__field_of_fractions_universal_property}
      \end{aligned}
    \end{equation}
  \end{displayquote}
\end{theorem}
\begin{proof}
  This is simply a special case of \fullref{thm:ring_localization_universal_property}.
\end{proof}

\begin{definition}\label{def:rational_function_field}\mcite[def. V.4.13]{Aluffi2009Algebra}
  The \term[bg=поле на рационалните функции (\cite[360]{ГеновМиховскиМоллов1991Алгебра}), ru=поле рациональных функций (\cite[18]{Шафаревич1999Алгебра})]{field of rational (algebraic) functions} \( D(\mscrX) \) for the set of indeterminates \( \mscrX \) over the \hyperref[def:integral_domain]{integral domain} \( D \) is the \hyperref[thm:field_of_fractions]{field of fractions} of the corresponding \hyperref[def:polynomial_algebra]{polynomial algebra} \( D[\mscrX] \).
\end{definition}
\begin{comments}
  \item Despite the name, elements of the field of fractions are not actually functions, but merely formal expressions. In particular, an analog of \fullref{thm:polynomial_algebra_universal_property} does not really make sense.
\end{comments}

\paragraph{Polynomial rings over domains}

\begin{proposition}\label{thm:polynomial_ring_over_gcd_domain}
  If the \hyperref[def:integral_domain]{integral domain} \( D \) is a \hyperref[def:gcd_domain]{greatest common divisor domain}, so is \( D[X] \).
\end{proposition}
\begin{proof}
  Let \( D \) be a GCD domain and let \( \BbbK \) be its \hyperref[thm:field_of_fractions]{field of fractions}.

  Let \( p(X) \) and \( q(X) \) be arbitrary polynomials in \( D[X] \). We will show that they have a greatest common divisor.

  By \fullref{thm:def:principal_ideal_domain/field_polynomials}, \( \BbbK[X] \) is an Euclidean domain, and thus \( p(X) \) and \( q(X) \) have a GCD in \( \BbbK[X] \), which is unique up to multiplication by an invertible element in \( \BbbK[X] \). Thus, taking an arbitrary GCD
  \begin{equation*}
    r(X) = \sum_{k=0}^n \frac {a_k} {b_k} X^k,
  \end{equation*}
  the polynomial \( b_0 \cdots b_n r(X) \) is also a GCD. Furthermore, the latter is actually a polynomial in \( D[X] \).

  Therefore, \( p(X) \) and \( q(X) \) have a GCD in \( D[X] \).
\end{proof}

\begin{definition}\label{def:primitive_polynomial}\mcite[394]{Knapp2016BasicAlgebra}
  We say that a polynomial \( p(X) \) in a \hyperref[def:gcd_domain]{GCD domain} is \term[bg=примитивен (полином) (\cite[43]{ГеновМиховскиМоллов1991Алгебра}), ru=примитивный (многочлен) (\cite[124]{Винберг2014Алгебра})]{primitive} if its coefficients have an invertible \hyperref[def:gcd]{greatest common divisor}.
\end{definition}
\begin{comments}
  \item For a \hyperref[def:bezout_domain]{Bezout domain}, this condition is equivalent to the coefficients being \hyperref[def:coprime_elements]{coprime}.
\end{comments}

\begin{lemma}[Gauss' lemma]\label{thm:gauss_lemma}
  If \( p(X) \) and \( q(X) \) are \hyperref[def:primitive_polynomial]{primitive polynomials}, then so is \( p(X) q(X) \).
\end{lemma}
\begin{proof}
  Fix two primitive polynomials
  \begin{align*}
    p(X) = \sum_{k=0}^n a_k X^k,
    &&
    q(X) = \sum_{k=0}^m b_k X^k.
  \end{align*}

  Let \( d \) be a GCD of the coefficients of \( p(X) q(X) \). It divides
  \begin{equation*}
    \sum_{i+j=k} a_i b_j,
  \end{equation*}
  the \( k \)-th coefficient of \( p(X) q(X) \), and hence also \( a_i b_j \) for every particular pair of indices \( i < n \) and \( j < m \).

  In particular, for a fixed index \( i \), \( d \) simultaneously divides \( a_i b_1, a_i b_2, \ldots, a_i b_m \).

  Suppose that \( d \) is not invertible. Then there exists a prime element \( p \) that divides \( d \), and hence also the aforementioned products. Since it is prime, \( p \) must divide \( a_i \) or \( b_1 \), \( a_i \) or \( b_2 \), etc.

  But \( p \) cannot divide each one of \( b_1, \ldots, b_m \) because that would imply that \( g(X) \) is not primitive. It then follows that \( p \) divides \( a_i \) for a fixed value of \( i \). Generalizing on \( i \), we conclude that \( p \) divides \( a_1, \ldots, a_n \), which implies that \( f(X) \) is not primitive.

  But both \( f(X) \) and \( g(X) \) are primitive by assumption. Then we have reached a contradiction with the assumption that \( d \) is not invertible.

  Therefore, \( d \) is an invertible GCD of the coefficients of \( p(X) q(X) \), meaning that \( p(X) q(X) \) is a primitive polynomial.
\end{proof}

\begin{lemma}\label{thm:irreducible_primitive_polynomial_in_field_of_fractions}
  Let \( D \) be a \hyperref[def:gcd_domain]{GCD domain} and let \( \BbbK \) be its \hyperref[thm:field_of_fractions]{field of fractions}. If the polynomial \( p(X) \) from \( \BbbK[X] \) is \hyperref[def:domain_divisibility/irreducible]{irreducible} (in \( \BbbK[X] \)), then there exists a scalar \( c \) from \( \BbbK \) and an irreducible in \( D[X] \) primitive polynomial \( q(X) \) such that \( p(X) = c \cdot q(X) \).
\end{lemma}
\begin{proof}
  Let \( p(X) \) be irreducible in \( \BbbK[X] \). It has the form
  \begin{equation*}
    p(X) = \sum_{k=1}^n \frac {a_k} {b_k} X^k.
  \end{equation*}

  Clearly \( b_1 \cdots b_n p(X) \) is in \( D[X] \). Let \( d \) be a GCD (in \( D \)) of the coefficients of \( b_1 \cdots b_n p(X) \). Let \( c \coloneqq d / b_1 \cdots b_n \) and define the following polynomial:
  \begin{equation*}
    q(X) \coloneqq \frac {p(X)} c.
  \end{equation*}

  By construction, \( q(X) \) is a primitive polynomial with coefficients in \( D \). Furthermore, as a scalar multiple of the irreducible in \( \BbbK[X] \) polynomial \( p(X) \), \( q(X) \) is also irreducible in \( \BbbK[X] \).

  We will now show that \( q(X) \) is irreducible in \( D[X] \). Let \( q(X) = f(X) g(X) \), where both multiplicands are from \( D[X] \).

  Since \( q(X) \) is irreducible in \( \BbbK[X] \), at least one of \( f(X) \) or \( g(X) \) is invertible in \( \BbbK[X] \), hence it is a nonzero constant polynomial. Without loss of generality, suppose that this is \( f(X) \) and let \( f(X) = f_0 \).

  Then \( f_0 \) is a common divisor of the coefficients of \( q(X) \). Since \( q(X) \) is primitive in \( D[X] \), it follows that \( f_0 \) is invertible in \( D \).

  Therefore, \( q(X) \) is irreducible in \( D[X] \) and
  \begin{equation*}
    p(X) = c \cdot p(X).
  \end{equation*}
\end{proof}

\begin{proposition}\label{thm:polynomial_ring_over_factorial}
  If the \hyperref[def:integral_domain]{integral domain} \( D \) is a \hyperref[def:factorial_domain]{factorial domain}, so is \( D[X] \).
\end{proposition}
\begin{proof}
  Let \( D \) be a factorial domain and let \( \BbbK \) be its \hyperref[thm:field_of_fractions]{field of fractions}.

  By \fullref{thm:polynomial_ring_over_gcd_domain}, \( D[X] \) is a GCD domain. Then every irreducible element is prime as a shown in \fullref{thm:def:gcd_domain/irreducible_is_prime}, and \fullref{thm:def:irreducible_factorization/uniqueness} implies that, if an element has at least one \hyperref[def:irreducible_factorization]{irreducible factorization}, all others are equivalent to it.

  We will now show existence of irreducible factorizations.

  Let \( p(X) \) be a polynomial from \( D[X] \). It has an irreducible factorization in \( \BbbK[X] \):
  \begin{equation*}
    p(X) = u q_1(X) \cdots q_n(X).
  \end{equation*}

  For every \( q_i(X) \), \fullref{thm:irreducible_primitive_polynomial_in_field_of_fractions} gives us a constant \( c_i \) and an irreducible in \( D[X] \) primitive polynomial \( r_i(X) \) such that
  \begin{equation*}
    q_i(X) = c_i \cdot r_i(X).
  \end{equation*}

  Then
  \begin{equation*}
    p(X)
    =
    u \cdot q_1(X) \cdots q_n(X)
    =
    u c_1 \cdots c_n \cdot r_1(X) \cdots r_n(X).
  \end{equation*}

  Let \( \alpha \) be a GCD of the coefficients of \( p(X) \) and denote the product \( u c_1 \cdots c_n \) by \( \beta \). We have
  \begin{equation*}
    p(X) = \alpha \cdot \frac {p(X)} \alpha = \beta \cdot r_1(X) \cdots r_n(X).
  \end{equation*}

  The polynomial \( p(X) / \alpha \) is primitive by construction, and \( r_1(X) \cdots r_n(X) \) is primitive by \fullref{thm:gauss_lemma}. Then \( \alpha \) necessarily divides \( \beta \) and vice versa, hence they are associated, and so \( \beta = v \alpha \), where \( v \) is invertible.

  Finally, let \( \alpha = w t_1 \cdots t_m \) be an irreducible decomposition of \( \alpha \). \Fullref{thm:def:domain_divisibility/irreducible_in_polynomial_ring} implies that \( t_1 \cdots t_m \) are irreducible in \( D[X] \).

  Then
  \begin{equation*}
    p(X) = \underbrace{(v w) \cdot t_1 \cdots t_m}_{\beta} \cdot r_1(X) \cdots r_n(X)
  \end{equation*}
  is an irreducible factorization of \( p(X) \) in \( D[X] \).
\end{proof}
