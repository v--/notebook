\section{Recurrence relations}\label{sec:recurrence_relations}

\paragraph{General recurrence relations}

\begin{definition}\label{def:recurrence_relation}\mimprovised
  A \term[ru=рекуррентное уравнение (\cite[21]{Юмагулов2015Динамика}), en=recurrence relation (\cite[def. 2.4.4]{Rosen2019DiscreteMathematics})]{recurrence relation} or simply a \term{recurrence} of \term[en=order (of linear recurring sequence) (\cite[395]{LidlNiederreiter1997FiniteFields})]{order} \( k \) is a specification for building \hyperref[def:sequence]{sequences} given only the first \( k \) terms --- the \term{initial values}.

  We can characterize a recurrence by a function \( F: \BbbZ_{\geq 0} \times S^k \to S \), which gives rise to the \hyperref[def:equation]{equation}
  \begin{equation}\label{eq:def:recurrence_relation}
    X_{N+k} = F(N, X_{N+k-1}, \ldots, X_N).
  \end{equation}

  Formally, we can regard \( F \) as a \hyperref[con:expression]{metalinguistic expression}, and the entire equation \eqref{eq:def:recurrence_relation} as a string of symbols. Here \( N, X_N, \ldots, X_{N+k} \) are \hyperref[con:variable_binding]{free variables} acting as \hyperref[con:indeterminates]{indeterminates}; we use the capital letter convention from \fullref{rem:conventions_for_indeterminates} to make the exposition more precise.

  \begin{thmenum}
    \thmitem{def:recurrence_relation/sequence} We say that the sequence \( \seq{ x_n }_{n=0}^\infty \) \term{satisfies} the recurrence \eqref{eq:def:recurrence_relation} if it, for every nonnegative \( n \), we have
    \begin{equation}\label{eq:def:recurrence_relation/sequence}
      x_{n+k} = F(n, x_{n+k-1}, \ldots, x_n)
    \end{equation}

    We may also refer to it as a \term[ru=рекуррентная последовательность (\cite[21]{Юмагулов2015Динамика}), en=(linear) recurrent sequence (\cite[395]{LidlNiederreiter1997FiniteFields})]{recurrent sequence}.

    \thmitem{def:recurrence_relation/state}\mcite[397]{LidlNiederreiter1997FiniteFields} We define the \( n \)-th \term{state vector} of a recurrent sequence is the \hyperref[def:array/column_vector]{column vector}
    \begin{equation*}
      \begin{pmatrix}
        x_n & x_{n+1} & \ldots & x_{n+k}.
      \end{pmatrix}^T
    \end{equation*}

    For the \( 0 \)-th state vector, we prefer the term \term{initial vector}.

    \thmitem{def:recurrence_relation/autonomous} In analogy with dynamical systems, we say that the recurrence is \term{autonomous} if it does not depend on \( N \) --- that is, if evaluating the function with different values of \( N \) gives identical results.

    \thmitem{def:recurrence_relation/degenerate} If the function \( F \) is constant, we say that the recurrence is \term{degenerate}.

    A nondegenerate recurrence necessarily has at least one indeterminate.
  \end{thmenum}
\end{definition}
\begin{comments}
  \item Recurrence relations generalize \fullref{thm:omega_recursion} to \( n > 1 \).

  \item Our definition mostly resembles that in \bycite[21]{Юмагулов2015Динамика}, however we allow the recurrence to depend on \( n \), and also highlight the metalogical aspect of the definition. A similar definition, albeit only for linear recurrence relations, is given by \incite[395]{LidlNiederreiter1997FiniteFields}.

  \item We have stated that a recurrence relation is determined by an equation, but did not conflate the two. This distinction is intensional.

  \incite[21]{Юмагулов2015Динамика} calls recurrence relations \enquote{рекуррентные уравнения} (\enquote{recurrent equations}), while \incite[def. 2.4.4]{Rosen2019DiscreteMathematics} defines a recurrence relation as an equation. The former term suggests that recurrent equations are variations rather than subtypes of equations, but the latter is flawed --- it would, in our case, suggest that a solution to \eqref{eq:def:recurrence_relation} should, in accordance with \fullref{def:equation/solution}, be an \( (n + 1) \)-tuple \( (x_n, x_{n+1}, \ldots, x_{n+k}) \). Not only do we want the equation satisfied by any contiguous subsequence of length \( (n + 1) \), but also we regard \( x_k \) as a value to be defined rather than something that has been given.

  For this reason, we highlight that a recurrence relation is defined by an equation, but is itself not an equation.

  \item We avoid referring to recurrent sequences as \enquote{solutions} to recurrences because \enquote{solving a recurrence} can also refer to \fullref{thm:linear_recurrence_unwinding}. \incite[def. 2.4.4]{Rosen2019DiscreteMathematics} calls recurrent sequences \enquote{solutions} even though section 8.2 is called \enquote{Solving Linear Recurrence Relations} and describes what we call unwinding.

  \item Although we generally start indexing from \( 1 \), as discussed in \fullref{rem:peano_arithmetic_zero}, here we index the indeterminates from \( 0 \) to \( k - 1 \) --- as we shall see, this turns out to be important for \hyperref[def:linear_recurrence_characteristic_polynomial]{characteristic polynomials}. This also allows us to keep compatibility with \incite[395]{LidlNiederreiter1997FiniteFields}), \incite[def. 2.4.4]{Rosen2019DiscreteMathematics} and \incite[21]{Юмагулов2015Динамика}.

  For similar reasons we use \( k \) for the number of indeterminates despite generally preferring \( n \) for cardinality and \( k \) for indexing.
\end{comments}

\begin{remark}\label{rem:unrestricted_recurrence_relation}
  In \fullref{def:recurrence_relation} we defined recurrence relations of \hi{finite} order \( k \) with equations of the form
  \begin{equation*}
    X_{N+k} = F(N, X_{N+k-1}, \ldots, X_N).
  \end{equation*}

  This allows us to study sequences \( \seq{ x_n }_{n=0}^\infty \) satisfying the equation for every \( n \geq k \).

  There are important generalizations which are \hi{unrestricted} in the sense that \( x_n \) may depend on the entire subsequence \hyperref[def:truncated_sequence]{truncated} up to \( n - 1 \). In these cases it is simpler to avoid discussing \hyperref[con:metalanguage]{metasyntax} and ignore abstract recurrence relations, instead focusing on each sequence separately.

  For example, \incite{AkraBazzi1998Recurrences} study recurrent sequences of a very specific form:
  \begin{equation*}
    u_n = \begin{cases}
      u_0                                        &n = 0, \\
      \sum_{i=1}^k a_i u_{\floor(n, b_i)} + g(n) &n > 0,
    \end{cases}
  \end{equation*}
  where
  \begin{itemize}
    \item \( u_0 \) and \( a_1, \ldots, a_k \) are positive real numbers such that \( a_1 + \cdots + a_k \geq 1 \).
    \item \( k \geq 1 \) and \( b_i \geq 2 \) for every \( i = 1, \ldots, k \).
    \item \( g \) is a bounded, positive and nondecreasing real-valued function, with the following restriction: for every \( c > 1 \) there exist positive real numbers \( x_1 \) and \( k_1 \) such that \( g(x / c) \geq k_1 g(x) \) whenever \( x \geq x_1 \).
  \end{itemize}
\end{remark}

\begin{definition}\label{def:recurrence_relation_space}\mimprovised
  A sequence \hyperref[def:recurrence_relation/sequence]{satisfying} an \hyperref[def:recurrence_relation]{autonomous recurrence} of order \( k \) over the \hyperref[def:ring/commutative]{commutative ring} \( R \) is determined by its \hyperref[def:recurrence_relation/state]{initial vector} from the \hyperref[def:sequence_space]{coordinate space} \( R^k \). All sequences satisfying the relation then form a \hyperref[def:module]{module} isomorphic to \( R^k \). We will call it the \term{space of initial vectors}.

  We single out two particular sequences --- the \term{zero sequence} whose initial values are all zero and the \term[en=impulse response sequence (\cite[402]{LidlNiederreiter1997FiniteFields})]{impulse response sequence} whose initial values are all zero except the last, which is one.
\end{definition}
\begin{comments}
  \item We could use \enquote{unit sequence} instead of \enquote{impulse response sequences}, but this would be more ambiguous. As pointed out in \incite[402]{LidlNiederreiter1997FiniteFields}, whose term we use,
  \begin{displayquote}
    We can think of this sequence as being obtained by starting with the state in which each delay element is \enquote{empty} (i.e., contains
\( 0 \)) and then sending the \enquote{impulse} \( 1 \) into the rightmost delay element.
  \end{displayquote}

  \item If \( k = 0 \), there is only one initial vector, and thus the impulse response sequence and the zero sequence are both the zero sequence.
\end{comments}

\begin{example}\label{ex:def:recurrence_relation}
  We list some examples of \hyperref[def:recurrence_relation]{recurrence relations}:
  \begin{thmenum}
    \thmitem{ex:def:recurrence_relation/linear} We will consider several important linear recurrences later in this section --- arithmetic progressions defined in \fullref{def:arithmetic_progression}, geometric progressions defined in \fullref{def:geometric_progression}, the Fibonacci recurrence defined in \fullref{def:fibonacci_numbers}, as well as examples in \fullref{ex:thm:linear_recurrences_with_maximal_period}.

    \thmitem{ex:def:recurrence_relation/constant} Every constant sequence \( c, c, c, \ldots \) satisfies the \hyperref[def:recurrence_relation/degenerate]{degenerate} recurrence
    \begin{equation*}
      X_N = c.
    \end{equation*}

    If the recurrence has positive order \( k > 0 \), it is possible for the first \( k \) terms of the sequence to be distinct from \( c \); in this case the recurrence equation has the form
    \begin{equation*}
      X_{N+k} = c.
    \end{equation*}

    The nondegenerate recurrence
    \begin{equation*}
      X_{N+1} = X_N
    \end{equation*}
    instead produces constant sequences repeating the initial value.

    \thmitem{ex:def:recurrence_relation/factorial} The factorial function, which we defined in \fullref{def:factorial} as
    \begin{equation*}
      n! \coloneqq \begin{cases}
        1,                &n = 0, \\
        (n - 1)! \cdot n, &n > 0,
      \end{cases}
    \end{equation*}
    satisfies the non-autonomous recurrence
    \begin{equation*}
      X_{N+1} = X_N \cdot n.
    \end{equation*}

    \thmitem{ex:def:recurrence_relation/triangular_numbers} Similarly, triangular numbers, which we characterized algebraically in \fullref{def:triangular_number/arithmetic} as
    \begin{equation*}
      \sum_{k=1}^n k
    \end{equation*}
    satisfy the recurrence
    \begin{equation*}
      X_{N+1} = X_N + n.
    \end{equation*}

    \thmitem{ex:def:recurrence_relation/2n} Consider the sequence
    \begin{equation*}
      x_n \coloneqq \begin{cases}
        0,            &n = 0, \\
        2x_{n-1} + 1, &n > 0.
      \end{cases}
    \end{equation*}

    It clearly satisfies the autonomous recurrence
    \begin{equation*}
      X_{N+1} = 2X_N + 1.
    \end{equation*}

    It is less obvious that it also satisfies the order \( 0 \) non-autonomous recurrence
    \begin{equation*}
      X_N = 2^N - 1.
    \end{equation*}

    This can be shown by induction --- the base case is obvious, while
    \begin{equation*}
      x_{n+1}
      =
      2x_n + 1
      \reloset {\T{ind.}} =
      2(2^n - 1) + 1
      =
      2^{n+1} - 2 + 1
      =
      2^{n+1} - 1,
    \end{equation*}
    as desired.

    We provide a systematic generalization in \fullref{thm:linear_recurrence_unwinding}.

    \thmitem{ex:def:recurrence_relation/powers} The recurrence
    \begin{equation*}
      X_{N+1} = X_N^q
    \end{equation*}
    simply lists the successive \( q \)-th powers of its initial value, i.e.
    \begin{equation*}
      x_0, x_0^q, x_0^{q^2}, \cdots
    \end{equation*}

    Such a sequence occurs in \fullref{thm:irreducible_polynomial_over_finite_field}, where, if \( \alpha \) is a root of an irreducible polynomial of degree \( n \) over a finite field, its other roots are
    \begin{equation*}
      \alpha^q, \alpha^{q^2}, \cdots, \alpha^{q^{n-1}}
    \end{equation*}
  \end{thmenum}
\end{example}

\paragraph{Linear recurrence relations}

\begin{definition}\label{def:linear_recurrence}\mcite[395]{LidlNiederreiter1997FiniteFields}
  We will mostly consider \hyperref[def:recurrence_relation/autonomous]{autonomous} \hyperref[def:recurrence_relation]{recurrence relation} given by a \hyperref[def:polynomial_degree_terminology]{linear} \hyperref[def:algebraic_equation]{algebraic equation}. We will unsurprisingly call such recurrence relations \term{linear}.

  We will find it convenient to index the indeterminates and coefficients as follows:
  \begin{equation}\label{eq:def:linear_recurrence}
    X_{N+k} = \sum_{i=1}^k a_{k-i} X_{N+k-i} + a.
  \end{equation}
\end{definition}
\begin{comments}
  \item Degenerate linear recurrent sequences are constant except possibly for the first term.
  \item When describing such recurrences, \incite[def. 8.2.1]{Rosen2019DiscreteMathematics} states that they have \enquote{constant coefficients}, emphasizing that it is possible for the coefficients \( a_{k-i} \) to depend on \( N \).

  Examples of \enquote{non-constant coefficients} can be found in the linear recurrences studied by \incite{AkraBazzi1998Recurrences}, in which the order \( 0 \) coefficient \( a \) is allowed to vary with \( N \), i.e. to not be a constant. We briefly mention these recurrences in \fullref{rem:unrestricted_recurrence_relation}.

  Our restriction to autonomous recurrences allows us to state and prove useful results.
\end{comments}

\begin{definition}\label{def:homogeneous_linear_recurrence}\mcite[395]{LidlNiederreiter1997FiniteFields}
  If the equation of a \hyperref[def:linear_recurrence]{linear recurrence relation} is \hyperref[def:homogeneous_equation]{homogeneous}, we will call the recurrence \term{homogeneous}.
\end{definition}

\begin{proposition}\label{thm:linear_recurrence_relation_homogenization}
  The \hyperref[def:recurrence_relation/degenerate]{nondegenerate} \hyperref[def:homogeneous_linear_recurrence]{inhomogeneous} \hyperref[def:linear_recurrence]{linear recurrence}
  \begin{equation*}
    X_{N+k} = \sum_{i=1}^k a_{k-i} X_{N+k-i} + a
  \end{equation*}
  can be homogenized by introducing an additional indeterminate:
  \begin{equation}\label{eq:thm:linear_recurrence_relation_homogenization}
    X_{N+k+1}
    =
    (a_{k-1} + 1) X_{N+k} + \sum_{i=1}^{k-1} (a_{k-(i+1)} - a_{k-i}) X_{N-(k-i)} - a_0 X_n.
  \end{equation}
\end{proposition}
\begin{comments}
  \item It should be noted that different inhomogeneous relations can have the same homogenization --- for example, those differing only by their free coefficient. See \fullref{thm:arithmetic_progression_homogeneization}.
\end{comments}
\begin{proof}
  We simply have to substitute
  \begin{equation*}
    a = X_{N+k} - \sum_{i=1}^k a_{k-i} X_{N+k-i}
  \end{equation*}
  in
  \begin{equation*}
    X_{N+k+1} = \sum_{i=0}^{k-1} a_{k-(i+1)} X_{N+k-i} + a
  \end{equation*}

  Formally, since the above are merely polynomials and not sequences we can manipulate, we obtain the second equality by evaluating the variable \( X_{N+k-i} \mapsto X_{(n+1)+k-i} \) for \( i = 0, \ldots, k \).
\end{proof}

\begin{definition}\label{def:homogeneous_linear_recurrence_matrix}\mimprovised
  To the \hyperref[def:homogeneous_linear_recurrence]{homogeneous linear recurrence}
  \begin{equation*}
    X_{N+k} = \sum_{i=1}^k a_{k-i} X_{N+k-i}
  \end{equation*}
  we associate the matrix
  \begin{equation}\label{eq:def:homogeneous_linear_recurrence}
    \begin{pmatrix}
      0      & 1      & 0      & \cdots & 0      \\
      0      & 0      & 1      & \cdots & 0      \\
      \vdots & \vdots & \vdots & \ddots & \vdots \\
      0      & 0      & 0      & \cdots & 1      \\
      a_0    & a_1    & a_2    & \cdots & a_{k-1}
    \end{pmatrix}
  \end{equation}
\end{definition}
\begin{comments}
  \item We take the transpose of the matrix defined by \incite[401]{LidlNiederreiter1997FiniteFields}.
  \item If \( k = 0 \), we simply obtain the \hyperref[ex:def:array/zero_dimensional]{zero-dimensional matrix}.
\end{comments}

\begin{proposition}\label{thm:homogeneous_linear_recurrence_matrix_action}
  Consider the \hyperref[def:homogeneous_linear_recurrence]{homogeneous linear recurrent sequence}
  \begin{equation*}
    x_{n+k} = \sum_{i=1}^k a_{k-i} x_{n+k-i}.
  \end{equation*}

  Its \hyperref[def:homogeneous_linear_recurrence_matrix]{associated matrix} satisfies the following identity for all positive integers \( m \) and \( n > k \):
  \begin{equation}\label{eq:thm:linear_recurrence_relation}
    \begin{pmatrix}
      x_{n+m}       \\
      x_{n+1+m}     \\
      \vdots        \\
      x_{n+(k-2)+m} \\
      x_{n+(k-1)+m}
    \end{pmatrix}
    =
    \begin{pmatrix}
      0      & 1      & 0      & \cdots & 0      \\
      0      & 0      & 1      & \cdots & 0      \\
      \vdots & \vdots & \vdots & \ddots & \vdots \\
      0      & 0      & 0      & \cdots & 1      \\
      a_0    & a_1    & a_2    & \cdots & a_{k-1}
    \end{pmatrix}^m
    \begin{pmatrix}
      x_{n}       \\
      x_{n+1}     \\
      \vdots      \\
      x_{n+(k-2)} \\
      x_{n+(k-1)}
    \end{pmatrix}.
  \end{equation}

  If we denote the matrix by \( A \) and the \hyperref[def:recurrence_relation/state]{state vectors} by \( s_n \), we obtain the more succinct equality
  \begin{equation}\label{eq:thm:homogeneous_linear_recurrence_matrix_action/state}
    s_{n+m} = A^m s_n.
  \end{equation}
\end{proposition}
\begin{proof}
  Straightforward induction on \( m \).
\end{proof}

\begin{definition}\label{def:linear_recurrence_characteristic_polynomial}\mcite[404]{LidlNiederreiter1997FiniteFields}
  We define the \term{characteristic polynomial} of the \hyperref[def:homogeneous_linear_recurrence]{homogeneous linear recurrence}
  \begin{equation*}
    X_{N+k} = \sum_{i=1}^k a_{k-i} X_{N+k-i}
  \end{equation*}
  as
  \begin{equation}\label{eq:def:linear_recurrence_characteristic_polynomial}
    \chi(X) = X^n - \sum_{i=1}^k a_{k-i} X^{k-i}.
  \end{equation}
\end{definition}

\begin{proposition}\label{thm:linear_recurrence_characteristic_polynomial_via_matrix}
  The characteristic polynomial, in the sense of \fullref{def:linear_recurrence_characteristic_polynomial}, of a \hyperref[def:homogeneous_linear_recurrence]{homogeneous linear recurrence} equals the characteristic polynomial, in the sense of \fullref{def:linear_operator_characteristic_polynomial}, of its \hyperref[def:homogeneous_linear_recurrence_matrix]{associated matrix}.
\end{proposition}
\begin{proof}
  We can use \fullref{thm:laplace_expansion} on the last column:
  \begin{align*}
    &\phantom{{}={}}
    \det \begin{pmatrix}
      \Lambda & -1      & 0       & \cdots & 0        & 0      \\
      0       & \Lambda & -1      & \cdots & 0        & 0      \\
      \vdots  & \vdots  & \vdots  & \ddots & \vdots   & \vdots \\
      0       & 0       & 0       & \cdots & \Lambda  & -1     \\
      -a_0    & -a_1    & -a_2    & \cdots & -a_{k-2} & \Lambda - a_{k-1}
    \end{pmatrix}
    = \\ &=
    (-1)^{n+n} \cdot (\Lambda - a_{k-1}) \cdot
    \det \begin{pmatrix}
      \Lambda & -1      & 0       & \cdots & 0       & 0      \\
      0       & \Lambda & -1      & \cdots & 0       & 0      \\
      \vdots  & \vdots  & \vdots  & \ddots & \vdots  & \vdots \\
      0       & 0       & 0       & \cdots & \Lambda & -1     \\
      0       & 0       & 0       & \cdots & 0       & \Lambda
    \end{pmatrix}
    + \\ &+
    (-1)^{n+(n-1)} \cdot (-1) \cdot
    \det \begin{pmatrix}
      \Lambda & -1      & 0       & \cdots & 0        & 0      \\
      0       & \Lambda & -1      & \cdots & 0        & 0      \\
      \vdots  & \vdots  & \vdots  & \ddots & \vdots   & \vdots \\
      0       & 0       & 0       & \cdots & \Lambda  & -1     \\
      -a_0    & -a_1    & -a_2    & \cdots & -a_{k-3} & -a_{k-2}
    \end{pmatrix}
  \end{align*}

  The first matrix is diagonal, so, by \fullref{thm:def:triangular_matrix/determinant}, its determinant is \( \Lambda^{n-1} \).

  For the second determinant, we can easily derive a recursive dependency:
  \begin{align*}
    &\phantom{{}={}}
    \det \begin{pmatrix}
      \Lambda & -1      & 0       & \cdots & 0        & 0      \\
      0       & \Lambda & -1      & \cdots & 0        & 0      \\
      \vdots  & \vdots  & \vdots  & \ddots & \vdots   & \vdots \\
      0       & 0       & 0       & \cdots & \Lambda  & -1     \\
      -a_0    & -a_1    & -a_2    & \cdots & -a_{k-3} & -a_{k-2}
    \end{pmatrix}
    = \\ &=
    (-1)^{(n-1)+(n-1)} \cdot (-a_{n-2}) \cdot
    \det \begin{pmatrix}
      \Lambda & -1      & 0       & \cdots & 0       & 0      \\
      0       & \Lambda & -1      & \cdots & 0       & 0      \\
      \vdots  & \vdots  & \vdots  & \ddots & \vdots  & \vdots \\
      0       & 0       & 0       & \cdots & \Lambda & -1     \\
      0       & 0       & 0       & \cdots & 0       & \Lambda
    \end{pmatrix}
    + \\ &+
    (-1)^{(n-1)+(n-2)} \cdot (-1) \cdot
    \det \begin{pmatrix}
      \Lambda & -1      & 0       & \cdots & 0        & 0      \\
      0       & \Lambda & -1      & \cdots & 0        & 0      \\
      \vdots  & \vdots  & \vdots  & \ddots & \vdots   & \vdots \\
      0       & 0       & 0       & \cdots & \Lambda  & -1     \\
      -a_0    & -a_1    & -a_2    & \cdots & -a_{k-4} & -a_{k-3}
    \end{pmatrix}
    = \\ &=
    (-a_{n-2}) \cdot \Lambda^{n-2} + \cdots
  \end{align*}

  Therefore, the characteristic polynomial of the matrix is
  \begin{equation*}
    (\Lambda - a_{k-1}) \Lambda^{n-1} + \sum_{i=2}^n (-a_{n-i}) \Lambda^{n-i}
    =
    \Lambda^n - \sum_{i=1}^k a_{n-i} \Lambda^{n-i}.
  \end{equation*}
\end{proof}

\begin{proposition}\label{thm:linear_recurrence_characteristic_roots}
  Consider the \hyperref[def:linear_recurrence_characteristic_polynomial]{characteristic polynomial}
  \begin{equation*}
    \chi(X) = X^n - \sum_{i=1}^k a_{k-i} X^{k-i},
  \end{equation*}
  of the corresponding \hyperref[def:homogeneous_linear_recurrence]{homogeneous linear recurrence}.

  \begin{thmenum}
    \thmitem{thm:linear_recurrence_characteristic_roots/satisfaction} If \( \alpha \) is a root of \( \chi \), the sequence \( \seq{ \alpha^n }_{n=0}^\infty \) satisfies the recurrence.

    \thmitem{thm:linear_recurrence_characteristic_roots/eigenvector} If \( \alpha \) is a root of \( \chi \), then \( (1, \alpha, \ldots, \alpha^{k-1}) \) is an \hyperref[def:eigenpair]{eigenvector} of \( \alpha \) of the recurrence's \hyperref[def:homogeneous_linear_recurrence_matrix]{associated matrix}.

    \thmitem{thm:linear_recurrence_characteristic_roots/independent} If \( \alpha_1, \ldots, \alpha_m \) are distinct roots of \( \chi \), the corresponding initial vectors \( (1, \alpha_i, \ldots, \alpha_i^{m-1}) \) are linearly independent.
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:linear_recurrence_characteristic_roots/satisfaction} If \( \alpha \) is a root of \( \chi \), then
  \begin{equation*}
    \alpha^k = \sum_{i=1}^n a_{k-i} \alpha^{k-i}.
  \end{equation*}

  Multiplying by \( \alpha^n \), where \( n \geq k \), we obtain
  \begin{equation*}
    \alpha^{n+k}
    =
    \sum_{i=1}^n a_{k-i} \alpha^{n+k-i},
  \end{equation*}
  as desired.

  \SubProofOf{thm:linear_recurrence_characteristic_roots/eigenvector} Follows from \fullref{thm:homogeneous_linear_recurrence_matrix_action}.

  \SubProofOf{thm:linear_recurrence_characteristic_roots/independent} \Fullref{thm:homogeneous_linear_recurrence_matrix_action} implies that the initial vector \( (1, \alpha_i, \ldots, \alpha_i^{k-1}) \) is an eigenvector corresponding to \( \alpha_i \). Then, by \fullref{thm:def:eigenpair/independent}, the vectors corresponding to distinct eigenvalues are linearly independent.
\end{proof}

\begin{theorem}[Linear recurrence unwinding]\label{thm:linear_recurrence_unwinding}
  Consider the \hyperref[def:homogeneous_linear_recurrence]{homogeneous linear recurrence}
  \begin{equation*}
    X_{N+k} = \sum_{i=1}^k a_{k-i} X_{N+k-i}.
  \end{equation*}

  Suppose that its \hyperref[def:linear_recurrence_characteristic_polynomial]{characteristic polynomial} has \( k \) distinct roots \( \alpha_1, \ldots, \alpha_k \).

  Then, for every sequence \( \seq{ x_n }_{n=0}^\infty \) satisfying the recurrence, there exist scalars \( c_1, \ldots, c_k \) such that, for every index \( n \), we have
  \begin{equation}\label{eq:thm:linear_recurrence_unwinding}
    x_n = \sum_{j=1}^k c_j \alpha_j^n.
  \end{equation}
\end{theorem}
\begin{comments}
  \item The gist is to find a non-recurrent \hyperref[con:expression]{expression} for arbitrary terms of the sequence; this expression does not depend on the recurrence equation, but is different for every choice of initial vectors.

  \item The process of obtaining the coefficients \( c_1, \ldots, c_k \) is informally referred to as \enquote{solving} the recurrence, for example by \incite[\S 8.2]{Rosen2019DiscreteMathematics}. We prefer the term \enquote{unwinding} since it avoid collisions with sequences satisfying a recurrence, which are called \enquote{solutions}, even in the aforementioned book.

  \item See \fullref{thm:geometric_progression_unwinding} and \fullref{thm:fibonacci_sequence_unwinding} for examples of how this theorem can be used and \fullref{ex:arithmetic_progression_unwinding_as_recurrence} for how its generalizations can fail.
\end{comments}
\begin{proof}
  \Fullref{thm:linear_recurrence_characteristic_roots/independent} implies that the family of eigenvectors
  \begin{equation*}
    (1, \alpha_j, \alpha_j^2, \ldots, \alpha_j^{k-1}),
  \end{equation*}
  where \( j = 1, \ldots, k \), is linearly independent, and hence a basis in the \hyperref[def:recurrence_relation_space]{space of initial vectors}.

  Then
  \begin{equation*}
    (x_0, x_1, \ldots, x_{k-1})
  \end{equation*}
  is a linear combination of the aforementioned.

  Let \( c_1, \ldots, c_k \) be the coefficients of this combination. Thus, for \( n < k \), we have
  \begin{equation*}
    x_n = \sum_{j=1}^k c_j \alpha_j^n.
  \end{equation*}

  Then \fullref{thm:def:eigenpair/power} implies that, for any nonnegative integer \( n \), the \( n \)-th power of the \hyperref[def:homogeneous_linear_recurrence_matrix]{associated matrix} satisfies
  \begin{align*}
    &\phantom{{}={}}
    \begin{pmatrix}
      0      & 1      & 0      & \cdots & 0      \\
      0      & 0      & 1      & \cdots & 0      \\
      \vdots & \vdots & \vdots & \ddots & \vdots \\
      0      & 0      & 0      & \cdots & 1      \\
      a_0    & a_1    & a_2    & \cdots & a_{k-1}
    \end{pmatrix}^n
    \begin{pmatrix}
      x_0     \\
      x_1     \\
      \vdots  \\
      x_{k-2} \\
      x_{k-1}
    \end{pmatrix}
    = \\ &=
    \sum_{j=1}^k c_j
    \begin{pmatrix}
      0      & 1      & 0      & \cdots & 0      \\
      0      & 0      & 1      & \cdots & 0      \\
      \vdots & \vdots & \vdots & \ddots & \vdots \\
      0      & 0      & 0      & \cdots & 1      \\
      a_0    & a_1    & a_2    & \cdots & a_{k-1}
    \end{pmatrix}^n
    \begin{pmatrix}
      1              \\
      \alpha_j^1     \\
      \vdots         \\
      \alpha_j^{k-2} \\
      \alpha_j^{k-1}
    \end{pmatrix}
    = \\ &=
    \sum_{j=1}^k c_j \alpha_j^n
    \begin{pmatrix}
      1              \\
      \alpha_j^1     \\
      \vdots         \\
      \alpha_j^{k-2} \\
      \alpha_j^{k-1}
    \end{pmatrix}.
  \end{align*}

  We can combine this with \fullref{thm:homogeneous_linear_recurrence_matrix_action} to obtain
  \begin{equation*}
    \begin{pmatrix}
      x_n         \\
      x_{n+1}     \\
      \vdots      \\
      x_{n+(k-2)} \\
      x_{n+(k-1)}
    \end{pmatrix}
    =
    \begin{pmatrix}
      0      & 1      & 0      & \cdots & 0      \\
      0      & 0      & 1      & \cdots & 0      \\
      \vdots & \vdots & \vdots & \ddots & \vdots \\
      0      & 0      & 0      & \cdots & 1      \\
      a_0    & a_1    & a_2    & \cdots & a_{k-1}
    \end{pmatrix}^n
    \begin{pmatrix}
      x_0     \\
      x_1     \\
      \vdots  \\
      x_{k-2} \\
      x_{k-1}
    \end{pmatrix}
    =
    \sum_{j=1}^k c_j
    \begin{pmatrix}
      \alpha_j^n         \\
      \alpha_j^{n+1}     \\
      \vdots             \\
      \alpha_j^{n+(k-2)} \\
      \alpha_j^{n+(k-1)}
    \end{pmatrix}
  \end{equation*}

  Taking the first coordinate, we obtain \eqref{eq:thm:linear_recurrence_unwinding}.
\end{proof}

\paragraph{Period of linear recurrences}

\begin{definition}\label{def:ultimately_periodic_sequence}\mcite[def. 8.3; 412]{LidlNiederreiter1997FiniteFields}
  We say that the \hyperref[def:sequence]{sequence} \( \seq{ x_n }_{n=0}^\infty \) is \term{ultimately periodic} with \term{preperiod} \( p_0 \) and \term{period} \( p \) if \( p_0 \) is the smallest nonnegative integer such that the subsequence \( \seq{ x_n }_{n=p_0}^\infty \) is \hyperref[def:periodic_function]{periodic} with period \( p \).

  We show in \fullref{thm:def:ultimately_periodic_sequence/preperiod} that all preperiods for a sequence coincide; thus, the preperiod is an intrinsic property of the sequence.

  Then the periods are well-ordered, and there exists a smallest one (with respect to the \hyperref[def:natural_numbers_ordering]{natural number ordering}). \Fullref{thm:def:ultimately_periodic_sequence/least} implies that it divides all others. In accordance with \fullref{def:periodic_function}, call it the \term{least period}.
\end{definition}
\begin{comments}
  \item In particular, every periodic sequence is ultimately periodic with preperiod \( 0 \).
\end{comments}

\begin{proposition}\label{thm:def:ultimately_periodic_sequence}
  \hyperref[def:ultimately_periodic_sequence]{Ultimately periodic sequences} have the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:ultimately_periodic_sequence/preperiod} If a sequence is ultimately periodic with preperiod \( p_0 \) and period \( p \), and if it is also ultimately periodic with preperiod \( q_0 \) and period \( q \), then \( p_0 = q_0 \).

    \thmitem{thm:def:ultimately_periodic_sequence/least} If a sequence is ultimately periodic, the smallest period divides all others.
  \end{thmenum}
\end{proposition}
\begin{proof}
  Fix a sequence \( \seq{ x_n }_{n=0}^\infty \) that is ultimately periodic with preperiod \( p_0 \) and period \( p \).

  \SubProofOf{thm:def:ultimately_periodic_sequence/preperiod} Suppose that \( q_0 \) is also a preperiod with a corresponding period \( q \).

  Suppose first that \( p_0 \leq q_0 \). \Fullref{alg:integer_division} gives us integers \( a \) and \( b \) such that \( 0 \leq b < q_0 \) and
  \begin{equation*}
    q_0 - p_0 = ap + b.
  \end{equation*}

  \Fullref{thm:alg:integer_division/quot_positivity} implies that \( a \geq 0 \). Thus,
  \begin{equation*}
    x_{q_0} = x_{p_0 + (q_0 - p_0)} = x_{p_0 + ap + b} = x_{p_0 + b}.
  \end{equation*}

  For every nonnegative integer \( m \), we have
  \begin{equation*}
    x_{q_0 + pm} = x_{p_0 + b + pm} = x_{p_0 + b},
  \end{equation*}
  thus \( p \) is a period for the preperiod \( q_0 \). By minimality of \( q_0 \), we conclude that it must equal \( p_0 \).

  Similarly, if \( p_0 \geq q_0 \), we conclude that \( p_0 = q_0 \).

  \SubProofOf{thm:def:ultimately_periodic_sequence/least} Let \( q \) be the smallest period. \Fullref{alg:integer_division} gives us integers \( a \) and \( b \) such that \( 0 \leq b < q \) and
  \begin{equation*}
    p = aq + b.
  \end{equation*}

  \Fullref{thm:alg:integer_division/quot_positivity} implies that \( a \geq 0 \). Thus,
  \begin{equation*}
    x_{p_0}
    =
    x_{p_0 + p}
    =
    x_{p_0 + aq + b}
    =
    x_{p_0 + b}.
  \end{equation*}

  If \( b > 0 \), this would contradict the minimality of \( q \); thus, \( b = 0 \), which implies that \( q \) divides \( p \).

  Generalizing on \( p \), we conclude that \( q \) divides all periods of the sequence.
\end{proof}

\begin{proposition}\label{thm:linear_recurrence_finite_field_periodic}
  In the \hyperref[def:finite_field]{finite field} \( \BbbF_q \), consider the \hyperref[def:linear_recurrence]{linear recurrence}
  \begin{equation*}
    X_{N+k} = \sum_{i=1}^k a_{k-i} X_{N+k-i} + a.
  \end{equation*}

  \begin{thmenum}
    \thmitem{thm:linear_recurrence_finite_field_periodic/general}\mcite[thm. 8.7]{LidlNiederreiter1997FiniteFields} Every sequence satisfying this recurrence is \hyperref[def:ultimately_periodic]{ultimately periodic} with least period at most \( q^k \).

    \thmitem{thm:linear_recurrence_finite_field_periodic/homogeneous}\mcite[thm. 8.7]{LidlNiederreiter1997FiniteFields} For \hyperref[def:homogeneous_linear_recurrence]{homogeneous recurrences}, this upper bound can be reduced to \( q^k - 1 \).

    \thmitem{thm:linear_recurrence_finite_field_periodic/periodic}\mcite[thm. 8.11]{LidlNiederreiter1997FiniteFields} If \( a_0 \neq 0 \), the preperiod is zero; that is, the sequences are periodic.
  \end{thmenum}
\end{proposition}
\begin{proof}
  Let \( \seq{ x_n }_{n=0}^\infty \) be a sequence satisfying the recurrence.

  \SubProofOf{thm:linear_recurrence_finite_field_periodic/general} By \fullref{thm:pigeonhole_principle}, the number of state vectors of the sequence is bounded by the number of vectors in \( \BbbF_q^k \).

  Denote the \( n \)-th \hyperref[def:recurrence_relation/state]{state vector} by \( s_n \). For \( s_{q^k} \), there must exist an index \( i < q^k \) such that \( s_{q^k} = s_i \). Then we also have equality of their first coordinates, i.e. \( x_{q^k} = x_i \).

  Let \( r_0 \) be the smallest index such that \( x_{q^k} = x_{r_0} \), and let \( r = q^k - r_0 \). Then
  \begin{equation*}
    x_{r_0 + r} = x_{r_0 + q^k - r_0} = x_{q^k} = x_{r_0}.
  \end{equation*}

  Therefore, the sequence is periodic with preperiod \( r_0 \) and period \( r \).

  \SubProofOf{thm:linear_recurrence_finite_field_periodic/homogeneous} In case the recurrence is homogeneous, either \( \seq{ x_n }_{n=0}^\infty \) has a zero state vector, which makes the sequence vacuously ultimately periodic, or otherwise the zero vector does not occur, and we have at most \( \BbbF_q^k - 1 \) state vectors.

  \SubProofOf{thm:linear_recurrence_finite_field_periodic/periodic} Suppose that \( a_0 \neq 0 \). Let \( r_0 \) be the preperiod and \( r \) --- the least period of \( \seq{ x_n }_{n=0}^\infty \). We will show that \( r_0 = 0 \).

  Suppose instead that \( r_0 > 0 \). Then
  \begin{equation*}
    x_{(r_0-1)+k} = \sum_{i=1}^{k-1} a_{k-i} x_{(r_0-1)+k-i} + a_0 x_{r_0-1} + a,
  \end{equation*}
  hence
  \begin{equation*}
    x_{r_0-1}
    =
    \frac {x_{r_0-1+k} - \sum_{i=1}^{k-1} a_{k-i} x_{r_0-1+k-i} - a} {a_0}.
  \end{equation*}

  Similarly, we obtain
  \begin{equation*}
    x_{r_0+r-1}
    =
    \frac {x_{(r_0+r-1)+k} - \sum_{i=1}^{k-1} a_{k-i} x_{(r_0+r-1)+k-i} - a} {a_0}
    =
    \frac {x_{r_0-1+k} - \sum_{i=1}^{k-1} a_{k-i} x_{r_0-1+k-i} - a} {a_0}.
  \end{equation*}

  Then
  \begin{equation*}
    x_{r_0-1} = x_{r_0+r-1},
  \end{equation*}
  which contradicts the minimality of \( r_0 \).

  It follows that \( r_0 = 0 \).
\end{proof}

\begin{lemma}\label{thm:impulse_response_sequence_cancellation}\mcite[lemma 8.15]{LidlNiederreiter1997FiniteFields}
  \hyperref[def:homogeneous_linear_recurrence]{homogeneous linear recurrence}; denote by \( A \) its \hyperref[def:homogeneous_linear_recurrence_matrix]{associated matrix} and by \( v_n \) the \( n \)-th \hyperref[def:recurrence_relation/state]{state vector} of the \hyperref[def:recurrence_relation_space]{impulse response sequence}.

  Then \( v_n = v_m \) if and only if \( A^n = A^m \).
\end{lemma}
\begin{proof}
  \NecessitySubProof \Fullref{thm:homogeneous_linear_recurrence_matrix_action} implies that \( v_n = A^n v_0 \) and \( v_m = A^m v_0 \), hence, if \( A^n = A^m \), we have \( v_n = v_m \).

  \SufficiencySubProof Conversely, suppose that \( v_n = v_m \). Then
  \begin{equation*}
    A^n v_0 = A^m v_0.
  \end{equation*}

  Since \( v_0 \) is the unit vector \( (0, \cdots, 1)^T \), \( A^n v_0 \) is precisely the last column of \( A^n \). We conclude that it coincides with the last column of \( A^m \).

  For the \( j \)-th column, we can multiply \( v_0 \) on the right the \hyperref[def:elementary_matrix/permutation]{permutation matrix} \( P_{k \mapsto j} \) since that would swap the \( k \)-th and \( j \)-th columns of \( v \). We have
  \begin{equation*}
    A^n (v_0 P_{k \mapsto j}) = A^m (v_0 P_{k \mapsto j})
  \end{equation*}

  Therefore, \( A^n \) and \( A^m \) coincide.
\end{proof}

\begin{proposition}\label{thm:impulse_response_sequence_period}\mcite[prop. 8.16]{LidlNiederreiter1997FiniteFields}
  Over a \hyperref[def:finite_field]{finite field}, the least period of any sequence satisfying a \hyperref[def:homogeneous_linear_recurrence]{homogeneous linear recurrence} divides the least period of the \hyperref[def:recurrence_relation_space]{impulse response sequence}.
\end{proposition}
\begin{comments}
  \item \Fullref{thm:linear_recurrence_finite_field_periodic/homogeneous} implies that every recurrent sequence over a finite field is \hyperref[def:ultimately_periodic_sequence]{ultimately periodic}. We are only concerned with showing that the impulse response sequence has the largest possible period.
\end{comments}
\begin{proof}
  In \( \BbbF_q \), fix the recurrence relation
  \begin{equation*}
    X_{N+k} = \sum_{i=1}^k a_{k-i} X_{N+k-i}.
  \end{equation*}

  Let \( \seq{ d_n }_{n=0}^\infty \) be the impulse response sequence. \Fullref{thm:linear_recurrence_finite_field_periodic/homogeneous} implies that it is ultimately periodic. Denote by \( t_0 \) and \( t \) the preperiod and least period and by \( v_n \) its \( n \)-th \hyperref[def:recurrence_relation/state]{state vector}.

  Due to \fullref{thm:homogeneous_linear_recurrence_matrix_action}, we have
  \begin{equation*}
    A^t v_{t_0} = v_{t_0 + t} = v_t = A^0 v_{t_0}.
  \end{equation*}

  The \fullref{thm:impulse_response_sequence_cancellation} implies that \( A^t \) is the unit matrix.

  Let \( \seq{ x_n }_{n=0}^\infty \) be an arbitrary sequence satisfying the recurrence, and denote by \( s_n \) its \( n \)-th state vector.

  Finally, denote its preperiod by \( r_0 \). Then
  \begin{equation*}
    s_{r_0 + t}
    =
    A^t s_{r_0}
    =
    s_{r_0}.
  \end{equation*}

  It follows that \( t \) is a period of \( \seq{ x_n }_{n=0}^\infty \). \Fullref{thm:def:ultimately_periodic_sequence/least} implies that its least period divides \( t \).
\end{proof}

\begin{theorem}[Linear recurrences with maximal period]\label{thm:linear_recurrences_with_maximal_period}
  In the \hyperref[def:finite_field]{finite field} \( \BbbF_q \), consider the \hyperref[def:homogeneous_linear_recurrence]{homogeneous linear recurrence}
  \begin{equation*}
    X_{N+k} = \sum_{i=1}^k a_{k-i} X_{N+k-i}.
  \end{equation*}

  Suppose that its \hyperref[def:linear_recurrence_characteristic_polynomial]{characteristic polynomial}
  \begin{equation*}
    \chi(X) = X^n - \sum_{i=1}^k a_{k-i} X^{k-i}
  \end{equation*}
  is a \hyperref[def:finite_field_primitive_polynomial]{primitive polynomial}.

  \begin{thmenum}
    \thmitem{thm:linear_recurrences_with_maximal_period/root} For every root \( \alpha \) of \( \chi(X) \), the sequence \( \seq{ \alpha_k }_{k=0}^\infty \) satisfies the recurrence and is periodic with least period \( q^k - 1 \) --- the maximal possible period.

    \thmitem{thm:linear_recurrences_with_maximal_period/impulse} The \hyperref[def:recurrence_relation_space]{impulse response sequence} is \hyperref[def:ultimately_periodic_sequence]{ultimately periodic} with the same least period.
  \end{thmenum}
\end{theorem}
\begin{comments}
  \item \Fullref{thm:linear_recurrence_finite_field_periodic/periodic} implies that, if \( a_0 \neq 0 \), the preperiods are zero; that is, the impulse response sequence is periodic.
\end{comments}
\begin{proof}
  \SubProofOf{thm:linear_recurrences_with_maximal_period/root} Fix a root \( \alpha \) of the characteristic polynomial. By definition of primitive polynomial, \( \alpha \) must generate the multiplicative group of \( \BbbF_q^k \). Then \( q^k - 1 \) is the order of \( \alpha \), and thus the sequence \( \seq{ \alpha^k }_{k=0}^\infty \) is periodic with least period \( q^k - 1 \).

  \Fullref{thm:linear_recurrence_characteristic_roots/satisfaction} implies that this sequence satisfies the recurrence.

  \SubProofOf{thm:linear_recurrences_with_maximal_period/impulse} \Fullref{thm:linear_recurrence_finite_field_periodic/homogeneous} implies that the impulse response sequence \( \seq{ d_n }_{n=0}^\infty \) is ultimately periodic with period at most \( q^k - 1 \).

  Since the characteristic period is primitive, it does have at least one root by assumption, say \( \alpha \). \Fullref{thm:linear_recurrences_with_maximal_period/root} implies that the sequence \( \seq{ \alpha^k }_{k=0}^\infty \) satisfies the recurrence and is periodic with least period \( q^k - 1 \).

  \Fullref{thm:impulse_response_sequence_period} then implies that \( q^k - 1 \) divides the least period of \( \seq{ d_n }_{n=0}^\infty \). We have already shown in the beginning that its least period cannot exceed \( q^k - 1 \); thus, it must coincide with \( q^k - 1 \).
\end{proof}

\begin{example}\label{ex:thm:linear_recurrences_with_maximal_period}
  We list examples related to \fullref{thm:linear_recurrences_with_maximal_period}:
  \begin{thmenum}
    \thmitem{ex:thm:linear_recurrences_with_maximal_period/f2_q3} We have established in \fullref{ex:def:finite_field_primitive_polynomial/f2_quadratic} that \( f(X) = X^2 + X + 1 \) is a \hyperref[def:finite_field_primitive_polynomial]{primitive polynomial} in \( \BbbF_2 \).

    Its corresponding recurrence is
    \begin{equation*}
      X_{N+2} = X_{N+1} + X_N.
    \end{equation*}

    This is precisely the Fibonacci recurrence that we will define in \fullref{def:fibonacci_numbers}.

    Let \( \alpha \) be a root of \( f(X) \). \Fullref{thm:linear_recurrences_with_maximal_period/root} implies that the sequence
    \begin{equation*}
      \alpha, \alpha^2, \alpha^3, \cdots
    \end{equation*}
    satisfies the recurrence and is periodic with base period \( 3 \).

    We can easily verify both statements. Since \( \alpha^2 = \alpha + 1 \), we have
    \begin{equation*}
      \alpha^{n+2} = \alpha^n \cdot \alpha^2 = \alpha^n (\alpha + 1) = \alpha^{n+1} + \alpha^n,
    \end{equation*}
    hence the recurrence relation is satisfied.

    That the sequence is periodic is also straightforward:
    \begin{equation*}
      \alpha^4
      =
      (\alpha^2)^2
      =
      (\alpha + 1)^2
      \reloset {\eqref{eq:thm:binomial_theorem_positive_characteristic}} =
      \alpha^2 + 1
      =
      \alpha + 1 + 1
      =
      \alpha,
    \end{equation*}
    hence
    \begin{equation*}
      \alpha^{k+3}
      =
      \alpha^{k-1} \alpha^4
      =
      \alpha^{k-1} \alpha
      =
      \alpha^k.
    \end{equation*}

    The impulse response sequence also induces a recurrent sequence of period \( 3 \):
    \begin{equation*}
      0, 1, 1, 0, 1, 1, 0, 1, 1, \ldots
    \end{equation*}

    On the other hand, \( 0 \) is not a root of \( f(X) \), and the period of the zero sequence is \( 1 \).
  \end{thmenum}
\end{example}

\paragraph{Progressions}\hfill

There are two particularly simple recurrence relations colloquially referred to as \enquote{progressions}.

\begin{definition}\label{def:arithmetic_progression}\mimprovised
  In an \hyperref[def:abelian_group]{abelian group}, by default taken to be the field of complex numbers, we refer to recurrences satisfying \hyperref[def:linear_recurrence_relation]{linear recurrence relation}
  \begin{equation}\label{eq:def:arithmetic_progression/recurrence}
    X_{N+1} = X_N + d
  \end{equation}
  as \term[ru=арифметические прогрессии (\cite[143]{АлександровМаркушевичХинчин1952ЭнциклопедияТом3}), en=arithmetic progressions (\cite[def. 2.4.3]{Rosen2019DiscreteMathematics})]{arithmetic progressions} with \term[en=common difference (\cite[def. 2.4.3]{Rosen2019DiscreteMathematics})]{difference} \( d \).
\end{definition}
\begin{comments}
  \item This definition merely highlights that arithmetic progressions are recurrences; We will use the more convenient form \( x_n = x_0 + nd \) from \fullref{thm:arithmetic_progression_unwinding}.

  \item The generalization to abelian groups can also be found in \bycite[595]{ButlerEtAl2016Progressions}.
\end{comments}

\begin{proposition}\label{thm:arithmetic_progression_homogeneization}
  The \hyperref[def:linear_recurrence]{linear recurrence relation}
  \begin{equation*}
    X_{N+1} = X_N + d
  \end{equation*}
  for \hyperref[def:arithmetic_progression]{arithmetic progressions} can be homogenized as
  \begin{equation}\label{eq:thm:arithmetic_progression_homogeneization}
    X_{N+2} = 2 X_{N+1} - X_N.
  \end{equation}
\end{proposition}
\begin{comments}
  \item Note that the homogenization does not depend on the choice of \( d \). It can now be recovered from a concrete recurrent sequence by taking the different between adjacent terms.
\end{comments}
\begin{proof}
  Direct application of \fullref{thm:linear_recurrence_relation_homogenization}.
\end{proof}

\begin{example}\label{ex:arithmetic_progression_unwinding_as_recurrence}
  We will use this opportunity to demonstrate how \fullref{thm:linear_recurrence_unwinding} can fail. Consider the \hyperref[def:arithmetic_progression]{arithmetic progression} \( \seq{ x_n }_{n=0}^\infty \) with difference \( d \) and consider its homogenized recurrence relation
  \begin{equation*}
    X_{N+2} = 2 X_{N+1} - X_N.
  \end{equation*}

  Its \hyperref[def:linear_recurrence_characteristic_polynomial]{characteristic polynomial} is
  \begin{equation*}
    \chi(X) = X^2 - 2 X + 1.
  \end{equation*}

  \Fullref{thm:binomial_theorem} implies that \( \chi(X) = (X - 1)^2 \), hence \( 1 \) is a multiple root. Then we cannot apply \fullref{thm:linear_recurrence_unwinding}. \Fullref{ex:def:diagonalizable_matrix/01-12} implies that the \hyperref[def:homogeneous_linear_recurrence_matrix]{associated matrix} is not diagonalizable, thus we cannot express \( x_n \) as
  \begin{equation*}
    x_n = c_1 \alpha_1^n + c_2 \alpha_2^n
  \end{equation*}
  for any values.

  There is a simple non-recurrent \hyperref[con:expression]{expression}  for \( x_n \) --- see \fullref{thm:arithmetic_progression_unwinding} --- it simply has a different form.
\end{example}

\begin{proposition}\label{thm:arithmetic_progression_unwinding}
  The \( n \)-th term of the \hyperref[def:arithmetic_progression]{arithmetic progression} satisfying
  \begin{equation*}
    x_n = x_{n-1} + d
  \end{equation*}
  is
  \begin{equation*}
    x_n = a_0 + nd,
  \end{equation*}
  where \( kd \) is \hyperref[con:additive_semigroup/multiplication]{iterated semigroup addition}.
\end{proposition}
\begin{proof}
  The statement easily follows by induction on \( n \) from either \eqref{eq:def:arithmetic_progression/recurrence} or \eqref{eq:thm:arithmetic_progression_homogeneization}.
\end{proof}

\begin{proposition}\label{thm:arithmetic_progression_partial_sums}
  The \hyperref[def:convergent_series]{series} constructed from the \hyperref[def:arithmetic_progression]{arithmetic progression}
  \begin{equation*}
    x_k = a_0 + nd
  \end{equation*}
  has partial sums
  \begin{equation}\label{eq:thm:arithmetic_progression_partial_sums}
    2 \sum_{k=0}^n x_k = (n + 1) (x_0 + x_n).
  \end{equation}
\end{proposition}
\begin{proof}
  \begin{balign*}
    2 \sum_{k=0}^n x_k
     & =
    2 \sum_{k=0}^n (x_0 + kd)
    =    \\ &=
    \sum_{k=0}^n (x_0 + kd) + \sum_{k=0}^n (x_0 + (n-k)d)
    =    \\ &=
    \sum_{k=0}^n (2 x_0 + nd)
    =    \\ &=
    (n + 1) (x_0 + x_n).
  \end{balign*}
\end{proof}

\begin{corollary}\label{thm:numeric_arithmetic_progression_partial_sums}
  For any positive integer \( n \), we have
  \begin{equation}\label{eq:thm:numeric_arithmetic_progression_partial_sums}
    \sum_{k=0}^n k = \sum_{k=1}^n k = \frac {n (n + 1)} 2 = \binom {n+1} 2.
  \end{equation}
\end{corollary}
\begin{comments}
  \item These are precisely the \hyperref[def:triangular_number]{triangular numbers}, as shown in \fullref{thm:triangular_point_configuration_cardinality}.
\end{comments}
\begin{proof}
  Follows from either \fullref{thm:arithmetic_progression_partial_sums} or \fullref{thm:vandermonde_convolution}.
\end{proof}

\begin{definition}\label{def:geometric_progression}\mimprovised
  In a \hyperref[def:field]{field}, by default taken to be the field of complex numbers, we refer to sequences satisfying the \hyperref[def:homogeneous_linear_recurrence]{homogeneous linear recurrence relation}
  \begin{equation}\label{eq:def:geometric_progression/recurrence}
    X_{N+1} = X_N q
  \end{equation}
  as \term[ru=геометрическае прогрессии (\cite[144]{АлександровМаркушевичХинчин1952ЭнциклопедияТом3}), en=geometric progressions (\cite[def. 2.4.2]{Rosen2019DiscreteMathematics})]{geometric progression} with \term[ru=знаменатель (прогрессии) (\cite[\S 227]{Киселёв2004Геометрия}), en=common ratio (\cite[def. 2.4.2]{Rosen2019DiscreteMathematics})]{quotient} \( q \).
\end{definition}
\begin{comments}
  \item This definition merely highlights that geometric progressions are recurrences; We will use the more convenient form \( x_n = x_0 q^n \) from \fullref{thm:geometric_progression_unwinding}.
\end{comments}

\begin{proposition}\label{thm:geometric_progression_unwinding}
  The \( n \)-th term of the \hyperref[def:arithmetic_progression]{geometric progression} satisfying
  \begin{equation*}
    x_n = x_{n-1} d
  \end{equation*}
  is
  \begin{equation*}
    x_n = a_0 q^n.
  \end{equation*}
\end{proposition}
\begin{proof}
  Although this easily follows by induction, we will use it as an opportunity to demonstrate \fullref{thm:linear_recurrence_unwinding}.

  The corresponding recurrence relation
  \begin{equation*}
    X_{N+1} = X_N q.
  \end{equation*}
  has \hyperref[def:linear_recurrence_characteristic_polynomial]{characteristic polynomial} \( X - q \) with an obvious root.

  It follows that there must exist a coefficient \( c \) such that \( x_n = cq^n \). We determine \( c \) from \( x_0 = c q^0 = c \).
\end{proof}

\begin{proposition}\label{thm:arithmetic_to_geometric_progression}
  Given a complex arithmetic progression \( \seq{ a_k }_{k=0}^\infty \) with difference \( d \), for any complex number \( z \), the sequence \( \seq{ z^{a_k} }_{k=0}^\infty \) is a geometric progression with quotient \( z^d \).
\end{proposition}
\begin{proof}
  Trivial.
\end{proof}

\paragraph{Fibonacci recurrence}

\begin{definition}\label{def:fibonacci_numbers}\mcite[def. 2.4.5]{Rosen2019DiscreteMathematics}
  Consider the \hyperref[def:homogeneous_linear_recurrence]{homogeneous linear recurrence relation}
  \begin{equation}\label{eq:def:fibonacci_numbers}
    X_{N+2} = X_{N+1} + X_N,
  \end{equation}
  which we will call the \term[en=Fibonacci recurrence (\cite[8]{Wilf1994GeneratingFunctionsOnline})]{Fibonacci recurrence}.

  We will refer to the corresponding \hyperref[def:recurrence_relation_space]{impulse response sequence} with initial values \( X_0 = 0 \) and \( X_1 = 1 \) as the \term[ru=последовательность Фибоначчи (\cite[exerc. 7.15]{ГашковЧубариков2005Сложность})]{Fibonacci sequence}, and to its members as the \term[ru=числа Фибоначчи (\cite[\S 5.7.3]{Новиков2013ДискретнаяМатематика})]{Fibonacci numbers}. We denote the \( n \)-th Fibonacci number by \( F_n \).
\end{definition}
\begin{comments}
  \item The origin of this sequence is discussed in \fullref{ex:fibonacci_rabbits}, while the possible conventions for initial values are discussed in \fullref{rem:fibonacci_sequence_initial_value}.
\end{comments}

\begin{remark}\label{rem:fibonacci_sequence_initial_value}
  There are multiple conventions for the initial values of the \hyperref[def:fibonacci_numbers]{Fibonacci sequence}.

  \begin{itemize}
    \item Fibonacci's own convention, discussed in \fullref{ex:fibonacci_rabbits}, where \( F_0 = 1 \) and \( F_1 = 2 \) is also used by \incite[exerc. 5.5]{Treil2017LinearAlgebra}.

    \item The modern convention from \fullref{def:fibonacci_numbers}, focusing on computation, is used by
    \incite[98]{Aigner1997Combinatorics},
    \incite[467]{LidlNiederreiter1997FiniteFields},
    \incite[def. 2.4.5]{Rosen2019DiscreteMathematics},
    \incite[112]{ConwayGuy1998Numbers},
    \incite[122]{Mimram2020Types},
    \incite[98]{Erickson2019Algorithms},
    \incite[13]{Knuth1997ArtVol1},
    \incite[exerc. B-5.14(ii)]{Rotman2015AlgebraPart1},
    \incite[59]{Мальцев1986Вычислимость} and
    \incite[\S 5.7.3]{Новиков2013ДискретнаяМатематика}.

    \item Another convention is to avoid defining \( F_0 \), but start with \( F_1 = F_2 = 1 \). This gives a one-based sequence that otherwise coincides with ours. The approach is used by
    \incite[273]{Deza2012FigurateNumbers},
    \incite[example 1.1.12]{Stanley2012EnumCombinatoricsVol1}
    \incite[exerc. 7.15]{ГашковЧубариков2005Сложность})
    \incite[97]{Зорич2019АнализЧасть1}.

    \item \incite[198]{Яблонский2003ДискретнаяМатематика} instead starts with \( F_0 = F_1 = 1 \).
  \end{itemize}
\end{remark}

\begin{definition}\label{def:lucas_numbers}\mcite[112]{ConwayGuy1998Numbers}
  Consider the sequence generated by the Fibonacci recurrence \eqref{eq:def:fibonacci_numbers} with initial values \( X_0 = 2 \) and \( X_1 = 1 \).

  We will call the positive-index members of this sequence \term{Lucas numbers} and denote the \( n \)-th Lucas number by \( L_n \).
\end{definition}
\begin{comments}
  \item We purposely avoid defining \( L_0 \) since it is the only obstacle for the sequence to be increasing. We avoid the phrase \enquote{Lucas sequence} due to possible ambiguity of whether it is zero-based or not.

  \item The sequence is presented starting with \( L_0 = 2 \) by \incite[112]{ConwayGuy1998Numbers}, and also in \cite[142]{Rosen2018DiscreteHandbook}.

  The more common practice is to avoid defining \( L_0 \); it is done by \incite[exerc. III.2.9]{Aigner1997Combinatorics}, \incite[example 1.1.6]{Stanley2012EnumCombinatoricsVol1}, \incite[example 15]{Rosen2019DiscreteMathematics}, \incite[273]{Deza2012FigurateNumbers} and \incite[240]{Strang2023LinearAlgebra}.
\end{comments}

\begin{example}\label{ex:fibonacci_matrix}
  \Fullref{thm:homogeneous_linear_recurrence_matrix_action} implies that the \hyperref[def:fibonacci_numbers]{Fibonacci recurrence} can be described by the \hyperref[def:homogeneous_linear_recurrence_matrix]{associated matrix}
  \begin{equation*}
    M
    =
    \begin{pmatrix}
      0 & 1 \\
      1 & 1
    \end{pmatrix}.
  \end{equation*}

  Note that the \hyperref[def:lucas_numbers]{Lucas numbers} satisfy the same recurrence, and thus have the same matrix.

  \begin{thmenum}
    \thmitem{ex:fibonacci_matrix/square} The square
    \begin{equation*}
      M^2
      =
      \begin{pmatrix}
        1 & 1 \\
        1 & 2
      \end{pmatrix}
    \end{equation*}
    allows us to compute \( F_{n+3} \) and \( F_{n+2} \) from \( F_{n+1} \) and \( F_n \).

    For example,
    \begin{equation*}
      \begin{pmatrix}
        1 \\ 2
      \end{pmatrix}
      =
      \begin{pmatrix}
        1 & 1 \\
        1 & 2
      \end{pmatrix}
      \begin{pmatrix}
        0 \\ 1
      \end{pmatrix}
    \end{equation*}
    and
    \begin{equation*}
      \begin{pmatrix}
        3 \\ 5
      \end{pmatrix}
      =
      \begin{pmatrix}
        1 & 1 \\
        1 & 2
      \end{pmatrix}
      \begin{pmatrix}
        1 \\ 2
      \end{pmatrix}.
    \end{equation*}

    \thmitem{ex:fibonacci_matrix/graph} We can regard \( M \) as the \hyperref[def:adjacency_matrix]{adjacency matrix} of the graph
    \begin{equation}\label{eq:ex:fibonacci_matrix/graph}
      \begin{aligned}
        \includegraphics[page=1]{output/ex__fibonacci_graph}
      \end{aligned}
    \end{equation}

    \Fullref{thm:adjacency_matrix_power} implies that the matrix \( M^n \) describes the number of \hyperref[def:graph_walk]{graph walks}.

    Then \( F_n \) is the number of loops of length \( n \) at the vertex \( v \).
  \end{thmenum}
\end{example}

\begin{definition}\label{def:golden_ratio}\mimprovised
  We will find useful the following constants:
  \begin{align*}
    \varphi \coloneqq \frac {1 + \sqrt 5} 2,
    &&
    \psi \coloneqq \frac {1 - \sqrt 5} 2.
  \end{align*}

  We will refer to \( \varphi \) as the \term[ru=золотое сечение (\cite[exerc. 7.18]{ГашковЧубариков2005Сложность}), en=golden ratio (\cite[35]{Knuth1997ArtVol1})]{golden ratio} and to \( \psi \) as its \term{conjugate}.
\end{definition}
\begin{comments}
  \item It follows from \fullref{thm:quadratic_conjugate_algebraic_element} that \( \varphi \) and \( \psi \) are \hyperref[def:conjugate_algebraic_element]{conjugate algebraic elements} over \( \BbbR \).
\end{comments}

\begin{proposition}\label{thm:def:golden_ratio}
  The \hyperref[def:golden_ratio]{golden ratio} has the following basic properties:
  \begin{thmenum}
    \thmitem{thm:def:golden_ratio/conjugate} We have
    \begin{equation}\label{eq:thm:def:golden_ratio/conjugate}
      \psi = -\varphi^{-1} = 1 - \varphi.
    \end{equation}
  \end{thmenum}
\end{proposition}
\begin{proof}
  \SubProofOf{thm:def:golden_ratio/conjugate} We have
  \begin{equation*}
    -\varphi^{-1}
    =
    -\frac 2 {1 + \sqrt 5}
    =
    -\frac 2 {1 + \sqrt 5} \cdot \frac {1 - \sqrt 5} {1 - \sqrt 5}
    =
    -\frac {2(1 - \sqrt 5)} {1 - 5}
    =
    \frac {1 - \sqrt 5} 2
    =
    1 - \varphi.
  \end{equation*}
\end{proof}

\begin{theorem}[Binet's Fibonacci number formula]\label{thm:binets_fibonacci_number_formula}
  Over the \hyperref[def:real_numbers]{real numbers}, the \hyperref[def:fibonacci_numbers]{Fibonacci sequence} can be unwinded using the \hyperref[def:golden_ratio]{golden ratio} \( \varphi \) and its conjugate \( \psi \):
  \begin{equation}\label{eq:thm:binets_formula/fibonacci}
    F_n = \frac {\varphi^n - \psi^n} {\sqrt 5}.
  \end{equation}

  \hyperref[def:lucas_numbers]{Lucas numbers} can instead be unwinded as
  \begin{equation}\label{eq:thm:binets_formula/lucas}
    L_n = \varphi^n + \psi^n.
  \end{equation}
\end{theorem}
\begin{comments}
  \item The theorem is attributed to Binet by \incite[273]{Deza2012FigurateNumbers} and \incite[exerc. 7.18]{ГашковЧубариков2005Сложность}.
  \item Rather than using \( \psi \), we can express it via \( \varphi \) using \fullref{thm:def:golden_ratio/conjugate}.
\end{comments}
\begin{proof}
  The \hyperref[def:linear_recurrence_characteristic_polynomial]{characteristic polynomial} of the Fibonacci recurrence is
  \begin{equation*}
    X^2 - X - 1.
  \end{equation*}

  \Fullref{thm:real_quadratic_polynomial_roots} implies that its roots are precisely \( \varphi \) and \( \psi \).

  \SubProofOf{eq:thm:binets_formula/fibonacci} \Fullref{thm:linear_recurrence_unwinding} implies that there exist coefficients \( c_1 \) and \( c_2 \) such that, for every index \( n \),
  \begin{equation*}
    F_n = c_1 \varphi^n + c_2 \psi^n.
  \end{equation*}

  Since \( F_0 = c_1 + c_2 \) must be \( 0 \), we conclude that \( c_1 = -c_2 \). Then
  \begin{equation*}
    F_n = c_1 (\varphi^n - \psi^n).
  \end{equation*}

  Furthermore, \( F_1 = 1 \) and
  \begin{equation*}
    F_1 = c_1 (\varphi - \psi) = c_1 \parens[\Big]{ \frac {1 + \sqrt 5} 2 - \frac {1 - \sqrt 5} 2 } = c_1 \cdot \sqrt 5,
  \end{equation*}
  hence
  \begin{equation*}
    c_1 = \frac 1 {\sqrt 5}.
  \end{equation*}

  Then \eqref{eq:thm:binets_formula/fibonacci} follows.

  \SubProofOf{eq:thm:binets_formula/lucas} Now consider the Lucas numbers.

  Since \( L_0 = c_1 + c_2 \)\fnote{Even though we avoid the zeroth Lucas number elsewhere, it is quite convenient here.} must equal \( 2 \), we conclude that \( c_2 = 2 - c_1 \) and
  \begin{equation*}
    L_n = c_1 (\varphi^n - \psi^n) + 2 \psi^n.
  \end{equation*}

  Furthermore, \( L_1 = 1 \) and
  \begin{equation*}
    L_1 = c_1 (\varphi - \psi) + 2 \psi = c_1 \cdot \sqrt 5 + (1 - \sqrt 5),
  \end{equation*}
  hence
  \begin{equation*}
    c_1 = 1.
  \end{equation*}

  Then \eqref{eq:thm:binets_formula/lucas} follows.
\end{proof}

\paragraph{Catalan numbers}

\begin{definition}\label{def:catalan_number}\mcite[188]{Stanley2023EnumCombinatoricsVol2}
  We define the \hyperref[def:sequence]{sequence} of \term[ru=число Каталана (\cite[\S 5.7.4]{Новиков2013ДискретнаяМатематика})]{Catalan numbers} \hyperref[rem:natural_number_recursion]{recursively} as
  \begin{equation}\label{eq:def:catalan_number}
    C_n \coloneqq \begin{cases}
      1,                                    &n = 0, \\
      \sum_{k=0}^{n-1} C_k \cdot C_{n-k-1}, &n > 0.
    \end{cases}
  \end{equation}
\end{definition}
\begin{comments}
  \item Richard Stanley lists many characterizations of Catalan numbers in the exercises to \cite[ch. 6]{Stanley2023EnumCombinatoricsVol2}.

  \item We can regard \eqref{eq:def:catalan_number} as an unrestricted recurrence relation in the sense of \fullref{rem:unrestricted_recurrence_relation}.
\end{comments}

\begin{proposition}\label{thm:catalan_number_via_binomial_coefficients}
  We can characterize \hyperref[def:catalan_number]{Catalan numbers} via \hyperref[def:binomial_coefficient]{binomial coefficients}:
  \begin{equation}\label{eq:thm:catalan_number_via_binomial_coefficients}
    C_n = \frac 1 {n + 1} \binom {2n} n
  \end{equation}
\end{proposition}
\begin{proof}
  \todo{Prove}
\end{proof}

\begin{proposition}\label{thm:full_binary_tree_count}
  The number of \hyperref[def:n_ary_tree]{full binary trees} with \( n \) \hyperref[def:rooted_tree/internal]{internal nodes} is described by the \hyperref[def:catalan_number]{Catalan number} \( C_n \).
\end{proposition}
\begin{proof}
  We will use induction on \( n \). The case \( n = 0 \) is vacuous. For the inductive step, suppose that the hypothesis holds for less than \( n \) internal nodes.

  Let \( T \) be a full binary tree with \( n \) internal nodes. The \hyperref[def:rooted_tree/subtree]{immediate subtrees} of \( T \) have a total of \( n - 1 \) internal nodes. If the left subtree has \( k \) internal nodes, the right subtree has \( n - k - 1 \) internal nodes.

  Denote by \( t_n \) the number of full binary trees with \( n \) internal nodes. Then, by what we have shown,
  \begin{equation*}
    t_n = \sum_{k=0}^{n-1} t_k t_{n-k-1}.
  \end{equation*}

  By the inductive hypothesis, \( t_n \) satisfies the recursive clause in \eqref{eq:def:catalan_number}, hence it equals \( C_n \).
\end{proof}

\begin{lemma}\label{thm:dyck_language_length}
  Every string in the \hyperref[def:dyck_language]{Dyck language} has even length.
\end{lemma}
\begin{proof}
  We will use \fullref{thm:induction_on_rooted_trees} on the \hyperref[def:parse_tree]{parse tree} of the word \( w \):
  \begin{itemize}
    \item If \( w \) is the empty word, its length is clearly even.

    \item If \( w = (w') \), then \( w \) is longer than \( w' \) by two symbols. By the inductive hypothesis, \( w \) has even length.

    \item If \( w = w_1 w_2 \), then \( w \) has even length if and only if both \( w_1 \) and \( w_2 \) have even length.

    Again, by the inductive hypothesis, \( w \) has even length.
  \end{itemize}
\end{proof}

\begin{corollary}\label{thm:dyck_word_count}
  The number of \hyperref[def:dyck_language]{Dyck words} of length \( 2n \) is described by the \hyperref[def:catalan_number]{Catalan number} \( C_n \).
\end{corollary}
\begin{proof}
  \Fullref{thm:dyck_words_and_binary_trees} describes a bijective correspondence between Dyck words and full binary trees.

  Let \( w \) be a Dyck word of length \( 2n \). \Fullref{thm:dyck_language_alternative_grammar} implies that either \( w \) is empty or \( w = (w_1) w_2 \). \Fullref{thm:dyck_language_length} implies that both \( w_1 \) and \( w_2 \) have even length. We can then use induction on the length of \( w \) to show that the tree constructed via \fullref{thm:dyck_words_and_binary_trees/word_to_tree} has \( n \) internal nodes:
  \begin{itemize}
    \item The base case where \( w \) is empty is clear.
    \item If \( w = (w_1) w_2 \) and if the inductive hypothesis holds for \( w_1 \) and \( w_2 \), then the trees \( T_{w_1} \) and \( T_{w_2} \) have \( n - 1 \) internal nodes in common, and, by adding a new root, we obtain \( T_w \) with \( n \) internal nodes.
  \end{itemize}

  \Fullref{thm:full_binary_tree_count} then implies that there are \( C_n \) Dyck words of length \( 2n \).
\end{proof}
