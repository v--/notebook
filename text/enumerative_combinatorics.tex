\section{Enumerative combinatorics}\label{sec:enumerative_combinatorics}

\paragraph{Cardinality arithmetic}

\begin{theorem}[Cardinality sum rule]\label{thm:cardinality_sum_rule}
  The \hyperref[thm:cardinality_existence]{cardinality} of the union of finitely many \hi{\hyperref[def:subset_ordering]{disjoint}} \hyperref[def:set]{sets} is the sum of their individual cardinalities.
\end{theorem}
\begin{comments}
  \item Although this result is elementary, it is ubiquitous and giving it a name helps to justify steps in proofs whose justification may otherwise be unclear. See, for example, our proof of \fullref{thm:roots_of_unity_cyclic_group}.

  \item The generalization of this property is called \hyperref[def:boolean_algebra_additive_function/finite]{finite additivity}, and is required to hold for all \hyperref[def:measure]{measures}. In particular, it holds for the \hyperref[def:counting_measure]{counting measure}, which is also based on cardinalities.

  \item If the sets are not disjoint (but are finite), we can instead use \fullref{thm:inclusion_exclusion_principle}.
\end{comments}
\begin{proof}
  Fix a family \( A_1, \ldots, A_n \) of disjoint sets. We will use induction on \( n \). The base case \( n = 0 \) is vacuous, so suppose that the rule holds for families of \( n - 1 \) sets. Then
  \begin{equation*}
    \sum_{k=1}^n \card A_k
    =
    \sum_{k=1}^{n-1} \card A_k + \card A_n
    \reloset {\T{ind.}} =
    \card\parens[\Big]{ \bigcup_{k=1}^{n-1} A_k } + \card A_n.
  \end{equation*}

  Denote the union \( \bigcup_{k=1}^{n-1} A_k \) by \( B \). \Fullref{def:cardinal_arithmetic/addition} defines the sum above as the cardinality of the disjoint union \( B \amalg A_n \). However, since \( B \) and \( A_n \) are disjoint, \fullref{thm:disjoint_union_of_disjoint_sets} implies that \( B \amalg A_n \) is equinumerous with \( B \cup A_n \). Therefore, as desired,
  \begin{equation*}
    \sum_{k=1}^n \card A_k = \card\parens[\Big]{ \bigcup_{k=1}^n A_k }.
  \end{equation*}
\end{proof}

\begin{theorem}[Cardinality product rule]\label{thm:cardinality_product_rule}
  The \hyperref[thm:cardinality_existence]{cardinality} of the \hyperref[def:cartesian_product]{Cartesian product} of finitely many sets is the product of their individual cardinalities.
\end{theorem}
\begin{proof}
  \Fullref{def:cardinal_arithmetic/multiplication} defines the product of two cardinal numbers as the cardinality of their Cartesian product. The proposition follows by induction similarly to \fullref{thm:cardinality_sum_rule}.
\end{proof}

\paragraph{Inclusion-exclusion principle}

\begin{theorem}[Binary inclusion-exclusion principle]\label{thm:binary_inclusion_exclusion_principle}
  For any two sets \( A \) and \( B \) we have
  \begin{equation}\label{eq:thm:binary_inclusion_exclusion_principle/general}
    \card(A \cup B) + \card(A \cap B) = \card(A) + \card(B).
  \end{equation}

  If both are finite, then
  \begin{equation}\label{eq:thm:binary_inclusion_exclusion_principle/finite}
    \card(A \cup B) = \card(A) + \card(B) - \card(A \cap B).
  \end{equation}
\end{theorem}
\begin{proof}
  Consider the disjoint union
  \begin{equation*}
    U \coloneqq (A \cup B) \amalg (A \cap B)
  \end{equation*}
  and the (injective) functions
  \begin{equation*}
    \begin{aligned}
      &f_A: A \to U, \\
      &f_A(x) \coloneqq \iota_{A \cup B}(x).
    \end{aligned}
  \end{equation*}
  and
  \begin{equation*}
    \begin{aligned}
      &f_B: B \to U, \\
      &f_B(x) \coloneqq \begin{cases}
        \iota_{A \cap B}(x), &x \in A, \\
        \iota_{A \cup B}(x), &x \not\in A.
      \end{cases}
    \end{aligned}
  \end{equation*}

  \begin{figure}[!ht]
    \centering
    \includegraphics[align=c]{output/thm__binary_inclusion_exclusion_principle}
    \caption{The functions from our proof of \fullref{thm:binary_inclusion_exclusion_principle}}\label{fig:thm:binary_inclusion_exclusion_principle}
  \end{figure}

  We can now easily combine \( f_A \) and \( f_B \) into a bijective function from \( A \amalg B \) to \( U \), thus
  \begin{equation*}
    \card(A \amalg B) = \card(U).
  \end{equation*}

  As per our definition of cardinal addition in \fullref{def:cardinal_arithmetic/addition}, the cardinality of a disjoint union is the sum of the individual cardinalities; thus, \eqref{eq:thm:binary_inclusion_exclusion_principle/general} follows.
\end{proof}

\begin{theorem}[Inclusion-exclusion principle]\label{thm:inclusion_exclusion_principle}
  Fix a nonempty \( \Omega \) and consider a \hyperref[def:measure/positive]{finitely-additive positive measure} \( \mu \) on an \hyperref[def:algebra_of_subsets]{algebra of subsets} \( \mscrA \) of \( \Omega \). As usually stated, the principle applies to the \hyperref[def:counting_measure]{counting measure} on \( \Omega \).

  For every finite family \( A_1, \ldots, A_n \) in \( \mscrA \) of sets of finite measure, we have
  \begin{equation}\label{eq:thm:inclusion_exclusion_principle}
    \mu(A_1 \cup \cdots \cup A_n) = \sum_{k=1}^n (-1)^{k - 1} \sum_{\mathclap{i_1 < \cdots < i_k}} \mu(A_{i_1} \cap \cdots \cap A_{i_k}).
  \end{equation}
\end{theorem}
\begin{comments}
  \item We can generally regard \fullref{thm:binary_inclusion_exclusion_principle} as a special case, however it also handles the case of infinite sets.

  \item \Fullref{thm:inclusion_exclusion_eratosthenes} and \fullref{thm:totient_function_product_formula} are corollaries of this principle.

  \item \incite*[195]{Stanley2012EnumCombinatoricsVol1} uses a linear-algebraic generalization of this theorem to handle integer-valued functions other than the cardinality. Our statement makes use only of the finite additivity of \( \mu \).
\end{comments}
\begin{proof}
  We will use induction on \( n \). The base case \( n = 1 \) is trivial. Suppose \eqref{eq:thm:inclusion_exclusion_principle} holds for all families of \( n \) sets of finite measure. For the family \( A_1, \ldots, A_n, A_{n+1} \) we thus have
  \begin{align*}
    &\phantom{{}={}}
    \mu(A_1 \cup \cdots \cup A_n)
    = \\ &=
    \mu\parens[\Big]{ (A_1 \setminus A_{n+1}) \cup \cdots \cup (A_n \setminus A_{n+1}) \cup A_{n+1} }
    \reloset {\eqref{eq:def:boolean_algebra_additive_function/finite}} = \\ &=
    \mu\parens[\Big]{ (A_1 \setminus A_{n+1}) \cup \cdots \cup (A_n \setminus A_{n+1}) } + \mu(A_{n+1})
    \reloset {\T{ind.}} = \\ &=
    \sum_{k=1}^n (-1)^{k - 1} \sum_{\mathclap{i_1 < \cdots < i_k \leq n}} \mu( (A_{i_1} \cap \cdots \cap A_{i_k}) \setminus A_{n+1}) + \mu(A_{n+1})
    \reloset {\eqref{eq:def:boolean_algebra_additive_function/finite}} = \\ &=
    \sum_{k=1}^n (-1)^{k - 1} \sum_{\mathclap{i_1 < \cdots < i_k \leq n}} \parens[\Big]{ \mu(A_{i_1} \cap \cdots \cap A_{i_k}) - \mu(A_{i_1} \cap \cdots \cap A_{i_k} \cap A_{n+1}) } + \mu(A_{n+1})
    = \\ &=
    \sum_{k=1}^{n + 1} (-1)^{k - 1} \sum_{\mathclap{i_1 < \cdots < i_k \leq n + 1}} \mu(A_{i_1} \cap \cdots \cap A_{i_k}).
  \end{align*}
\end{proof}

\paragraph{Pigeonhole principle}

\begin{concept}\label{con:pigeonhole_principle}
  The \enquote{Pigeonhole principle} refers to the following observation:
  \begin{displayquote}
    If we are given more pigeons than pigeonholes, then at least one pigeonhole must contain multiple pigeons in it.
  \end{displayquote}

  \incite*[sec. 6.2]{Rosen2019DiscreteMathematics} dedicates entire sections to nontrivial applications of this principle.

  The Pigeonhole principle is attributed to Dirichlet, and variations of it are stated in the literature under different names:
  \begin{itemize}
    \item The \enquote{pigeonhole principle} is used, among others, by \incite[289]{Knuth1997ArtVol2}, \incite[sec. 6.2]{Rosen2019DiscreteMathematics}, \incite[66]{HopcroftEtAl2001Computability}, \incite[exerc. A-4.1]{Rotman2015AlgebraPart1}, \incite[134]{Enderton1977Sets} and \incite[16]{Savage2008Computability}.
    \item The \enquote{drawer principle} is used by \incite[222]{Арнольд2014ОДУ} (as \enquote{принцип ящиков Дирихле}), Goncharov in \cite[156]{АлександровМаркушевичХинчин1952ЭнциклопедияТом3} (as \enquote{принцип Дирихле}), \incite[224]{Проданов1982ФункАнализЧаст1} (as \enquote{принцип за чекмеджетата}).
    \item \enquote{Dirichlet's principle} is used by \incite[64]{Гуров2013Решётки} (as \enquote{принцип Дирихле}), \incite[9]{Мирчев2001Графи} (as \enquote{принцип на Дирихле}).
  \end{itemize}
\end{concept}

\begin{theorem}[Dirichlet's pigeonhole principle]\label{thm:pigeonhole_principle}
  We give several statements of the \hyperref[con:pigeonhole_principle]{pigeonhole principle} in a differing levels of generality.

  \begin{thmenum}
    \thmitem{thm:pigeonhole_principle/simple} For every function \( f: A \to B \), if \( A \) has greater cardinality, at least two members of \( A \) map to the same value in \( B \).

    \thmitem{thm:pigeonhole_principle/general} For every function \( f: A \to B \) we have
    \begin{equation}\label{eq:thm:pigeonhole_principle/general}
      \sup\set[\Big]{ \card(f^{-1}(b)) \given* b \in B } \cdot \card(\img f) \geq \card(A).
    \end{equation}

    The supremum in \eqref{eq:thm:pigeonhole_principle/general} is \( 0 \) in case \( B \) is empty.

    \thmitem{thm:pigeonhole_principle/finitary} Fix nonempty \hi{finite} sets \( A \) with \( n \) elements and \( B \) with \( m \) elements. For every function \( f: A \to B \) between them, there exists some element \( b \) in \( B \) such that \( f(a) = b \) for at least \( n / m \) elements \( a \) of \( A \).

    \thmitem{thm:pigeonhole_principle/infinitary} Fix two sets \( A \) and \( B \) such that \( A \) is infinite and \( \card(A) > \card(B) \). Then, for every function \( f: A \to B \), we have
    \begin{equation}\label{eq:thm:pigeonhole_principle/infinitary}
      \sup\set[\Big]{ \card(f^{-1}(b)) \given* b \in B } = \card(A).
    \end{equation}

    In particular, if the supremum above is attained for \( b_0 \), then \( f^{-1}(b_0) \) and \( A \) are equinumerous.
  \end{thmenum}
\end{theorem}
\begin{proof}
  \SubProofOf{thm:pigeonhole_principle/simple} It is sufficient to show that \( f: A \to B \) cannot be injective if \( \card(A) > \card(B) \). This follows easily from \fullref{thm:set_domination_relation_trichotomy}.

  \SubProofOf{thm:pigeonhole_principle/general} Denote by \( \mu \) the supremum in \eqref{eq:thm:pigeonhole_principle/general}.

  For every \( b \) in \( B \), since \( \card(f^{-1}(b)) \leq \mu \) there exists an injective function
  \begin{equation*}
    m_b: f^{-1}(b) \to \mu
  \end{equation*}

  Then we can define
  \begin{equation*}
    \begin{aligned}
      &g: A \to \mu \times \img f, \\
      &g(a) \coloneqq (m_b(a), f(a)).
    \end{aligned}
  \end{equation*}

  It is injective by construction, hence
  \begin{equation*}
    \card(A) \leq \card(\mu \times \img f) = \mu \cdot \card(\img f).
  \end{equation*}

  \SubProofOf{thm:pigeonhole_principle/finitary} \Fullref{thm:pigeonhole_principle/general} implies that
  \begin{equation*}
    \max\set[\Big]{ \card(f^{-1}(b)) \given* b \in B } \geq \frac n m.
  \end{equation*}

  Since \( B \) is finite, there exists a member attaining the maximum above.

  \SubProofOf{thm:pigeonhole_principle/infinitary} Again denote by \( \mu \) the supremum in \eqref{eq:thm:pigeonhole_principle/general}. Then
  \begin{equation*}
    \mu \cdot \card(\img f) \geq \card(A).
  \end{equation*}

  \Fullref{thm:simplified_cardinal_arithmetic/infinite} implies that
  \begin{equation*}
    \mu \cdot \card(\img f) = \max\set{ \mu, \card(\img f) }.
  \end{equation*}

  We have \( \mu > \card(\img f) \) since otherwise we would obtain
  \begin{equation*}
    \card(B) \geq \card(\img f) \geq \card(A) > \card(B),
  \end{equation*}
  which is a contradiction. Thus,
  \begin{equation*}
    \mu \geq \card(A).
  \end{equation*}

  Furthermore, since \( f^{-1}(b) \subseteq A \) for every \( b \in B \), the supremum \( \mu \) of their cardinals cannot exceed \( \card(A) \). Therefore,
  \begin{equation*}
    \card(A) = \mu.
  \end{equation*}
\end{proof}

\begin{example}\label{ex:thm:pigeonhole_principle}
  We list several examples related to \fullref{thm:pigeonhole_principle}:
  \begin{thmenum}
    \thmitem{ex:thm:pigeonhole_principle/lagrange} Given a \hyperref[def:group/homomorphism]{group homomorphism} \( \varphi: G \to H \), by \fullref{thm:group_zero_morphisms/isomorphism},
    \begin{equation*}
      G / \ker \varphi \cong \img \varphi.
    \end{equation*}

    \Fullref{thm:lagranges_subgroup_theorem} then implies that
    \begin{equation*}
      \card(\ker \varphi) \cdot \card(\img \varphi) = \card(G).
    \end{equation*}

    All cosets are equinumerous by \fullref{thm:subgroup_cosets/equinumerous}, so we can restate the above as
    \begin{equation*}
      \sup\set[\Big]{ \card(\varphi^{-h}) \given* h \in H } \cdot \card(\img \varphi) = \card(G).
    \end{equation*}

    We have thus obtained a special case of \fullref{thm:pigeonhole_principle/general} in which equality holds due to group homomorphisms being well-behaved structurally.

    \thmitem{ex:thm:pigeonhole_principle/birthdays} \Fullref{thm:pigeonhole_principle/finitary} allows us to conclude that, among \( 1000 \) people,
    \begin{itemize}
      \item At least \( 3 = \ceil(1000 / 365) \) were born on the same day.
      \item At least \( 20 = \ceil(1000 / 52) \) were born in the same week.
      \item At least \( 84 = \ceil(1000 / 12) \) were born in the same month.
    \end{itemize}

    \thmitem{ex:thm:pigeonhole_principle/boolean} Again via \fullref{thm:pigeonhole_principle/finitary} we conclude that, for every \hyperref[def:boolean_function]{predicate} \( f: A \to \set{ T, F } \) on a finite set \( A \) with \( n \) elements, either \( f \) holds for at least \( n / 2 \) members of \( A \) or \( f \) doesn't hold for (at least) \( n / 2 \) members.

    \thmitem{ex:thm:pigeonhole_principle/party} As a consequence of \fullref{ex:thm:pigeonhole_principle/boolean}, in a group of \( 6 \) people, either \( 3 \) know everybody else or \( 3 \) do not.

    Compare this example to \fullref{ex:ramsey_party_problem}, where we are interested how many people know \hi{each other}. This leads to the considerably harder problem of estimating \hyperref[def:ramsey_number]{Ramsey numbers}.
  \end{thmenum}
\end{example}

\paragraph{Variations}

\begin{definition}\label{def:combinatorial_variation}\mimprovised
  A \term[bg=вариация (\cite[27]{ДимитровЯнев2007Статистика}), ru=размещение (\cite[3]{БелоусовВласов2012Комбинаторика})]{combinatorial variation} on \( A \) of \term{size} \( k \) is simply an \hyperref[def:ordered_tuple]{ordered tuple} of \( k \) elements of \( A \).

  We say that the variation is with or without \term[bg=(вариация с) повторение (\cite[27]{ДимитровЯнев2007Статистика}), ru=размещение (с повторением) (\cite[3]{БелоусовВласов2012Комбинаторика}), en=repetition (\cite[446]{Rosen2019DiscreteMathematics})]{repetition} depending on whether its components are unique. Unless otherwise noted, we will assume that variations have no repetitions.
\end{definition}
\begin{comments}
  \item The term \enquote{permutation} is often preferred to \enquote{variation} despite not being equivalent to permutations in \hyperref[def:symmetric_group]{symmetric groups}. See \fullref{rem:combinatorial_permutation_terminology}.
\end{comments}

\begin{remark}\label{rem:combinatorial_permutation_terminology}
  In \fullref{def:combinatorial_variation}, we called an ordered tuple of length \( k \) of elements of \( A \) a \enquote{variation}. A more common term is \enquote{permutation}.

  When comparing his terminology to that of others, \incite[29]{Aigner1997Combinatorics} states that injective functions from a set of \( r \) elements to a set of \( n \) elements are also called \enquote{\( n \)-permutations of \( r \) objects}. He then remarks that, in older literature, \enquote{\( n \)-permutations} are called \enquote{\( n \)-variations}. This terminology is still used in Bulgarian, for example in \cite[27]{ДимитровЯнев2007Статистика}.

  In Russophone literature, \enquote{размещение} (\enquote{arrangement}) is used instead. This usage can be found in \incite[171]{Яблонский2003ДискретнаяМатематика}, \incite[100]{БелоусовТкачёв2004ДискретнаяМатематика} and \incite[3; 4]{БелоусовВласов2012Комбинаторика}.

  We avoid using the term \enquote{permutation} for variations, but describe in \fullref{thm:combinatorial_and_algebraic_permutation} cases in which this would be compatible with our usage in symmetric groups.

  In the context of combinatorics, the term \enquote{permutation} does indeed often refer to what we call \enquote{variation}. \incite[1]{Hall1986Combinatorics} provides the following definition:
  \begin{displayquote}
    A permutation is an ordered selection of objects from a set \( S \).
  \end{displayquote}

  \incite[429]{Rosen2019DiscreteMathematics} provides two related definition:
  \begin{displayquote}
    A permutation of a set of distinct objects is an ordered arrangement of these objects. We are also interested in ordered arrangements of some of the elements of the set. An ordered arrangement of \( r \) elements of a set is called an \( r \)-permutation.
  \end{displayquote}

  On the other hand, the predominant usage of \enquote{permutation} is to refer to bijective \hyperref[def:function/endofunction]{endofunction}.
  \begin{itemize}
    \item For elements of the finite symmetric group \( S_n \), it is used by
    \incite[31]{Jacobson1985AlgebraI},
    \incite[78]{Винберг2014Алгебра} (as \enquote{перестановка}) and
    \incite[82]{Тыртышников2017Алгебра} (as \enquote{подстановка})

    \item In the same sense, but without explicit discussion of symmetric groups, it is used by
    \incite[28]{Knuth1997ArtVol1},
    \incite[20]{Stanley2012EnumCombinatoricsVol1} and
    \incite[def. 2.11.1]{Savage2008Computability}.

    \item For elements of a general symmetric group \( S_A \), it is used by
    \incite[8]{Lang2002Algebra},
    \incite[116]{Rotman2015AlgebraPart1},
    \incite[def. II.2.1]{Aluffi2009Algebra} and
    \incite[\S 2.2.5]{Новиков2013ДискретнаяМатематика} (as \enquote{перестановка}).
  \end{itemize}
\end{remark}

\begin{proposition}\label{thm:combinatorial_and_algebraic_permutation}
  The \hyperref[def:ordered_tuple]{ordered tuple} \( (a_1, \ldots, a_k) \) of integers between \( 1 \) and \( n \) is a \hyperref[def:combinatorial_variation]{combinatorial variation} (without repetition) if and only if there exists a member \( \sigma \) of the \hyperref[def:symmetric_group]{symmetric group} \( S_n \) such that \( \sigma(i) = a_i \) for \( i = 1, \ldots, k \).
\end{proposition}
\begin{comments}
  \item This proposition connects different definitions of \enquote{permutation}, as discussed in \fullref{rem:combinatorial_permutation_terminology}.
\end{comments}
\begin{proof}
  \SufficiencySubProof Consider the following function on \( \set{ 1, \ldots, n } \):
  \begin{equation*}
    \sigma(i) \coloneqq \begin{cases}
      i,                                                                  &i \leq k, \\
      \min\set{ 1 \leq a \leq n \given \sigma(j) \neq a \T{for} j < i }, &i > k.
    \end{cases}
  \end{equation*}

  If the elements of \( (a_1, \ldots, a_k) \) are distinct, then \( \sigma \) is bijective, and thus belongs to \( S_n \).

  \NecessitySubProof For every bijective function \( \sigma \) in \( S_n \), the elements \( \sigma(1), \ldots, \sigma(k) \) are distinct, thus they form a variation without repetition.
\end{proof}

\begin{lemma}\label{thm:combinatorial_and_algebraic_permutation_quotient_lemma}
  Regard the \hyperref[def:symmetric_group]{symmetric group} \( S_{n - k} \) as a subgroup of \( S_n \) whose members fix the numbers \( 1, \ldots, k \). Then two members from \( S_n \) belong to the same coset with respect to \( S_{n - k} \) if and only if they coincide on \( 1, \ldots, k \).

  For every \hyperref[def:combinatorial_variation]{combinatorial variations} (without repetition) \( (a_1, \ldots, a_k) \) on \( \set{ 1, \ldots, n } \), \fullref{thm:combinatorial_and_algebraic_permutation} gives us a member \( \sigma \) from \( S_n \).

  The map sending \( (a_1, \ldots, a_k) \) to the coset \( \pi(\sigma) \) in \( S_n / S_{n - k} \) is bijective.
\end{lemma}
\begin{proof}
  Follows from \fullref{thm:combinatorial_and_algebraic_permutation}.
\end{proof}

\begin{proposition}\label{thm:combinatorial_and_algebraic_permutation_quotient}
  The \hyperref[def:group/quotient]{quotient} \( S_n / S_{n - k} \) of \hyperref[def:symmetric_group]{symmetric groups} is \hyperref[def:equinumerosity]{equinumerous} with the set of all \hyperref[def:combinatorial_variation]{combinatorial variations} (without repetition) of size \( k \) on any set with \( n \) elements.
\end{proposition}
\begin{proof}
  Fix a set \( A \) of \( n \) elements. Its elements can be enumerated by some bijective function \( f: A \to \set{ 1, \ldots, n } \). Then \fullref{thm:combinatorial_and_algebraic_permutation_quotient_lemma} implies that the variations of \( \set{ 1, \ldots, n } \) of size \( k \) are equinumerous with the quotient \( S_n / S_{n - k} \), and thus, via \( f \), to the variations of \( A \) of size \( k \).
\end{proof}

\begin{definition}\label{def:factorial}\mcite[46]{Knuth1997ArtVol1}
  We define the \term[bg=факториел (\cite[129]{Тагамлицки1971Диф}), ru=факториал (\cite[145]{АлександровМаркушевичХинчин1952ЭнциклопедияТом3})]{factorial} of a \hyperref[def:integer_signum]{nonnegative integer} \( n \) recursively as follows:
  \begin{equation}\label{eq:def:factorial}
    n! \coloneqq \begin{cases}
      1,                &n = 0, \\
      (n - 1)! \cdot n, &n > 0.
    \end{cases}
  \end{equation}
\end{definition}
\begin{comments}
  \item For \( n > 0 \), this is simply the product of all smaller positive integers. The base case \( n = 0 \) is justified by \fullref{thm:symmetric_group_cardinality}.
\end{comments}

\begin{theorem}[Stirling's factorial approximation]\label{thm:stirlings_factorial_approximation}
  For the factorial function we have
  \begin{equation*}
    n! = \sqrt{2 \pi n} \cdot \parens*{ \frac n e }^n \cdot e^{\mu(n)},
  \end{equation*}
  where \( \mu \), defined by \eqref{eq:thm:stirlings_gamma_approximation/mu}, satisfies
  \begin{equation*}
    0 < \mu(n) < \frac 1 {12n}.
  \end{equation*}
\end{theorem}
\begin{proof}
  Follows from \fullref{thm:stirlings_gamma_approximation}.
\end{proof}

\begin{proposition}\label{thm:symmetric_group_cardinality}
  The \hyperref[def:symmetric_group]{symmetric group} \( S_n \) has \( n! \) elements.
\end{proposition}
\begin{proof}
  We will use induction on \( n \).

  \begin{itemize}
    \item The case \( n = 0 \) is trivial --- there is only one empty permutation in \( S_0 \).

    \item For \( n > 0 \), suppose that \( S_{n - 1} \) has \( (n - 1)! \) elements. The group \( S_n \) is obtained by permuting \( n \) with each element of \( S_{n - 1} \). This can be expressed via composition with the \hyperref[def:transposition]{transposition} \( \cycle{ k, n } \) for different \( k \):
    \begin{equation*}
      S_n = \set{ \cycle{ k, n } \bincirc \sigma \given \sigma \in S_{n-1} \T{and} 1 \leq k \leq n }.
    \end{equation*}

    There are \( n \) such transpositions, thus \( S_n \) is equinumerous with \( S_{n-1} \times \set{ 1, \ldots, n } \). \Fullref{thm:cardinality_product_rule} implies that
    \begin{equation*}
      \card(S_n)
      =
      \card(S_{n-1}) \cdot n
      \reloset {\T{ind.}} =
      (n - 1)! \cdot n
      =
      n!.
    \end{equation*}
  \end{itemize}
\end{proof}

\begin{proposition}\label{thm:number_of_variations}
  Fix a set \( A \) of \( n \) elements.

  \begin{thmenum}
    \thmitem{thm:number_of_variations/repetition} The number of \hyperref[def:combinatorial_variation]{variations} on \( A \) of size \( k \) \hi{with repetition} is \( n^k \).

    \thmitem{thm:number_of_variations/no_repetition} The number of variations on \( A \) of size \( k \) \hi{without repetition} is \( 0 \) if \( k > n \) and
    \begin{equation}\label{eq:thm:number_of_variations/no_repetition}
      \frac {n!} {(n - k)!} = \prod_{s=n - k + 1}^n s.
    \end{equation}
    otherwise.
  \end{thmenum}
\end{proposition}
\begin{comments}
  \item \incite[74]{Aigner1997Combinatorics} calls \eqref{eq:thm:number_of_variations/no_repetition} a \enquote{falling factorial}.
\end{comments}
\begin{proof}
  \SubProofOf{thm:number_of_variations/repetition} The variations in \( A \) of size \( k \) with repetition are precisely the elements of the Cartesian power \( A^k \). \Fullref{thm:cardinality_product_rule} implies that the cardinality of the \( A^k \) is \( n^k \).

  \SubProofOf{thm:number_of_variations/no_repetition} There are no combinatorial variations without repetitions of size \( k > n \).

  If \( k < n \), \fullref{thm:combinatorial_and_algebraic_permutation_quotient} implies that the set of variations on \( A \) of size \( k \) is equinumerous with the quotient \( S_n / S_{n - k} \).

  \Fullref{thm:symmetric_group_cardinality} implies that \( S_n \) has \( n! \) elements and \( S_{n - k} \) --- \( k! \) elements. Then \eqref{eq:thm:number_of_variations/no_repetition} follows from \fullref{thm:lagranges_subgroup_theorem}.
\end{proof}

\paragraph{Binomial coefficients}

\begin{definition}\label{def:binomial_coefficient}\mcite[53]{Knuth1997ArtVol1}
  We define the \term[ru=биномиальный коеффициент (\cite[100]{БелоусовТкачёв2004ДискретнаяМатематика})]{binomial coefficient} of the \hyperref[def:integer_signum]{nonnegative integers} \( n \geq k \) as the number
  \begin{equation*}
    \binom n k \coloneqq \frac {n!} {k!(n-k)!},
  \end{equation*}
\end{definition}
\begin{comments}
  \item Binomial coefficients are motivated by \fullref{thm:binomial_theorem}.
\end{comments}

\begin{theorem}[Pascal's binomial recurrence]\label{thm:pascals_binomial_recurrence}
  For nonnegative integers \( 1 < k < n \), \hyperref[def:binomial_coefficient]{binomial coefficients} have the following property:
  \begin{equation}\label{eq:thm:pascals_binomial_recurrence}
    \binom n k = \binom {n - 1} k + \binom {n - 1} {k - 1}.
  \end{equation}
\end{theorem}
\begin{comments}
  \item \incite[thm. 6.4.2]{Rosen2019DiscreteMathematics} calls this recurrence \enquote{Pascal's identity} after Pascal because of its relation to \hyperref[con:pascals_triangle]{Pascal's triangle}. \incite[56]{Knuth1997ArtVol1} calls it the \enquote{addition formula} for binomial coefficients.
\end{comments}
\begin{proof}
  \begin{balign*}
    \binom {n - 1} k + \binom {n - 1} {k - 1}
    &=
    \frac {(n - 1)!} {k! (n - 1 - k)!} + \frac {(n - 1)!} {(k - 1)! (n - k)!}
    = \\ &=
    \frac {(n - 1)!} {(k - 1)! (n - 1 - k)!} \bracks*{ \frac 1 k + \frac 1 {n - k} }
    = \\ &=
    \frac {(n - 1)!} {(k - 1)! (n - 1 - k)!} \frac n {k(n - k)}
    = \\ &=
    \frac {n!} {k! (n - k)!}
    = \\ &=
    \binom n k.
  \end{balign*}
\end{proof}

\begin{theorem}[Newton's binomial theorem]\label{thm:binomial_theorem}
  If, in some \hyperref[def:semiring]{semiring}, the members \( x \) and \( y \) commute (i.e. \( xy = yx \)), then
  \begin{equation}\label{eq:thm:binomial_theorem}
    (x + y)^n = \sum_{k=0}^n \binom n k x^k y^{n-k}.
  \end{equation}
\end{theorem}
\begin{proof}
  We use induction on \( n \). For \( n = 0 \), the theorem trivially holds. Assume that the theorem holds for \( 1, \ldots, n \). Then
  \begin{balign*}
    (x + y)^{n+1}
     & =
    x (x + y)^n + y (x + y)^n
    = \\ &=
    \sum_{k=0}^n \binom n k x^{k+1} y^{n-k} + y \sum_{k=0}^n \binom n k x^k y^{n-k}
    = \\ &=
    x^{n+1} + y \sum_{k=0}^{n-1} \binom n k x^{k+1} y^{n-(k+1)} + y \sum_{k=0}^n \binom n k x^k y^{n-k}
    = \\ &=
    x^{n+1} + y \parens*{ \sum_{k=1}^n \binom n {k-1} x^k y^{n-k} + y^n \sum_{k=1}^n \binom n k x^k y^{n-k} } + y^{n+1}
    = \\ &\reloset {\eqref{eq:thm:pascals_binomial_recurrence}} =
    x^{n+1} + y \sum_{k=1}^n \binom {n+1} k x^k y^{n-k} + y^{n+1}
    = \\ &=
    \sum_{k=0}^n \binom {n+1} k x^k y^{(n+1)-k}.
  \end{balign*}
\end{proof}

\begin{corollary}[Newton's binomial theorem for positive characteristic]\label{thm:newtons_binomial_theorem_positive_characteristic}
  In a \hyperref[def:ring]{ring} of \hyperref[def:ring_characteristic]{characteristic} \( p \), for every power \( q = p^n \) of \( p \), \fullref{thm:binomial_theorem} reduces to
  \begin{equation}\label{eq:thm:newtons_binomial_theorem_positive_characteristic}
    (x + y)^q = x^q + y^q.
  \end{equation}
\end{corollary}
\begin{comments}
  \item A memorable name for this theorem is \enquote{Freshman's dream}, based on a poem with subtitle \enquote{The Freshman's Dream}, published by \incite{Gleason1938FreshmansDream}. The following two verses seem most relevant:
  \begin{displayquote}
    Remove the brackets, radicals, \\
    And do so with discretion.
  \end{displayquote}
\end{comments}
\begin{proof}
  Note that, if \( 0 < k < p \), then
  \begin{equation*}
    \binom p k = \frac {p!} {k!(p-k)!} = \frac p {p-k} \cdot \binom {p-1} k = 0.
  \end{equation*}

  \Fullref{thm:binomial_theorem} then implies that
  \begin{equation}\label{eq:thm:newtons_binomial_theorem_positive_characteristic/proof/prime}
    (x + y)^p = x^p + y^p.
  \end{equation}

  Now we can use induction on \( n \) to show \eqref{eq:thm:newtons_binomial_theorem_positive_characteristic}. The case \( n = 1 \) is clear, and for \( n > 1 \) we have
  \begin{equation*}
    (x + y)^q
    =
    \parens[\Big]{ (x + y)^{p^{n-1}} }^p
    \reloset {\T{ind.}} =
    (x^{p^{n-1}} + y^{p^{n-1}})^p
    \reloset {\eqref{eq:thm:newtons_binomial_theorem_positive_characteristic/proof/prime}} =
    x^q + y^q.
  \end{equation*}
\end{proof}

\begin{theorem}[Vandermonde convolution]\label{thm:vandermonde_convolution}\mcite[59]{Knuth1997ArtVol1}
  For nonnegative integers \( n \), \( m \) and \( k \leq n + m \), we have
  \begin{equation}\label{eq:thm:vandermonde_convolution}
    \binom {n + m} k = \sum_{\substack{i+j=k \\ i \leq n \T*{and} j \leq m}} \binom n i \cdot \binom m j.
  \end{equation}
\end{theorem}
\begin{proof}
  Consider the polynomial \( X + 1 \) over any commutative ring.

  By \fullref{thm:binomial_theorem}, we have
  \begin{equation*}
    (X + 1)^{n+m} = \sum_{k=0}^{n+m} x^k 1^{n+m-k}.
  \end{equation*}

  Using the \hyperref[def:semigroup_algebra]{convolution product} instead, we obtain
  \begin{equation*}
    (X + 1)^n \cdot (X + 1)^m = \sum_{k=0}^{n+m} \parens*{ \sum_{\substack{i+j=k \\ i \leq n \T*{and} j \leq m}} \binom n i \cdot \binom m j } x^k.
  \end{equation*}

  Since the two are equal, we obtain \eqref{eq:thm:vandermonde_convolution}.
\end{proof}

\begin{concept}\label{con:pascals_triangle}\mcite[fig. 6.4.1]{Rosen2019DiscreteMathematics}
  \term[ru=треугольник Паскаля (\cite[\S 5.3.4]{Новиков2013ДискретнаяМатематика})]{Pascal's triangle} is a colloquial name for schematic triangles a-la \cref{fig:con:pascals_triangle}, in which every number is the sum of the two numbers above, with ones on the boundary.

  \begin{figure}[!ht]
    \centering
    \includegraphics[page=1]{output/con__pascals_triangle}
    \caption{\hyperref[con:pascals_triangle]{Pascal's triangle}.}\label{fig:con:pascals_triangle}
  \end{figure}

  By \enquote{schematic triangle} we mean that every object showing the same recurrence can again be called \enquote{Pascal's triangle}. For example, \incite[54]{Knuth1997ArtVol1} and \incite[179]{Яблонский2003ДискретнаяМатематика} use the term to refer to \hyperref[def:pascal_matrix/lower]{lower triangular Pascal matrices}.
\end{concept}

\begin{definition}\label{def:pascal_matrix}\mcite[1]{EdelmanStrang2018PascalMatrices}
  We will define three families of square matrices, which we will collectively call \term{Pascal matrices}.
  \begin{thmenum}
    \thmitem{def:pascal_matrix/lower} The \hyperref[def:triangular_matrix]{lower triangular} matrix \( L_n = \seq{ l_{i,j} }_{i,j=1}^n \), where
    \begin{equation*}
      l_{i,j} \coloneqq \begin{cases}
        0,                       &j > i, \\
        1,                       &j = 1, \\
        1,                       &j = i, \\
        l_{i-1,j} + l_{i-1,j-1}, &1 < j < i.
      \end{cases}
    \end{equation*}

    \thmitem{def:pascal_matrix/upper} Its \hyperref[def:transpose_matrix]{transpose}, the \hyperref[def:triangular_matrix]{upper triangular} matrix \( U_n = \seq{ u_{i,j} }_{i,j=1}^n \).

    \thmitem{def:pascal_matrix/symmetric} The symmetric matrix \( S_n = \seq{ s_{i,j} }_{i,j=1}^n \), where
    \begin{equation*}
      s_{i,j} \coloneqq \begin{cases}
        1,                     &i = 1, \\
        1,                     &j = 1, \\
        s_{i-1,j} + s_{i,j-1}, &i > 1 \T{and} j > 1.
      \end{cases}
    \end{equation*}
  \end{thmenum}
\end{definition}
\begin{comments}
  \item These matrices in \identifier{combinatorics.binomial} in \cite{notebook:code}.
\end{comments}

\begin{example}\label{ex:con:pascals_triangle}
  We give examples of \hyperref[def:pascal_matrix]{Pascal matrices}:
  \begin{equation*}
    L_7
    =
    \begin{pmatrix}
      1        &          &           &        &        &      &   \\
      \fbox{1} & \fbox{1} &           &        &        &      &   \\
      1        & \fbox{2} & 1         &        &        &      &   \\
      1        & 3        & 3         & 1      &        &      &   \\
      1        & 4        & 6         & 4      & 1      &      &   \\
      1        & \fbox{5} & \fbox{10} & 10     & 5      & 1    &   \\
      1        & 6        & \fbox{15} & 20     & 15     & 6    & 1
    \end{pmatrix}
  \end{equation*}
  \begin{equation*}
    U_7
    =
    \begin{pmatrix}
      1        & \fbox{1} & 1         & 1      & 1      & 1         & 1         \\
               & \fbox{1} & \fbox{2}  & 3      & 4      & \fbox{5}  & 6         \\
               &          & 1         & 3      & 6      & \fbox{10} & \fbox{15} \\
               &          &           & 1      & 4      & 10        & 20        \\
               &          &           &        & 1      & 5         & 15        \\
               &          &           &        &        & 1         & 6         \\
               &          &           &        &        &           & 1
    \end{pmatrix}
  \end{equation*}
  \begin{equation*}
    S_7
    =
    \begin{pmatrix}
      1        & \fbox{1} & 1         & 1      & 1      & 1      & 1   \\
      \fbox{1} & \fbox{2} & 3         & 4      & 5      & 6      & 7   \\
      1        & 3        & 6         & 10     & 15     & 21     & 28  \\
      1        & 4        & \fbox{10} & 20     & 35     & 56     & 84  \\
      1        & \fbox{5} & \fbox{15} & 35     & 70     & 126    & 210 \\
      1        & 6        & 21        & 56     & 126    & 252    & 462 \\
      1        & 7        & 28        & 84     & 210    & 462    & 924
    \end{pmatrix}
  \end{equation*}
\end{example}

\begin{proposition}\label{thm:pascal_matrix_binomial}
  We have the following relation between \hyperref[def:binomial_coefficient]{Binomial coefficients} and elements of \hyperref[def:pascal_matrix]{Pascal matrices}:
  \begin{align*}
    l_{i,j} &= \binom i j \thickspace\T{if}\thickspace i \leq j, \\
    u_{i,j} &= \binom j i \thickspace\T{if}\thickspace i \geq j, \\
    s_{i,j} &= \binom {i + j} j = \binom {i + j} i = \frac {(i + j)!} {i! j!}. \\
  \end{align*}
\end{proposition}
\begin{proof}
  Follows from \fullref{thm:pascals_binomial_recurrence}.
\end{proof}

\begin{proposition}\label{thm:pascal_matrix_product}
  For \hyperref[def:pascal_matrix]{Pascal matrices}, we have \( S_n = L_n \cdot U_n \).
\end{proposition}
\begin{proof}
  The \( (i, j) \)-th entry of \( L_n \cdot U_n \) is
  \begin{equation*}
    \sum_{k=1}^n l_{i,k} \cdot u_{k,j}
    =
    \sum_{k=1}^n l_{i,k} \cdot l_{j,k}
    =
    \sum_{k=1}^{\min\set{ i, j }} \binom i k \cdot \binom j k
    \reloset {\eqref{eq:thm:vandermonde_convolution}} =
    \binom {i + j} i
    =
    s_{i,j}.
  \end{equation*}
\end{proof}
